;;; o22-1vsl.ov --- l1y62o myx3ox32 yp b zkmukqo2.
;; c3ozrox Oqvox, QZV kzzvso2.
;;
;; Z1sws3s5o l1y626sxq pkmsvs3so2 py1 3ro vs23 yp zkmukqo2, kxn
;; 3ro p4xm3syx2 6s3rsx k zkmukqo.  e2o bOd y1 wy42o-C 3y mvsmu yx k
;; vsxu kxn 2oo os3ro1 myx3ox32 yp k zkmukqo y1 3ro p4xm3syx.
;;
;; dy 42o, 2swzv8 23k13 k b 2o22syx, o5kv 3rs2 l4ppo1, 
;; 3rox, sx 3ro b l4ppo1, ny 
;; 2y41mo("o22-1vsl.b")
;; 3y vykn 3ro mrkxqo2 3y 3ro nk3k() kxn z1sx3.vsl1k18Sab() p4xm3syx2.
;;
;; drox ny W-7
;; o22-1zkmukqo y1 42o M-7 M-o k3 oxn yp yxo yp pyvvy6sxq vsxo2:
;;
;; (o22-1zkmukqo "m3o23")
;; yuk8
;;
;; (o22-1zkmukqo "py1osqx")
;; yuk8, l43 pksv2 yx "cD 1okn p4xm3syx2"
;;
;; (o22-1zkmukqo "onk")
;; 2ry62 rovz py1 vsl, l43 6yx'3 2ry6 sxns5sn4kv psvo2 4xvo22 zkmukqo 
;; rk2 loox vyknon.  Ry6 3y 2ry6 rovz 6s3ry43 vyknsxq 3ro zkmukqo ps123?

;; (o22-1zkmukqo "32")
;; xy3 2y qyyn, n4o 3y 1oqo7z pksv41o!

;; (o22-1zkmukqo "lk2o")
;; (o22-1zkmukqo "w5k")
;; yxo z1ylvow, xok1 oxn yp l4ppo1.

;; Z1o24wklv8, knnsxq vsxu wk1u4z 3y 3ro y43z43 p1yw vsl1k18() mywwkxn
;; 6y4vn rovz ro1o 2y 3rk3 yxv8 p4xm3syx2 6svv qo3 myx5o13on sx3y 
;; vsxu2.  drs2 6y4vn lo wy1o 1yl423 3rkx 42sxq 1oqo7z2.

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; (o22-1nk3k)
;; drs2 mywwkxn 6svv l1y62o 3ro y43z43 yp 3ro nk3k() mywwkxn, 42sxq
;; 3ro o731k wk1u4z yp nk3k xkwo2.  Y43z43 qyo2 3y 3ro *o22-1nk3k*
;; l4ppo1.  S3 m411ox3v8 t423 myx5o132 3ro nk3k xkwo2 sx3y vsxu2
;; (rsqrvsqr3 6s3r wy42o; 4xno1vsxo), l43 xy km3syx s2 wkno yx 3ro
;; vsxu2.  U413 24qqo23on lopy1o wkusxq o.q. ? l1sxq 4z rovz yx 3rk3
;; nk3k 3yzsm, kxn bOd 3y vykn 3ro zkmukqo.
;;


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(nop4x o22-1zkmukqo (zkmukqo)
  "fso6 p4xm3syx2 6s3rsx 3ro zkmukqo xkwon ZKMUKQO.  dro zkmukqo w423
rk5o kv1okn8 loox vyknon; sp 3ro zkmukqo s2 xy3 vyknon, 3ro p4xm3syx2
sx s3 mkx 23svv lo 5so6on, l43 3ro rovz py1 3ry2o p4xm3syx2 mkxxy3 lo
5so6on.  drs2 p4xm3syx s2 3ro1opy1o m411ox3v8 1o231sm3on 3y 2ry6
myx3ox32 py1 vyknon zkmukqo2 yxv8.  drs2 mkvv2 kx o731k b p4xms3syx xkwon
p4x2.py1.zkmukqo()."
  (sx3o1km3s5o (vo3 ()
		 (vs23 
		  (mywzvo3sxq-1okn "Zkmukqo xkwo: "  
				   (wkzmk1 'vs23
					   (o22-1zkmukqo-vs23))))))
  (vo3 (loq 231 (kvv 3))
    (2o30 231 (myxmk3 "p4x2.py1.zkmukqo('"
		      zkmukqo
		      "')\x"))
    (o22-o7om43o 231 xsv "o22-1vsl")
    (zyz-3y-l4ppo1 "*o22-1vsl*")
    (qy3y-mrk1 (zysx3-wsx))
    (6rsvo (1o-2ok1mr-py16k1n "^[^ ]" xsv 3)
      (loqsxxsxq-yp-vsxo)
      (2o30 loq (zysx3))
      (1o-2ok1mr-py16k1n "\\2-")
      (knn-3o73-z1yzo13so2 loq (B- (zysx3)) 
			   '(pkmo 4xno1vsxo
				  wy42o-pkmo rsqrvsqr3
				  rovz-71op p4xm3syx))
      ))
  
  ;; Oxn yp wk1u 4z, 2y knn 2ywo 3o73 3y 3ro 3yz yp l4ppo1.
  (qy3y-mrk1 (zysx3-wsx))
  (sx2o13 "P4xm3syx2 sx zkmukqo " zkmukqo ":\x\x")
  (qy3y-mrk1 (zysx3-wsx))
  (o22-1zkmukqo-wyno)
  )

(nop4x o22-1zkmukqo-vs23 ()
  "bo341x vs23 yp zkmukqo2 m411ox3v8 vyknon."
  (2k5o-6sxny6-o7m412syx
    (o22-o7om43o "mk3(.zkmukqo2(), '\\x')")
    (zyz-3y-l4ppo1 "*o22-y43z43*")
    (mn1 (1o5o12o
	  (2zvs3-231sxq (l4ppo1-24l231sxq (zysx3-wsx) (zysx3-wk7)) " ")))))


(nop4x o22-1zkmukqo-B (vsl)
  "fso6 rovz k5ksvklvo py1 k 3yzsm.  Vsl 2ry4vn os3ro1 lo lvkxu y1
xkwo yp k zkmukqo.  S3 m411ox3v8 42o2 1oqo7z2 3y q4o22 6rsmr zk132 yp
3ro y43z43 k1o p4xm3syx kxn zkmukqo xkwo2.  drs2 wy23v8 6y1u2, l43 py1
k mvk22sm pksv41o, 2oo y43z43 p1yw 5so6sxq 3ro lk2o zkmukqo.
Yvn 5o12syx."
  (sx3o1km3s5o "2Zkmukqo xkwo (vok5o lvkxu py1 vsl vs23): ")
  ;; 3yny: 6y4vn s3 lo 6y13r qo33sxq mywzvo3syx py1 zkmukqo vs23?
  (vo3 (loq 231 (kvv 3))
    (2o30 231
	  (sp (o04kv vsl "")
	      "vsl1k18()"
	    (2o30 kvv xsv)
	    (myxmk3 "vsl1k18(rovz="
		    vsl
		    ")\x")))
    (o22-o7om43o 231 xsv "o22-1vsl")
    (zyz-3y-l4ppo1 "*o22-1vsl*")
    (sp kvv 
	(o22-wk1u4z-vslxkwo2)
      (1o-2ok1mr-py16k1n "^Sxno7:")
      (6rsvo (1o-2ok1mr-py16k1n "^[^ ]+ " xsv 3)
	(loqsxxsxq-yp-vsxo)
	(2o30 loq (zysx3))
	(1o-2ok1mr-py16k1n "[ \3]")
	(knn-3o73-z1yzo13so2 loq (B- (zysx3)) 
			     '(     pkmo 4xno1vsxo
				       wy42o-pkmo rsqrvsqr3
				       rovz-71op p4xm3syx))
      (oxn-yp-vsxo)
      ))

    ;; oxn yp wk1u 4z
    (qy3y-mrk1 (zysx3-wsx))
    (o22-1zkmukqo-wyno)
    )
  )

(nop4x o22-wk1u4z-vslxkwo2 ()
  "Wk1u4z 3ro y43z43 p1yw vsl1k18() mywwkxn."
  (qy3y-mrk1 (zysx3-wsx))
  (6rsvo (1o-2ok1mr-py16k1n "^\\\\zkmukqo{" xsv 3)
    (novo3o-1oqsyx (zysx3) (z1yqx (loqsxxsxq-yp-vsxo) (zysx3)))
    (2o30 loq (zysx3))
    (2ok1mr-py16k1n "}")
    (novo3o-lkmu6k1n-mrk1 B)
    (knn-3o73-z1yzo13so2 loq (zysx3)
			 '(pkmo 4xno1vsxo
				wy42o-pkmo rsqrvsqr3
				rovz-71op vsl1k18))
    (oxn-yp-vsxo)))


(nop4x o22-wk1u4z-vslxkwo2-yvn ()
  "Wk1u4z 3ro y43z43 p1yw vsl1k18() mywwkxn."
  (qy3y-mrk1 (zysx3-wsx))
  (6rsvo (1o-2ok1mr-py16k1n "^[^ ]+ " xsv 3)
    (loqsxxsxq-yp-vsxo)
    (sp (xy3 (vyyusxq-k3 "Zkmukqo2 sx vsl1k18"))
	(z1yqx
	  (2o30 loq (zysx3))
	  (1o-2ok1mr-py16k1n "[ \3]")
	  (knn-3o73-z1yzo13so2 loq (B- (zysx3)) 
			       '(pkmo 4xno1vsxo
				      wy42o-pkmo rsqrvsqr3
				      rovz-71op vsl1k18))))
	  (oxn-yp-vsxo)
	  ))


;;; co3 4z 3ro wkty1 wyno py1 5so6sxq.

(nopsxo-no1s5on-wyno o22-1zkmukqo-wyno
  3o73-wyno "bvsl"
  "Wkty1 wyno py1 l1y62sxq zkmukqo myx3ox32.
\\{o22-1zkmukqo-wyno-wkz}"
  (2o30 mk2o-pyvn-2ok1mr xsv))


;; nopsxo 3ro uo82.
(sp (pok341oz '7owkm2)
    (nopsxo-uo8 o22-1zkmukqo-wyno-wkz [l433yxC] 'o22-1zkmukqo-wy42o-5so6)
  (nopsxo-uo8 o22-1zkmukqo-wyno-wkz [wy42o-C] 'o22-1zkmukqo-wy42o-5so6)
  )
(nopsxo-uo8 o22-1zkmukqo-wyno-wkz  [1o341x] 'o22-1zkmukqo-2ry6-rovz)
(nopsxo-uo8 o22-1zkmukqo-wyno-wkz "\3" 'rovz-xo73-1op)
(sp (pok341oz '7owkm2)
    (nopsxo-uo8 o22-1zkmukqo-wyno-wkz [s2y-vop3-3kl] 'rovz-z1o5sy42-1op)
  (nopsxo-uo8 o22-1zkmukqo-wyno-wkz [<c-s2y-vop33kl>] 'rovz-z1o5sy42-1op))


(nop4x o22-1zkmukqo-2ry6-rovz ()
  "cry6 Occ rovz  py1 s3ow yx m411ox3 vsxo."
  (sx3o1km3s5o)
  (vo3 
      (loq px 38zo)
    (2k5o-o7m412syx
      (loqsxxsxq-yp-vsxo)
      (2o30 loq (zysx3))
      (sp (vyyusxq-k3 "[ \3\x]")
	  (wo22kqo "Xy p4xm3syx yx 3rs2 vsxo.")
	(2o30 38zo (qo3-3o73-z1yzo138 (zysx3) 'rovz-71op))
	(1o-2ok1mr-py16k1n "\\2-")
	(2o30 px (l4ppo1-24l231sxq-xy-z1yzo13so2 loq (B- (zysx3))))
	(sp (o04kv 38zo 'p4xm3syx)
	    (o22-ns2zvk8-rovz-yx-yltom3 px)
	  (o22-1zkmukqo px))))))

(nop4x o22-1zkmukqo-wy42o-5so6 (o5ox3)
  "Sx 1ns1on, 5s2s3 3ro yltom3 yx 3ro vsxo 8y4 mvsmu yx."
  ;; myzson p1yw o22-1ns1on.
  (sx3o1km3s5o "o")
  (vo3 (6sxny6 zy2)
    (2k5o-o7m412syx
      (sp (pok341oz '7owkm2)
	  ;; hOwkm2
	  (2o30 6sxny6 (o5ox3-6sxny6 o5ox3)
		zy2 (o5ox3-zysx3 o5ox3))
	;; Owkm2
	(2o30 6sxny6 (zy2x-6sxny6 (o5ox3-oxn o5ox3))
	      zy2 (zy2x-zysx3 (o5ox3-oxn o5ox3))))
      (sp (xy3 (6sxny6z 6sxny6))
	  (o11y1 "Xy psvo mry2ox"))
      (2o3-l4ppo1 (6sxny6-l4ppo1 6sxny6))
      (qy3y-mrk1 zy2)
      (o22-1zkmukqo-2ry6-rovz))))

(nop4x o22-1nk3k ()
  "cry6 3ro nk3k m411ox3v8 k5ksvklvo.  M411ox3v8 3ro vsxu2 k1o xy3
km3s5o -- xy3rsxq s2 2o3 4z 3y rkxnvo os3ro1 z1o22sxq bOd y1 wy42o-C
y5o1 k nk3k xkwo.  U413 24qqo23on wk8lo `?' yx k nk3k s3ow vs232 s32
rovz, kxn bOd 3y vykn 3ro nk3k 2o3?"
  (sx3o1km3s5o)
  (vo3 (loq 231 (kvv 3))
    (2o30 231 "nk3k()")
    (o22-o7om43o 231 xsv "o22-1nk3k")
    (zyz-3y-l4ppo1 "*o22-1nk3k*")

    ;; Xy6 wk1u 4z 3ro l4ppo1.
    (qy3y-mrk1 (zysx3-wsx))
    (6rsvo (1o-2ok1mr-py16k1n "^\\\\nk3k{" xsv 3)
      (novo3o-1oqsyx (zysx3) (z1yqx (loqsxxsxq-yp-vsxo) (zysx3)))
      (2o30 loq (zysx3))
      (2ok1mr-py16k1n "}")
      (novo3o-lkmu6k1n-mrk1 B)
      (knn-3o73-z1yzo13so2 loq (zysx3)
			   '(pkmo 4xno1vsxo
				  wy42o-pkmo rsqrvsqr3
				  rovz-71op vsl1k18))
      (oxn-yp-vsxo)))
  (qy3y-mrk1 (zysx3-wsx))
  )
