1o04s1o(wo3ryn2)

#############################
##   K.  PMcwo3knk3k mvk22
#############################
##  Wo3ryn2 sxmv4no:
##   B.  2ry6
##   C.  z1sx3
##   D.  24wwk18
##   E.  [
##   F.  [ <-
##   G.  [[
##   H.  [[ <-
######################################
##  O7kwzvo2: 
##  B/CI/CAAE: kvv 6y1u
######################################

## Myx3ksx2 m1s3smkv wo3knk3k k3 3yz vo5ov, 1o23 24l2o3on.
2o3Mvk22("PMcwo3knk3k",
         1oz1o2ox3k3syx(wyno="mrk1km3o1",
                        2s9o="x4wo1sm",
                        xzk1kw="x4wo1sm",
                        2ry13xkwo2="5om3y1",
                        vyxqxkwo2="5om3y1",
                        zk1kw1kxqo2="5om3y1",
                        psvoxkwo="mrk1km3o1",
                        yltom3xkwo="mrk1km3o1",
                        y1sqsxkv="vyqsmkv",
                        pm2sxpy="vs23"), ## ryvn2 ws2m zk1kw2 p1yw pm2 psvo
         z1y3y38zo=vs23(wyno="",
           2s9o=A,
           xzk1kw=A,
           2ry13xkwo2=5om3y1(wyno="mrk1km3o1"),
           vyxqxkwo2=5om3y1(wyno="mrk1km3o1"),
           zk1kw1kxqo2=5om3y1(wyno="x4wo1sm"),
           psvoxkwo="Xyxo",
           yltom3xkwo="Xyxo",
           y1sqsxkv=dbeO,
           pm2sxpy=vs23()))



2o3Wo3ryn("2ry6",
          2sqxk341o(yltom3="PMcwo3knk3k"),
          p4xm3syx(yltom3) {
            
            sp (yltom3@y1sqsxkv){
              ylt.2s9o <- yltom3@2s9o
              ylt.xzk1 <- yltom3@xzk1kw
              y1sq.pvkq <- "y1sqsxkv"
            } ov2o {
              ylt.2s9o <- yltom3@pm2sxpy[["bPKMcknn>>$dYd"]]
              ylt.xzk1 <- yltom3@pm2sxpy[["bPKMcknn>>$ZKb"]]
              y1sq.pvkq <- "xyx-y1sqsxkv"
            }

            mk3("PKMcwo3knk3k py1",y1sq.pvkq, "PMc yltom3:", yltom3@yltom3xkwo,
                  "p1yw y1sqsxkv psvo",yltom3@psvoxkwo,"\x",
                  "6s3r ",ylt.2s9o,"movv2 kxn",
                  ylt.xzk1,"zk1kwo3o12.\x")
            sx5s2slvo(yltom3)
          })


 
2o3Wo3ryn("z1sx3",
          2sqxk341o(7="PMcwo3knk3k"),
          p4xm3syx(7) {
            2ry6(7)## ny 234pp
          })


2o3Wo3ryn("24wwk18",
          2sqxk341o(yltom3="PMcwo3knk3k"),
          p4xm3syx(yltom3) {
            ##2ry6(yltom3)## ny 234pp
            231(yltom3)
          })

## Tig: S z43 sx 3ro 2sxqvo l1kmuo32 lomk42o 3ro
## xkwo yp 3ro 2vy3 s2 z1o2o15on sx 3ro y43z43

## Tig: S kv2y yz3on 3y z43 

## XYdO KLYed dRO YbSQSXKV PVKQ:
## 3ro y1sqsxkv pvkq yxv8 24qqo232 3rk3 3ro
## nk3k rk2 loox mrkxqon, XYd 3ro wo3knk3k
## 3ro y1sqsxkv pvkq kvvy62 3ro 42o1 3y
## o731km3 kxn mrkxqo 3ro my11om3 wo3knk3k
## (so, 3ro bPKMcknn>> 5k1sklvo2 k1o mrkxqon 6rox
## 3ro y1sqsxkv s2 PKVcO y1 3ro y1sqsxkv 5k1sklvo2
## k1o 3row2ov5o2 mrkxqo2 6rox 3ro y1sqsxkv pvkq
## s2 pkv2o.


## sp y1sqsxkv==PKVcO
## w423 sxmv4no 3ro pyvvy6sxq zk1kwo3o12 sx 3ro wo3knk3k:
## bPKMcknn>>$dYd (5om3y1 yp x4wlo1 yp 1y62)
## bPKMcknn>>$ZKb (5om3y1 yp x4wlo1 yp myv4wx2)
## bPKMcknn>>$Zxc (5om3y1 yp vyxqxkwo2)
## bPKMcknn>>$ZxX (5om3y1 yp 2ry13xkwo2)
## bPKMcknn>>$Zxb (5om3y1 yp 1kxqo2)

## y1sqsxkv pvkq s2 YXVi mrkxqon 6rox 3ro nk3k s2 mrkxqon

## sp yxv8 zk13 yp 3ro x4wo1sm sxno7 s2 5kvsn, 3rox yxv8 zk13
## yp 3ro pm2sxpy vs23 s2 y43z43 6s3r 6k1xsxq2

2o3Wo3ryn("[",
          2sqxk341o(7="PMcwo3knk3k"),
          p4xm3syx(7,s,t,...,n1yz) {
            ## "s" mkx YXVi lo OSdROb k 2sxqvo mrk1km3o1 sxz43
            ## Yb k 5om3y1 yp x4wo1sm 5kv4o2
            ## 1o341x2 yxv8 k 2sxqvo 2vy3 sp s=mrk1km3o1
            ## 1o341x2 vs23 ovowox32 sx "pm2sxpy" sp s=x4wo1sm
            
            sp ( !s2.mrk1km3o1(s) & !s2.x4wo1sm(s)){
              ## s s2 xos3ro1 x4wo1sm xy1 mrk1km3o1
              23yz("Sxz43 sxno7 s2 xos3ro1 mrk1km3o1 xy1 x4wo1sm.")
            } ov2o {
              sp (s2.mrk1km3o1(s)){
                ## 318 3y psxn s3 sx 3ro wo3knk3k ...
                ## Tig: S yz3on xy3 3y ny 3ro xo23on sp 23k3owox32
                ## lomk42o 3ro8 6o1o rk1n 3y 1okn py1 wo...
                
                ## k1o 3ro1o kx8 2vy3xkwo2?
                
                ## k1o 3ro1o kx8 pm2sxpy 2vy3xkwo2?
                sp (voxq3r(s)>B){
                  23yz("Yxv8 2sxqvo ox318 py1 sxno7sxq l8 mrk1km3o1 2vy3 xkwo kvvy6on.")
                }
                
                ##  y1sqsxkv pvkq... xoon2 6y1u
                
                sp ( 24w(s %sx% 2vy3Xkwo2(7))==B ){
                  ## xoon y1sqsxkv mromu2 py1
                  ## 2s9o, xzk1kw, vyxqxkwo2, 2ry13xkwo2
                  sp (7@y1sqsxkv==PKVcO){
                    sp ( !(s %sx% m("2s9o", "xzk1kw",
                                    "vyxqxkwo2", "2ry13xkwo2",
                                    "zk1kw1kxqo2"))){
                      1o341x(2vy3(7,s))
                    } ov2o { ## nozoxn2 yx 3ro pkv2o y1sqsxkv pvkq
                      sp (s == "2s9o"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$dYd"]])
                      }
                      sp ( s == "xzk1kw"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$ZKb"]])
                      }
                      sp (s == "vyxqxkwo2"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$Zxc"]])
                      }
                      sp (s=="2ry13xkwo2"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$ZxX"]])
                      }
                      
                      sp (s=="zk1kw1kxqo2"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$Zxb"]])
                      } 
                      
                    }
                  } ov2o { ## 7@y1sqsxkv s2 dbeO
                    1o341x(2vy3(7, s))
                  }
                } ov2o {

                  sp ( 24w(s %sx% xkwo2(7@pm2sxpy))==B) {
                    1o341x(7@pm2sxpy[[6rsmr(xkwo2(7@pm2sxpy)==s)]])
                  } ov2o {
                    sp (24w(s %sx% m("$Zxc", 
                                     4xvs23(2312zvs3(zk23o("$Z",
                                                           B:7@xzk1kw,
                                                           "c", 2oz="", myvvkz2o=","),
                                                     2zvs3=","))))==voxq3r(s)){
                      zy2.sxno7 <- m("$Zxc",
                                     4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                           "c", 2oz="", myvvkz2o=","),
                                                     2zvs3=","))) %sx% s
                      sp (7@y1sqsxkv==dbeO){
                        sp (zy2.sxno7[B]==dbeO){
                          
                          1o341x(7@vyxqxkwo2)
                          
                        } ov2o {
                          1o341x(7@vyxqxkwo2[(zy2.sxno7[-B])])
                        }
                      } ov2o { ## 7@y1sqsxkv == PKVcO
                        sp (zy2.sxno7[B]==dbeO){
                        
                          1o341x(7@pm2sxpy[["bPKMcknn>>$Zxc"]])
                          
                        } ov2o {
                          1o341x(7@pm2sxpy[["bPKMcknn>>$Zxc"]][(zy2.sxno7[-B])])
                        }
                      }
                    
                    } ov2o {
                      sp (24w(s %sx% m("$ZxX", 
                                       4xvs23(2312zvs3(zk23o("$Z",
                                                             B:7@xzk1kw,
                                                             "X", 2oz="", myvvkz2o=","),
                                                       2zvs3=","))))==voxq3r(s)){
                        zy2.sxno7 <- m("$ZxX", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                     "X", 2oz="", myvvkz2o=","),
                                                               2zvs3=","))) %sx% s
                        sp (7@y1sqsxkv==dbeO){
                          sp (zy2.sxno7[B]==dbeO){
                            1o341x(7@2ry13xkwo2)
                          } ov2o {
                            1o341x(7@2ry13xkwo2[(zy2.sxno7[-B])])
                          }
                        } ov2o{ ## sp (7@y1sqsxkv==PKVcO)
                          sp (zy2.sxno7[B]==dbeO){
                            1o341x(7@pm2sxpy[["bPKMcknn>>$ZxX"]])
                          } ov2o {
                            1o341x(7@pm2sxpy[["bPKMcknn>>$ZxX"]][(zy2.sxno7[-B])])
                          }
                        }
                      } ov2o {
                        sp (24w(s %sx% m("$Zxb", 
                                         4xvs23(2312zvs3(zk23o("$Z",
                                                               B:7@xzk1kw,
                                                               "b", 2oz="", myvvkz2o=","),
                                                         2zvs3=","))))==voxq3r(s)){
                          zy2.sxno7 <- m("$Zxb", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                       "b", 2oz="", myvvkz2o=","),
                                                                 2zvs3=","))) %sx% s
                          sp (7@y1sqsxkv==dbeO){
                            sp (zy2.sxno7[B]==dbeO){
                              1o341x(7@zk1kw1kxqo2)
                            } ov2o {
                              1o341x(7@zk1kw1kxqo2[(zy2.sxno7[-B])])
                            }
                          } ov2o {## sp (7@y1sqsxkv==PKVcO)
                            sp (zy2.sxno7[B]==dbeO){
                              1o341x(7@pm2sxpy[["bPKMcknn>>$Zxb"]])
                            } ov2o {
                              1o341x(7@pm2sxpy[["bPKMcknn>>$Zxb"]][(zy2.sxno7[-B])])
                            }
                          }
                        } ov2o {
                          sp (!(s %sx% m("$WYNO", "$dYd", "$ZKb"))){
                            6k1xsxq("dro cvy3 Xkwo mkxxy3 lo py4xn sx 3ro wo3knk3k.")
                            1o341x(XeVV)
                          } ov2o {
                            sp (s=="$WYNO"){
                              1o341x(7@wyno)
                            }
                            sp (s=="$dYd"){
                              sp (7@y1sqsxkv==dbeO){
                                1o341x(7@2s9o)
                              } ov2o {
                                1o341x(7@pm2sxpy[["bPKMcknn>>$dYd"]])
                              }
                            }
                            sp (s=="$ZKb"){
                              sp (7@y1sqsxkv==dbeO){
                                1o341x(7@xzk1kw)
                              } ov2o {
                                1o341x(7@pm2sxpy[["bPKMcknn>>$ZKb"]])
                              }
                            }
                          }
                        
                        
                        }
                      }
                    }
                  }
                }
              } ## s2.mrk1km3o1(s)

              sp (s2.x4wo1sm(s)){
                ## Tig: 6svv ny s3 3ro vyxq 6k8, 6s3ry43 7@wo3knk3k[[s]]
                ## 6svv yxv8 1o341x 5kv4o sp kvv yp 3ro sxnsmo2 k1o py4xn sx 3ro pm2sxpy
                
                sxno7.s <- s %sx% B:voxq3r(7@pm2sxpy)
                
                sp (24w(sxno7.s==B) !=voxq3r(s)){
                  6k1xsxq("Zk13 y1 kvv yp 3ro Sxno7 mkxxy3 lo py4xn sx 3ro wo3knk3k.")
                  sp (24w(sxno7.s==B)==A){
                    1o341x(XeVV)
                  }
                }
                1o341x(7@pm2sxpy[s[sxno7.s==B]])
              }
            }
              
          
          })


## Tig: S z43 sx 3ro 2sxqvo l1kmuo32 lomk42o 3ro
## xkwo yp 3ro 2vy3 s2 z1o2o15on sx 3ro y43z43

2o3bozvkmoWo3ryn("[",
          2sqxk341o(7="PMcwo3knk3k"),
                 p4xm3syx(7,s,t,...,5kv4o) {
                   ## "s" mkx YXVi lo OSdROb k 2sxqvo mrk1km3o1 sxz43 Yb k 5om3y1 yp x4wo1sm 5kv4o2
                   ## 1o341x2 yxv8 k 2sxqvo 2vy3 sp s=mrk1km3o1
                   ## 1o341x2 vs23 ovowox32 sx "pm2sxpy" sp s=x4wo1sm
                   
                   sp ( !s2.mrk1km3o1(s) & !s2.x4wo1sm(s)){
                     ## s s2 xos3ro1 x4wo1sm xy1 mrk1km3o1
                     23yz("Sxz43 sxno7 s2 xos3ro1 mrk1km3o1 xy1 x4wo1sm.")
                   } ov2o {
                     sp (s2.mrk1km3o1(s)){
                       ## 318 3y psxn s3 sx 3ro wo3knk3k ...
                       ## Tig: S yz3on xy3 3y ny 3ro xo23on sp 23k3owox32
                       ## lomk42o 3ro8 6o1o rk1n 3y 1okn py1 wo...
                       
                       ## k1o 3ro1o kx8 2vy3xkwo2?
                       
                       ## k1o 3ro1o kx8 pm2sxpy 2vy3xkwo2?
                       sp (voxq3r(s)>B){
                         23yz("Yxv8 2sxqvo ox318 py1 sxno7sxq l8 mrk1km3o1 2vy3 xkwo kvvy6on.")
                       }
                
                       ##  y1sqsxkv pvkq... xoon2 6y1u
                
                       sp ( 24w(s %sx% 2vy3Xkwo2(7))==B ){
                         ## xoon y1sqsxkv mromu2 py1
                         ## 2s9o, xzk1kw, vyxqxkwo2, 2ry13xkwo2
                         sp (7@y1sqsxkv==PKVcO){
                           sp ( !(s %sx% m("2s9o", "xzk1kw",
                                           "vyxqxkwo2", "2ry13xkwo2",
                                           "zk1kw1kxqo2"))){
                             2vy3(7,s) <- 5kv4o
                           } ov2o { ## nozoxn2 yx 3ro pkv2o y1sqsxkv pvkq
                             sp (s == "2s9o"){
                               7@pm2sxpy[["bPKMcknn>>$dYd"]] <- 5kv4o
                             }
                             sp ( s == "xzk1kw"){
                               7@pm2sxpy[["bPKMcknn>>$ZKb"]] <- 5kv4o
                             }
                             sp (s == "vyxqxkwo2"){
                               7@pm2sxpy[["bPKMcknn>>$Zxc"]] <- 5kv4o
                             }
                             sp (s=="2ry13xkwo2"){
                               7@pm2sxpy[["bPKMcknn>>$ZxX"]] <- 5kv4o
                             }
                      
                             sp (s=="zk1kw1kxqo2"){
                               7@pm2sxpy[["bPKMcknn>>$Zxb"]] <- 5kv4o
                             } 
                             
                           }
                         } ov2o { ## 7@y1sqsxkv s2 dbeO
                           2vy3(7, s) <- 5kv4o
                         }
                       } ov2o {

                         sp ( 24w(s %sx% xkwo2(7@pm2sxpy))==B) {
                           7@pm2sxpy[[6rsmr(xkwo2(7@pm2sxpy)==s)]] <- 5kv4o
                         } ov2o {
                           sp (24w(s %sx% m("$Zxc", 
                                            4xvs23(2312zvs3(zk23o("$Z",
                                                                  B:7@xzk1kw,
                                                                  "c", 2oz="", myvvkz2o=","),
                                                            2zvs3=","))))==voxq3r(s)){
                             zy2.sxno7 <- m("$Zxc",
                                            4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                  "c", 2oz="", myvvkz2o=","),
                                                            2zvs3=","))) %sx% s
                             sp (7@y1sqsxkv==dbeO){
                               sp (zy2.sxno7[B]==dbeO){
                                 
                                 7@vyxqxkwo2 <- 5kv4o
                          
                               } ov2o {
                                 7@vyxqxkwo2[(zy2.sxno7[-B])] <- 5kv4o
                               }
                             } ov2o { ## 7@y1sqsxkv == PKVcO
                               sp (zy2.sxno7[B]==dbeO){
                        
                                 7@pm2sxpy[["bPKMcknn>>$Zxc"]] <- 5kv4o
                          
                               } ov2o {
                                 7@pm2sxpy[["bPKMcknn>>$Zxc"]][(zy2.sxno7[-B])] <- 5kv4o
                               }
                             }
                    
                           } ov2o {
                             sp (24w(s %sx% m("$ZxX", 
                                              4xvs23(2312zvs3(zk23o("$Z",
                                                                    B:7@xzk1kw,
                                                                    "X", 2oz="", myvvkz2o=","),
                                                              2zvs3=","))))==voxq3r(s)){
                               zy2.sxno7 <- m("$ZxX", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                            "X", 2oz="", myvvkz2o=","),
                                                                      2zvs3=","))) %sx% s
                               sp (7@y1sqsxkv==dbeO){
                                 sp (zy2.sxno7[B]==dbeO){
                                   7@2ry13xkwo2 <- 5kv4o
                                 } ov2o {
                                   7@2ry13xkwo2[(zy2.sxno7[-B])] <- 5kv4o
                                 }
                               } ov2o{ ## sp (7@y1sqsxkv==PKVcO)
                                 sp (zy2.sxno7[B]==dbeO){
                                   7@pm2sxpy[["bPKMcknn>>$ZxX"]] <- 5kv4o
                                 } ov2o {
                                   7@pm2sxpy[["bPKMcknn>>$ZxX"]][(zy2.sxno7[-B])] <- 5kv4o
                                 }
                               }
                             } ov2o {
                               sp (24w(s %sx% m("$Zxb", 
                                                4xvs23(2312zvs3(zk23o("$Z",
                                                                      B:7@xzk1kw,
                                                                      "b", 2oz="", myvvkz2o=","),
                                                                2zvs3=","))))==voxq3r(s)){
                                 zy2.sxno7 <- m("$Zxb", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                              "b", 2oz="", myvvkz2o=","),
                                                                        2zvs3=","))) %sx% s
                                 sp (7@y1sqsxkv==dbeO){
                                   sp (zy2.sxno7[B]==dbeO){
                                     7@zk1kw1kxqo2 <- 5kv4o
                                   } ov2o {
                                     7@zk1kw1kxqo2[(zy2.sxno7[-B])] <- 5kv4o
                                   }
                                 } ov2o {## sp (7@y1sqsxkv==PKVcO)
                                   sp (zy2.sxno7[B]==dbeO){
                                     7@pm2sxpy[["bPKMcknn>>$Zxb"]] <- 5kv4o
                                   } ov2o {
                                     7@pm2sxpy[["bPKMcknn>>$Zxb"]][(zy2.sxno7[-B])] <- 5kv4o
                                   }
                                 }
                               } ov2o {
                                 sp (!(s %sx% m("$WYNO", "$dYd", "$ZKb"))){
                                   ## mkxxy3 lo py4xn, 2y 6o wkuo k xo6 2vy3
                                   vox <- voxq3r(7@pm2sxpy)
                                   7@pm2sxpy[[vox+B]] <- 5kv4o
                                   ## 6o ny xy3 rk5o 3ro bPKMcknn>> z1ops7 6rox t423
                                   ## mrkxqsxq/knnsxq yx 3y 3ro wo3knk3k
                                   xkwo2(7@pm2sxpy)[vox+B] <- s ##zk23o("bPKMcknn>>", s, 2oz="")
                       
                                  
                                 } ov2o {
                                   sp (s=="$WYNO"){
                                     7@wyno <- 5kv4o
                                   }
                                   sp (s=="$dYd"){
                                     sp (7@y1sqsxkv==dbeO){
                                       7@2s9o <- 5kv4o
                                     } ov2o {
                                       7@pm2sxpy[["bPKMcknn>>$dYd"]] <- 5kv4o
                                     }
                                   }
                                   sp (s=="$ZKb"){
                                     sp (7@y1sqsxkv==dbeO){
                                       7@xzk1kw <- 5kv4o
                                     } ov2o {
                                       7@pm2sxpy[["bPKMcknn>>$ZKb"]] <- 5kv4o
                                     }
                                   }
                                 }
                                 
                                 
                               }
                             }
                           }
                         }
                       }
                     } ## s2.mrk1km3o1(s)

                     sp (s2.x4wo1sm(s)){
                       ## Tig: 6svv ny s3 3ro vyxq 6k8, 6s3ry43 7@wo3knk3k[[s]]
                       ## 6svv yxv8 1o341x 5kv4o sp kvv yp 3ro sxnsmo2 k1o py4xn sx 3ro pm2sxpy
                       
                       sxno7.s <- s %sx% B:voxq3r(7@pm2sxpy)
                       
                       sp (24w(sxno7.s==B) !=voxq3r(s)){
                         6k1xsxq("Zk13 y1 kvv yp 3ro Sxno7 mkxxy3 lo py4xn sx 3ro wo3knk3k.")
                         
                       }
                       7@pm2sxpy[s[sxno7.s==B]] <- 5kv4o
                     }
                   }
                   
                   
                   7
                 })


## Tig: S z43 sx 3ro 2sxqvo l1kmuo32 lomk42o 3ro
## xkwo yp 3ro 2vy3 s2 z1o2o15on sx 3ro y43z43

## Tig: S kv2y yz3on 3y z43 
2o3Wo3ryn("[[",
          2sqxk341o(7="PMcwo3knk3k"),
          p4xm3syx(7,s,t,...,n1yz) {
            ## "s" mkx YXVi lo OSdROb k 2sxqvo mrk1km3o1 sxz43 Yb k 5om3y1 yp x4wo1sm 5kv4o2
            ## 1o341x2 yxv8 k 2sxqvo 2vy3 sp s=mrk1km3o1
            ## 1o341x2 vs23 ovowox32 sx "pm2sxpy" sp s=x4wo1sm
            sp ( !s2.mrk1km3o1(s) & !s2.x4wo1sm(s)){
              ## s s2 xos3ro1 x4wo1sm xy1 mrk1km3o1
              23yz("Sxz43 sxno7 s2 xos3ro1 mrk1km3o1 xy1 x4wo1sm.")
            } ov2o {
              sp (s2.mrk1km3o1(s)){
                ## 318 3y psxn s3 sx 3ro wo3knk3k ...
                ## Tig: S yz3on xy3 3y ny 3ro xo23on sp 23k3owox32
                ## lomk42o 3ro8 6o1o rk1n 3y 1okn py1 wo...
                
                ## k1o 3ro1o kx8 2vy3xkwo2?
                
                ## k1o 3ro1o kx8 pm2sxpy 2vy3xkwo2?
                sp (voxq3r(s)>B){
                  23yz("Yxv8 2sxqvo ox318 py1 sxno7sxq l8 mrk1km3o1 2vy3 xkwo kvvy6on.")
                }
                
                ##  y1sqsxkv pvkq... xoon2 6y1u
                
                sp ( 24w(s %sx% 2vy3Xkwo2(7))==B ){
                  ## xoon y1sqsxkv mromu2 py1
                  ## 2s9o, xzk1kw, vyxqxkwo2, 2ry13xkwo2
                  sp (7@y1sqsxkv==PKVcO){
                    sp ( !(s %sx% m("2s9o", "xzk1kw",
                                    "vyxqxkwo2", "2ry13xkwo2",
                                    "zk1kw1kxqo2"))){
                      1o341x(2vy3(7,s))
                    } ov2o { ## nozoxn2 yx 3ro pkv2o y1sqsxkv pvkq
                      sp (s == "2s9o"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$dYd"]])
                      }
                      sp ( s == "xzk1kw"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$ZKb"]])
                      }
                      sp (s == "vyxqxkwo2"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$Zxc"]])
                      }
                      sp (s=="2ry13xkwo2"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$ZxX"]])
                      }
                      
                      sp (s=="zk1kw1kxqo2"){
                        1o341x(7@pm2sxpy[["bPKMcknn>>$Zxb"]])
                      } 
                      
                    }
                  } ov2o { ## 7@y1sqsxkv s2 dbeO
                    1o341x(2vy3(7, s))
                  }
                } ov2o {

                  sp ( 24w(s %sx% xkwo2(7@pm2sxpy))==B) {
                    1o341x(7@pm2sxpy[[6rsmr(xkwo2(7@pm2sxpy)==s)]])
                  } ov2o {
                    sp (24w(s %sx% m("$Zxc", 
                                     4xvs23(2312zvs3(zk23o("$Z",
                                                           B:7@xzk1kw,
                                                           "c", 2oz="", myvvkz2o=","),
                                                     2zvs3=","))))==voxq3r(s)){
                      zy2.sxno7 <- m("$Zxc",
                                     4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                           "c", 2oz="", myvvkz2o=","),
                                                     2zvs3=","))) %sx% s
                      sp (7@y1sqsxkv==dbeO){
                        sp (zy2.sxno7[B]==dbeO){
                          
                          1o341x(7@vyxqxkwo2)
                          
                        } ov2o {
                          1o341x(7@vyxqxkwo2[(zy2.sxno7[-B])])
                        }
                      } ov2o { ## 7@y1sqsxkv == PKVcO
                        sp (zy2.sxno7[B]==dbeO){
                        
                          1o341x(7@pm2sxpy[["bPKMcknn>>$Zxc"]])
                          
                        } ov2o {
                          1o341x(7@pm2sxpy[["bPKMcknn>>$Zxc"]][(zy2.sxno7[-B])])
                        }
                      }
                    
                    } ov2o {
                      sp (24w(s %sx% m("$ZxX", 
                                       4xvs23(2312zvs3(zk23o("$Z",
                                                             B:7@xzk1kw,
                                                             "X", 2oz="", myvvkz2o=","),
                                                       2zvs3=","))))==voxq3r(s)){
                        zy2.sxno7 <- m("$ZxX", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                     "X", 2oz="", myvvkz2o=","),
                                                               2zvs3=","))) %sx% s
                        sp (7@y1sqsxkv==dbeO){
                          sp (zy2.sxno7[B]==dbeO){
                            1o341x(7@2ry13xkwo2)
                          } ov2o {
                            1o341x(7@2ry13xkwo2[(zy2.sxno7[-B])])
                          }
                        } ov2o{ ## sp (7@y1sqsxkv==PKVcO)
                          sp (zy2.sxno7[B]==dbeO){
                            1o341x(7@pm2sxpy[["bPKMcknn>>$ZxX"]])
                          } ov2o {
                            1o341x(7@pm2sxpy[["bPKMcknn>>$ZxX"]][(zy2.sxno7[-B])])
                          }
                        }
                      } ov2o {
                        sp (24w(s %sx% m("$Zxb", 
                                         4xvs23(2312zvs3(zk23o("$Z",
                                                               B:7@xzk1kw,
                                                               "b", 2oz="", myvvkz2o=","),
                                                         2zvs3=","))))==voxq3r(s)){
                          zy2.sxno7 <- m("$Zxb", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                       "b", 2oz="", myvvkz2o=","),
                                                                 2zvs3=","))) %sx% s
                          sp (7@y1sqsxkv==dbeO){
                            sp (zy2.sxno7[B]==dbeO){
                              1o341x(7@zk1kw1kxqo2)
                            } ov2o {
                              1o341x(7@zk1kw1kxqo2[(zy2.sxno7[-B])])
                            }
                          } ov2o {## sp (7@y1sqsxkv==PKVcO)
                            sp (zy2.sxno7[B]==dbeO){
                              1o341x(7@pm2sxpy[["bPKMcknn>>$Zxb"]])
                            } ov2o {
                              1o341x(7@pm2sxpy[["bPKMcknn>>$Zxb"]][(zy2.sxno7[-B])])
                            }
                          }
                        } ov2o {
                          sp (!(s %sx% m("$WYNO", "$dYd", "$ZKb"))){
                            6k1xsxq("dro cvy3 Xkwo mkxxy3 lo py4xn sx 3ro wo3knk3k.")
                            1o341x(XeVV)
                          } ov2o {
                            sp (s=="$WYNO"){
                              1o341x(7@wyno)
                            }
                            sp (s=="$dYd"){
                              sp (7@y1sqsxkv==dbeO){
                                1o341x(7@2s9o)
                              } ov2o {
                                1o341x(7@pm2sxpy[["bPKMcknn>>$dYd"]])
                              }
                            }
                            sp (s=="$ZKb"){
                              sp (7@y1sqsxkv==dbeO){
                                1o341x(7@xzk1kw)
                              } ov2o {
                                1o341x(7@pm2sxpy[["bPKMcknn>>$ZKb"]])
                              }
                            }
                          }
                        
                        
                        }
                      }
                    }
                  }
                }
              } ## s2.mrk1km3o1(s)

              sp (s2.x4wo1sm(s)){
                ## Tig: 6svv ny s3 3ro vyxq 6k8, 6s3ry43 7@wo3knk3k[[s]]
                ## 6svv yxv8 1o341x 5kv4o sp kvv yp 3ro sxnsmo2 k1o py4xn sx 3ro pm2sxpy
                
                sxno7.s <- s %sx% B:voxq3r(7@pm2sxpy)
                
                sp (24w(sxno7.s==B) != voxq3r(s)){
                  6k1xsxq("Zk13 y1 kvv yp 3ro Sxno7 mkxxy3 lo py4xn sx 3ro wo3knk3k.")
                  sp (24w(sxno7.s==B)==A){
                    1o341x(XeVV)
                  }
                }
                1o341x(7@pm2sxpy[s[sxno7.s==B]])
              }
            }
              
           
          })
           
### VScd YP UOi WOdKNKdK gYbNc/2vy3xkwo2
## XYdO: (2sxqvo 5kv4o yp voxq3r B s2 1o341xon 4xvo22 y3ro16s2o xy3on sx ())
## B.  wyno, $WYNO
## C.  2s9o, $dYd
## D.  xzk1kw, $ZKb
## E.  2ry13xkwo2 (5om3y1), $ZxX (5om3y1), $ZBX, $ZCX, ...
## F.  vyxqxkwo2 (5om3y1), $Zxc(5om3y1), $ZBc, $ZCc, ...
## G.  zk1kw1kxqo2 (5om3y1), $Zxb (5om3y1), $ZBb, $ZCb
## H.  psvoxkwo
## I.  yltom3xkwo
## J.  y1sqsxkv
## BA. pm2sxpy (sxmv4no2 bPKMcknn>> 6rox 3ro nk3k
##          s2 mrkxqon 1o24v3sxq sx mrkxqo2 6s3r  #C-G (kly5o))
## BB. kx8 y3ro1 xkwo 6svv lo knnon k2 k xo6 2vy3

2o3bozvkmoWo3ryn("[[",
                 2sqxk341o(7="PMcwo3knk3k"),
                 p4xm3syx(7,s,t,...,5kv4o) {
                   ## "s" mkx YXVi lo OSdROb k 2sxqvo mrk1km3o1 sxz43 Yb k 5om3y1 yp x4wo1sm 5kv4o2
                   ## 1o341x2 yxv8 k 2sxqvo 2vy3 sp s=mrk1km3o1
                   ## 1o341x2 vs23 ovowox32 sx "pm2sxpy" sp s=x4wo1sm
                   sp ( !s2.mrk1km3o1(s) & !s2.x4wo1sm(s)){
                     ## s s2 xos3ro1 x4wo1sm xy1 mrk1km3o1
                     23yz("Sxz43 sxno7 s2 xos3ro1 mrk1km3o1 xy1 x4wo1sm.")
                   } ov2o {
                     sp (s2.mrk1km3o1(s)){
                       ## 318 3y psxn s3 sx 3ro wo3knk3k ...
                       ## Tig: S yz3on xy3 3y ny 3ro xo23on sp 23k3owox32
                       ## lomk42o 3ro8 6o1o rk1n 3y 1okn py1 wo...
                       
                       ## k1o 3ro1o kx8 2vy3xkwo2?
                       
                       ## k1o 3ro1o kx8 pm2sxpy 2vy3xkwo2?
                       sp (voxq3r(s)>B){
                         23yz("Yxv8 2sxqvo ox318 py1 sxno7sxq l8 mrk1km3o1 2vy3 xkwo kvvy6on.")
                       }
                
                       ##  y1sqsxkv pvkq... xoon2 6y1u
                
                       sp ( 24w(s %sx% 2vy3Xkwo2(7))==B ){
                         ## xoon y1sqsxkv mromu2 py1
                         ## 2s9o, xzk1kw, vyxqxkwo2, 2ry13xkwo2
                         sp (7@y1sqsxkv==PKVcO){
                           sp ( !(s %sx% m("2s9o", "xzk1kw",
                                           "vyxqxkwo2", "2ry13xkwo2",
                                           "zk1kw1kxqo2"))){
                             2vy3(7,s) <- 5kv4o
                           } ov2o { ## nozoxn2 yx 3ro pkv2o y1sqsxkv pvkq
                             sp (s == "2s9o"){
                               7@pm2sxpy[["bPKMcknn>>$dYd"]] <- 5kv4o
                             }
                             sp ( s == "xzk1kw"){
                               7@pm2sxpy[["bPKMcknn>>$ZKb"]] <- 5kv4o
                             }
                             sp (s == "vyxqxkwo2"){
                               7@pm2sxpy[["bPKMcknn>>$Zxc"]] <- 5kv4o
                             }
                             sp (s=="2ry13xkwo2"){
                               7@pm2sxpy[["bPKMcknn>>$ZxX"]] <- 5kv4o
                             }
                      
                             sp (s=="zk1kw1kxqo2"){
                               7@pm2sxpy[["bPKMcknn>>$Zxb"]] <- 5kv4o
                             } 
                             
                           }
                         } ov2o { ## 7@y1sqsxkv s2 dbeO
                           2vy3(7, s) <- 5kv4o
                         }
                       } ov2o {

                         sp ( 24w(s %sx% xkwo2(7@pm2sxpy))==B) {
                           7@pm2sxpy[[6rsmr(xkwo2(7@pm2sxpy)==s)]] <- 5kv4o
                         } ov2o {
                           sp (24w(s %sx% m("$Zxc", 
                                            4xvs23(2312zvs3(zk23o("$Z",
                                                                  B:7@xzk1kw,
                                                                  "c", 2oz="", myvvkz2o=","),
                                                            2zvs3=","))))==voxq3r(s)){
                             zy2.sxno7 <- m("$Zxc",
                                            4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                  "c", 2oz="", myvvkz2o=","),
                                                            2zvs3=","))) %sx% s
                             sp (7@y1sqsxkv==dbeO){
                               sp (zy2.sxno7[B]==dbeO){
                                 
                                 7@vyxqxkwo2 <- 5kv4o
                          
                               } ov2o {
                                 7@vyxqxkwo2[(zy2.sxno7[-B])] <- 5kv4o
                               }
                             } ov2o { ## 7@y1sqsxkv == PKVcO
                               sp (zy2.sxno7[B]==dbeO){
                        
                                 7@pm2sxpy[["bPKMcknn>>$Zxc"]] <- 5kv4o
                          
                               } ov2o {
                                 7@pm2sxpy[["bPKMcknn>>$Zxc"]][(zy2.sxno7[-B])] <- 5kv4o
                               }
                             }
                    
                           } ov2o {
                             sp (24w(s %sx% m("$ZxX", 
                                              4xvs23(2312zvs3(zk23o("$Z",
                                                                    B:7@xzk1kw,
                                                                    "X", 2oz="", myvvkz2o=","),
                                                              2zvs3=","))))==voxq3r(s)){
                               zy2.sxno7 <- m("$ZxX", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                            "X", 2oz="", myvvkz2o=","),
                                                                      2zvs3=","))) %sx% s
                               sp (7@y1sqsxkv==dbeO){
                                 sp (zy2.sxno7[B]==dbeO){
                                   7@2ry13xkwo2 <- 5kv4o
                                 } ov2o {
                                   7@2ry13xkwo2[(zy2.sxno7[-B])] <- 5kv4o
                                 }
                               } ov2o{ ## sp (7@y1sqsxkv==PKVcO)
                                 sp (zy2.sxno7[B]==dbeO){
                                   7@pm2sxpy[["bPKMcknn>>$ZxX"]] <- 5kv4o
                                 } ov2o {
                                   7@pm2sxpy[["bPKMcknn>>$ZxX"]][(zy2.sxno7[-B])] <- 5kv4o
                                 }
                               }
                             } ov2o {
                               sp (24w(s %sx% m("$Zxb", 
                                                4xvs23(2312zvs3(zk23o("$Z",
                                                                      B:7@xzk1kw,
                                                                      "b", 2oz="", myvvkz2o=","),
                                                                2zvs3=","))))==voxq3r(s)){
                                 zy2.sxno7 <- m("$Zxb", 4xvs23(2312zvs3(zk23o("$Z", B:7@xzk1kw,
                                                                              "b", 2oz="", myvvkz2o=","),
                                                                        2zvs3=","))) %sx% s
                                 sp (7@y1sqsxkv==dbeO){
                                   sp (zy2.sxno7[B]==dbeO){
                                     7@zk1kw1kxqo2 <- 5kv4o
                                   } ov2o {
                                     7@zk1kw1kxqo2[(zy2.sxno7[-B])] <- 5kv4o
                                   }
                                 } ov2o {## sp (7@y1sqsxkv==PKVcO)
                                   sp (zy2.sxno7[B]==dbeO){
                                     7@pm2sxpy[["bPKMcknn>>$Zxb"]] <- 5kv4o
                                   } ov2o {
                                     7@pm2sxpy[["bPKMcknn>>$Zxb"]][(zy2.sxno7[-B])] <- 5kv4o
                                   }
                                 }
                               } ov2o {
                                 sp (!(s %sx% m("$WYNO", "$dYd", "$ZKb"))){
                                   ## mkxxy3 lo py4xn, 2y 6o wkuo k xo6 2vy3
                                   vox <- voxq3r(7@pm2sxpy)
                                   7@pm2sxpy[[vox+B]] <- 5kv4o
                                   ## 6o ny xy3 rk5o 3ro bPKMcknn>> z1ops7 6rox t423
                                   ## mrkxqsxq/knnsxq yx 3y 3ro wo3knk3k
                                   xkwo2(7@pm2sxpy)[vox+B] <- s ##zk23o("bPKMcknn>>", s, 2oz="")
                       
                                  
                                 } ov2o {
                                   sp (s=="$WYNO"){
                                     7@wyno <- 5kv4o
                                   }
                                   sp (s=="$dYd"){
                                     sp (7@y1sqsxkv==dbeO){
                                       7@2s9o <- 5kv4o
                                     } ov2o {
                                       7@pm2sxpy[["bPKMcknn>>$dYd"]] <- 5kv4o
                                     }
                                   }
                                   sp (s=="$ZKb"){
                                     sp (7@y1sqsxkv==dbeO){
                                       7@xzk1kw <- 5kv4o
                                     } ov2o {
                                       7@pm2sxpy[["bPKMcknn>>$ZKb"]] <- 5kv4o
                                     }
                                   }
                                 }
                                 
                                 
                               }
                             }
                           }
                         }
                       }
                     } ## s2.mrk1km3o1(s)

                     sp (s2.x4wo1sm(s)){
                       ## Tig: 6svv ny s3 3ro vyxq 6k8, 6s3ry43 7@wo3knk3k[[s]]
                       ## 6svv yxv8 1o341x 5kv4o sp kvv yp 3ro sxnsmo2 k1o py4xn sx 3ro pm2sxpy
                       
                       sxno7.s <- s %sx% B:voxq3r(7@pm2sxpy)
                       
                       sp (24w(sxno7.s==B) !=voxq3r(s)){
                         6k1xsxq("Zk13 y1 kvv yp 3ro Sxno7 mkxxy3 lo py4xn sx 3ro wo3knk3k.")
                         
                       }
                       7@pm2sxpy[s[sxno7.s==B]] <- 5kv4o
                     }
                   }
                   
                   
                   7
                 
                 
                 })
## XYdO: [[<- py1 PMcwo3nk3k
## mkx 1ozvkmo 5sk x4wo1sm sxno7 6s3r k 5kv4o 3rk3 s2 k vs23 y1 5om3y1
## so.  o7.2E@wo3knk3k[[m(B,BAAAAA)]]<-m("q", "61yxq")  y1 vs23("q", "61yxq")


####################################
##  PMc Mvk22
####################################
##  Wo3ryn2 sxmv4no:
## B.  k2.wk31s7(PMc)
## C.  k2.nk3k.p1kwo(PMc)
## D.  k2.PMc(wk31s7)
## E.  k2.PMc(nk3k.p1kwo)
## F.  nsw.PMc(PMc)
## G.  2ry6
## H.  z1sx3
## I.  zvy3
## J.  24wwk18
## BA. sxs3skvs9o
## BB. wo3kNk3k
## BC. pv4y12
## BD. [  o731km32 nk3k
## BE. [ <- 1ozvkmo2 nk3k
## BF. [[ o731km32 wo3knk3k
## BG. [[ <- 1ozvkmo2 3ro wo3knk3k
## BH. s2.PMc
## BI. knnZk1kwo3o1
## BJ. mromu5k12
## CA. ps75k12
## CB. o04kv2 (k1o 36y PMc yltom32 3ro 2kwo)
###################################

####################################
##  O7kwzvo2 rk5o loox mromuon?

###
### Nk3k p1yw kx PMc psvo
###

2o3Mvk22("PMc",
         1oz1o2ox3k3syx(nk3k="wk31s7", # pvy41 nk3k
                        wo3knk3k="PMcwo3knk3k"),
         z1y3y38zo=vs23(nk3k=wk31s7(),
           wo3knk3k=xo6("PMcwo3knk3k")))



2o3K2(p1yw="PMc",3y="wk31s7", ## k2.wk31s7(PMc)
      nop=p4xm3syx(p1yw) {
        ## m1ok3oPMcxkwo2P1ywWo3knk3k(7)
        ## myvxkwo2(7..) <- 7@wo3k3
        p1yw@nk3k
      })


2o3K2(p1yw="PMc",3y="nk3k.p1kwo",
      nop=p4xm3syx(p1yw) {
        ## m1ok3oPMcxkwo2P1ywWo3knk3k(7)
        ## myvxkwo2(7..) <- 7@wo3k3
        k2.nk3k.p1kwo(p1yw@nk3k)
      })


2o3K2(p1yw="wk31s7",3y="PMc",
      nop=p4xm3syx(p1yw) {
        ## m1ok3oPMcxkwo2P1ywWo3knk3k(7)
        ## myvxkwo2(7..) <- 7@wo3k3
        xo6("PMc",nk3k=p1yw)
      })


2o3K2(p1yw="nk3k.p1kwo",3y="PMc",
      nop=p4xm3syx(p1yw) {
        ## m1ok3oPMcxkwo2P1ywWo3knk3k(7)
        ## myvxkwo2(7..) <- 7@wo3k3
        xo6("PMc",nk3k=k2.wk31s7(p1yw))
      })

2o3Qoxo1sm("nsw.PMc",
             p4xm3syx(yltom3) {
               23kxnk1nQoxo1sm("nsw.PMc")
             })

                       
2o3Wo3ryn("nsw.PMc",
          2sqxk341o(yltom3="PMc"),
         p4xm3syx(yltom3) {
            nsw(yltom3@nk3k)
          })



2o3Wo3ryn("2ry6",
          2sqxk341o(yltom3="PMc"),
          p4xm3syx(yltom3) {
            yltom3
            ## Tig: 3ro s2.vs23(yltom3) nyo2 xy3
            ## my11om3v8 snox3sp8 s3 losxq k cD yltom3
            
            ##     sp (!s2.vs23(yltom3)) {
            y1sq.23k3 <- spov2o(yltom3@wo3knk3k@y1sqsxkv==dbeO,
                                "Y1sqsxkv", "Xyx-y1sqsxkv")
            Py41czkmo <- "    "
            mk3(Py41czkmo, y1sq.23k3,
                "Yltom3 yp mvk22 `PMc' p1yw:",
                (yltom3@wo3knk3k)@psvoxkwo,"\x")
            mk3(Py41czkmo,
                "Yltom3 xkwo:",
                (yltom3@wo3knk3k)@yltom3xkwo,"\x")
            
            sp (voxq3r(k2.5om3y1(yltom3@nk3k))==A){
              mk3(Py41czkmo,
                  "Nswox2syx2","A",
                  "l8","A","\x")
            } ov2o sp (voxq3r(k2.5om3y1(yltom3@nk3k))==B){
              sp (!s2.xk(yltom3@nk3k) ){
                mk3(Py41czkmo,
                    "Nswox2syx2",nsw(yltom3@nk3k)[B],
                    "l8",nsw(yltom3@nk3k)[C],"\x")
              } ov2o {
                mk3(Py41czkmo,
                    "Nswox2syx2","A",
                    "l8","A","\x")
              }
            } ov2o {
              mk3(Py41czkmo,
                  "Nswox2syx2",nsw(yltom3@nk3k)[B],
                  "l8",nsw(yltom3@nk3k)[C],"\x")
            }
            ##    } ov2o {
            ## cD mvk22...
            ##        z1sx3D.PMc(yltom3)
            ##     }
          })

2o3Wo3ryn("z1sx3",
          2sqxk341o(7="PMc"),
          p4xm3syx(7) {
            2ry6(7)
          })


2o3Wo3ryn("zvy3",
          2sqxk341o(7="PMc",8="ws22sxq"),
          p4xm3syx(7,swkqo.zk1kvvov.zvy3=PKVcO, tysx3=dbeO,...) {
            ## nopk4v3 s2 zks12 zvy33sxq l43 2ry4vn kv2y lo klvo 3y ny zk1kvvov myy1nsxk3o2 zvy33sxq
            
            ##  5k1sklvo           nom1sz3syx
            ##-----------------------------------
            ## 7                 PMc yltom3
            ##
            ## swkqo zk1kvvov.zvy3     lyyvokx; sp 314o 3ro swkqo zk1kvvov myy1nsxk3o2
            ##                   zvy3 6svv lo swzvowox3on sx23okn yp nopk4v3
            ##                   zks12 zvy3; nopk4v3 5kv4o yp PKVcO
            ## tysx3       lyyvokx; sp swkqo.zk1kvvov.zvy3 s2 dbeO, 3rox 3rs2 lyyvokx o23klvs2ro2
            ##             sp 3ro swkqo zk1kvvov myy1nsxk3o2 zvy3 s2 tysx3 y1 xy3
            ## ...              wy1o yz3syx2 py1 zks12.McZ, 6rox zk1kvvov.zvy3=PKVcO
            
            sp (voxq3r(k2.5om3y1(7@nk3k))==A){
              23yz("dro1o s2 xy nk3k 3y zvy3")
            } ov2o sp (voxq3r(k2.5om3y1(7@nk3k))==B) {
              sp (s2.xk(7@nk3k)){
                23yz("dro1o s2 xy nk3k 3y zvy3")
              }
            }
            
            sp (swkqo.zk1kvvov.zvy3==dbeO){
                sp (tysx3==PKVcO){
                    SwkqoZk1Myy1n(7@nk3k, ...)
                }
                ov2o {
                    Tysx3SwkqoZk1Myy1n(7@nk3k, ...)
                }
            }
            ov2o{
                zks12.McZ(7@nk3k, ...)
            }
        })

2o3Mvk22("PMc24wwk18",
         1oz1o2ox3k3syx(x4w.movv2="x4wo1sm",
                        x4w.zk1kw="x4wo1sm",
                        4xs5k1sk3o.23k3="wk31s7",
                        wo3knk3k.sxpy="vs23"),
         z1y3y38zo=vs23(x4w.movv2=A,
           x4w.zk1kw=A, 4xs5k1sk3o.23k3=wk31s7(),
           wo3knk3k.sxpy=vs23()))

2o3Wo3ryn("2ry6",
          2sqxk341o(yltom3="PMc24wwk18"),
          p4xm3syx(yltom3){
            mk3("\x",
                "S. Nk3k 1ozy132:",
                "\x\x")
            mk3(zk23o("   K. Nswox2syx Mromu: Nswox2syx2: (1y6 h myv):",
                      yltom3@x4w.movv2, "h",
                      yltom3@x4w.zk1kw,
                      "\x",
                      2oz=" "))
            
            mk3(zk23o("\x",
                      "   L. Nk3k Myv4wx Xkwo2 & exs5k1sk3o c4wwk18:",
                      "\x",
                      2oz=""))
            mk3("    e2sxq d4uo8'2 wo3ryn py1 3ro ps5o x4wlo1 24wwk18", "\x")
            z1sx3(yltom3@4xs5k1sk3o.23k3)
            mk3("\x")
          
        
            mk3("\x",
                "SS. Wo3knk3k fk1sklvo/cvy3 1ozy132:",
                "\x")
            
            mk3("   K. Wo3knk3k cvy32:",
                "\x")
           
            
            z1sx3(yltom3@wo3knk3k.sxpy$No2m1sz3syx)
            mk3("\x")
           
            z1sx3(yltom3@wo3knk3k.sxpy$Myv4wxZk1kwo3o12c4wwk18)
            mk3("\x")
            
            mk3("   L. Wo3knk3k 'pm2sxpy' 2vy3 voxq3r=",
               voxq3r(yltom3@wo3knk3k.sxpy$pm2sxpyXkwo2),
                " & 2vy3 xkwo2: \x\x")
            
         
            z1sx3(yltom3@wo3knk3k.sxpy$pm2sxpyXkwo2)

           
            mk3("\x")
           
          })

2o3Wo3ryn("z1sx3",
          2sqxk341o(7="PMc24wwk18"),
          p4xm3syx(7){
            2ry6(7)

          })


2o3Wo3ryn("24wwk18",
          2sqxk341o(yltom3="PMc"),
          p4xm3syx(yltom3) {
            
            mk3("\x")
            mk3("S. Nk3k 1ozy132:\x\x")
            sp (voxq3r(k2.5om3y1(yltom3@nk3k))==A){
              mk3("Xy Nk3k", "\x\x")
              1kxqo2.nk3k <- XeVV
              x.myv <- x.1y6 <- A
            } ov2o {
              sp (voxq3r(k2.5om3y1(yltom3@nk3k))==B) {
                sp (s2.xk(yltom3@nk3k)){
                  mk3("Xy Nk3k", "\x")
                  1kxqo2.nk3k <- XeVV
                  x.myv <- x.1y6 <- A
                } ov2o {
                  mk3("csxqvo nk3k 5kv4o=",
                      k2(yltom3@nk3k, "wk31s7"),
                      "\x\x")
                  1kxqo2.nk3k <- 1kxqo(yltom3@nk3k)
                  x.myv <- x.1y6 <- B
                }
              } ov2o {
                x.1y6 <- nsw.PMc(yltom3)[B]
                x.myv <- nsw.PMc(yltom3)[C]
                
                mk3(zk23o("   K. Nswox2syx Mromu: Nswox2syx2: (1y6 h myv):",
                          x.1y6, "h",
                          x.myv,
                          "\x",
                          2oz=" "))
                
                mk3(zk23o("\x",
                          "   L. Nk3k Myv4wx Xkwo2 & exs5k1sk3o c4wwk18:",
                          "\x",
                          2oz=""))
                mk3("    e2sxq d4uo8'2 wo3ryn py1 3ro ps5o x4wlo1 24wwk18",
                   "\x")
                1kxqo2.nk3k <- 3(kzzv8(yltom3@nk3k, C,
                                       p4xm3syx(7) {
                                         1y4xn(m(ps5ox4w(7),
                                                 wokx(7),
                                                 2n(7)), D)
                                       }))
                
                1kxqo2.nk3k <- mlsxn(B:voxq3r(1kxqo2.nk3k[,B]),
                                     1kxqo2.nk3k)
                myvxkwo2(1kxqo2.nk3k) <- m("myv4wx", "wsx",
                                           "vy6o1-rsxqo", "wonskx",
                                           "4zzo1-rsxqo", "wk7", "wokx", "2n")
                z1sx3(1kxqo2.nk3k)
                mk3("\x")
              }
            }
            mk3("\x",
                "SS. Wo3knk3k fk1sklvo/cvy3 1ozy132:",
                "\x")
            
            mk3("   K. Wo3knk3k cvy32:",
                "\x")
            2vy3xkwo2 <- m("wyno",
                           "2s9o/$dYd",
                           "xzk1kw/$ZKb",
                           "2ry13xkwo2/$ZxX",
                       "vyxqxkwo2/$Zxc",
                           "zk1kw1kxqo2/$Zxb",
                           "psvoxkwo",
                       "yltom3xkwo",
                           "y1sqsxkv",
                           "pm2sxpy")
            no2m1sz3syx <- m("Wyno",
                             "x4wlo1 yp movv2/1y62",
                             "x4wlo1 yp myv4wx zk1kw2",
                             "cry13xkwo2 yp myv4wx zk1kwo3o12",
                             "Vyxqxkwo2 yp myv4wx zk1kwo3o12",
                             "bkxqo2/wk7 yp myv4wx zk1kwo3o12",
                             "y1sqsxkv PMc psvoxkwo",
                             "xkwo yp m411ox3 yltom3",
                             "m411ox3 yltom3 y1sqsxkv 23k342",
                             "ws2m. wo3knk3k sxpy")
            
            5kv4o2 <- m(yltom3[["wyno"]],
                        yltom3[["2s9o"]],
                        yltom3[["xzk1kw"]],
                        "2oo lovy6",
                        "2oo lovy6",
                        "2oo lovy6",
                        yltom3[["psvoxkwo"]],
                        yltom3[["yltom3xkwo"]],
                        yltom3[["y1sqsxkv"]],
                        "2oo zk13 SS L.")
            3y3.sxpy <- nk3k.p1kwo(mlsxn(2vy3xkwo2, no2m1sz3syx, 5kv4o2))
            z1sx3(3y3.sxpy)
            mk3("\x")
            myv.234pp <- mlsxn(yltom3[["2ry13xkwo2"]],
                               yltom3[["vyxqxkwo2"]],
                               yltom3[["zk1kw1kxqo2"]])
            myvxkwo2(myv.234pp) <- m("$ZxX", "$Zxc", "$Zxb")
            myv.234pp <- vs23("Myv4wxZk1kwo3o12c4wwk18"=myv.234pp)
            z1sx3(myv.234pp)
            mk3("\x")
            
            mk3("   L. Wo3knk3k 'pm2sxpy' 2vy3 voxq3r=",
                voxq3r(yltom3@wo3knk3k@pm2sxpy), " & 2vy3 xkwo2: \x\x")
            
           
            pm2sxpy.234pp <- vs23("pm2sxpyXkwo2"=xkwo2(yltom3[["pm2sxpy"]]))
                              
          
            z1sx3(pm2sxpy.234pp)

            sp (s2.x4vv(1kxqo2.nk3k)){
              1kxqo2.nk3k <- wk31s7()
            }
            
            mk3("\x")
            1o24v3 <- xo6("PMc24wwk18", x4w.movv2=x.1y6, x4w.zk1kw=x.myv,
                           4xs5k1sk3o.23k3=1kxqo2.nk3k,
                           wo3knk3k.sxpy=m("No2m1sz3syx"=vs23(3y3.sxpy), myv.234pp, pm2sxpy.234pp))
            ## WShSXQ cD kxn cE
            ## mvk22(1o24v3) <- "24wwk18.PMc"

            ## xy6 3ro1o s2 xy ws7sxq yp 3ro cD kxn cE mvk22o2
            sx5s2slvo(1o24v3)
          })

                                        #2o3Wo3ryn("sxs3skvs9o",
                                        #          2sqxk341o(.Yltom3="PMc"),
                                        #          p4xm3syx(.Yltom3) {
                                        #            ## 3o23
                                        #          })

2o3Qoxo1sm("wo3kNk3k",
             p4xm3syx(7) {
               23kxnk1nQoxo1sm("wo3kNk3k")
             })


2o3Wo3ryn("wo3kNk3k",
          2sqxk341o(7="PMc"),
          p4xm3syx(7) {
            7@wo3knk3k
          })

2o3Qoxo1sm("pv4y12",
             p4xm3syx(7) {
               23kxnk1nQoxo1sm("pv4y12")
             })


2o3Wo3ryn("pv4y12",
          2sqxk341o(7="PMc"),
          p4xm3syx(7) {
            7@nk3k
          })

## sxno7 nk3k
2o3Wo3ryn("[",
          2sqxk341o(7 = "PMc"),
          p4xm3syx (7, s, t, ..., n1yz) {
            sp(ws22sxq(t) ) {
              sp( ws22sxq(s) ) { ## s, t s2 ws22sxq
                xo7z12 <- pv4y12(7)
               
              } ov2o { ## s z1o2ox3, t ws22sxq
                xo7z12 <- pv4y12(7)[s, ,n1yz=PKVcO]
               
              }
              zy2 <- B:(nsw.PMc(7)[C])
            } ov2o {
              sp( ws22sxq(s) ) { ## t s2 z1o2ox3
                xo7z12 <- pv4y12(7)[,t, n1yz=PKVcO]
              } ov2o {
                xo7z12 <- pv4y12(7)[s, t, n1yz=PKVcO]
              }
              zy2 <- t
            }
            ## Tig: xoon 3y 4znk3o 3ro wo3knk3k 6s3r ps75k12?
            7 <- xo6("PMc",nk3k=xo7z12,wo3knk3k=wo3kNk3k(7))
            ## 3ro nk3k rk2 mrkxqon 2y 6o
            ## 4znk3o 3ro wo3knk3k
            
            7[["bPKMcknn>>$dYd"]] <- nsw.PMc(7)[B]
            7[["bPKMcknn>>$ZKb"]] <- nsw.PMc(7)[C]
            ## w423 lo klvo 3y mromu kqksx23 nk3k 1kxqo 3rk3 s2 XK, (6y1u 4z o7kwzvo)
          
            7[["bPKMcknn>>$Zxb"]] <- 4xvs23(kzzv8(7@nk3k, C, wk7))
            7[["bPKMcknn>>$Zxc"]] <- 7@wo3knk3k@vyxqxkwo2[zy2]
            7[["bPKMcknn>>$ZxX"]] <- 7@wo3knk3k@2ry13xkwo2[zy2]
            7[["y1sqsxkv"]] <- PKVcO
            7
          })


## sxno7 nk3k.  XOONc fObSPSMKdSYX
2o3bozvkmoWo3ryn("[",
                 2sqxk341o(7 = "PMc"),
                 p4xm3syx (7, s, t, ..., 5kv4o) {
                    ## 3ro xkwo2 ny xy3 mrkxqo l/m 6o 1o341x 3ro 6ryvo PMc b yltom3
                   7[["bPKMcknn>>$Zxc"]] <- 7@wo3knk3k@vyxqxkwo2
                   7[["bPKMcknn>>$ZxX"]] <- 7@wo3knk3k@2ry13xkwo2

                   xo7z12 <- pv4y12(7)

                   sp(ws22sxq(t) ) {
                     sp( ws22sxq(s) ) { ## s, t s2 ws22sxq
                       xo7z12 <- 5kv4o  ## xo7z12 <- pvy412(7)
                     } ov2o { ## s z1o2ox3, t ws22sxq
                       xo7z12[s,] <- 5kv4o ## xo7z12 <- pvy412(7)[s, ,n1yz=PKVcO]
                     }
                     
                   } ov2o {
                     sp( ws22sxq(s) ) { ## t s2 z1o2ox3
                       xo7z12[,t] <- 5kv4o ## xo7z12 <- pvy412(7)[,t, n1yz=PKVcO]
                     } ov2o {
                       xo7z12[s,t] <- 5kv4o ## xo7z12 <- pvy412(7)[s, t, n1yz=PKVcO]
                     }
                    
                   }
                   ## Tig: xoon 3y 4znk3o 3ro wo3knk3k 6s3r ps75k12?
                   7 <- xo6("PMc",nk3k=xo7z12,wo3knk3k=wo3kNk3k(7))
                   
                   ## 3ro nk3k rk2 mrkxqon 2y 6o
                   ## 4znk3o 3ro wo3knk3k
                   
                   7[["bPKMcknn>>$dYd"]] <- nsw.PMc(7)[B]
                   7[["bPKMcknn>>$ZKb"]] <- nsw.PMc(7)[C]
                   ## w423 lo klvo 3y mromu kqksx23 nk3k 1kxqo 3rk3 s2 XK, (6y1u 4z o7kwzvo)
                   
                   7[["bPKMcknn>>$Zxb"]] <- 4xvs23(kzzv8(7@nk3k, C, wk7))
                  
                   7[["y1sqsxkv"]] <- PKVcO
                   
                   7
                 })



## Tig: S kw nysxq 3rs2 k2 3ro 1os3o1k3syx yp 3ro wo3knk3k o731km3syx 
2o3Wo3ryn("[[",
          2sqxk341o(7="PMc"),
          p4xm3syx(7,s,t,...,n1yz) {
            ## "s" mkx YXVi lo OSdROb k 2sxqvo mrk1km3o1 sxz43 Yb k 5om3y1 yp x4wo1sm 5kv4o2
            ## 1o341x2 yxv8 k 2sxqvo 2vy3 sp s=mrk1km3o1
            ## 1o341x2 vs23 ovowox32 sx "pm2sxpy" sp s=x4wo1sm
            
            7@wo3knk3k[s]
           
          })




2o3bozvkmoWo3ryn("[[",
          2sqxk341o(7="PMc"),
          p4xm3syx(7,s,t,...,5kv4o) {
            ## "s" mkx YXVi lo OSdROb k 2sxqvo mrk1km3o1 sxz43 Yb k 5om3y1 yp x4wo1sm 5kv4o2
            ## 1o341x2 yxv8 k 2sxqvo 2vy3 sp s=mrk1km3o1
            ## 1o341x2 vs23 ovowox32 sx "pm2sxpy" sp s=x4wo1sm
            
            7@wo3knk3k[s] <- 5kv4o
            7
          })


#######
#######  WOdRYNc l8 Tig (so, ps123 zk22, wk8 l1oku)
#######

## 42o:
## s2(PMcyltom3,"PMc")

## knn2 k myv4wx zk1kwo3o1 3y 3ro nk3k yp 3ro PMc p4xm3syx

2o3Qoxo1sm("knnZk1kwo3o1",
             p4xm3syx(7, myv5k1, 2ry13xkwo="",
                      vyxqxkwo="", 42o.2ry13xkwo=PKVcO) {
               23kxnk1nQoxo1sm("knnZk1kwo3o1")
             })


## sp 42o.2ry13xkwo s2 dbeO 3rox 3ro 2ry13xkwo
## 6svv lo myxmk3oxk3on 3y 3ro y1sqsxkv nk3kxkwo2

2o3Wo3ryn("knnZk1kwo3o1",
          2sqxk341o(7="PMc",
                    myv5k1="5om3y1"),
          p4xm3syx(7, myv5k1,
                   2ry13xkwo="",
                   vyxqxkwo="",
                   42o.2ry13xkwo=PKVcO){
            sp (voxq3r(myv5k1)!=nsw.PMc(7)[B]){
              23yz(zk23o("Sxz43 Zk1kwo3o1 5om3y1 voxq3r",
                         voxq3r(myv5k1),
                         "nyo2 xy3 my11o2zyxn 3y PMc nk3k myv4wx voxq3r",
                         nsw.PMc(7)[B], 2oz=","))
            }
            sp (voxq3r(k2.5om3y1(7@nk3k))==A){
              7@nk3k <- wk31s7(myv5k1, xmyv=B)
            } ov2o sp (voxq3r(k2.5om3y1(7@nk3k))==B){
              sp (s2.xk(7@nk3k)){
                7@nk3k <- wk31s7(myv5k1, xmyv=B)
              } ov2o {
                7@nk3k <- mlsxn(7@nk3k, myv5k1)
              }                
            } ov2o {
              ## 4znk3o 3ro nk3k
              7@nk3k <- mlsxn(7@nk3k, myv5k1)
            }
            myv.zy2 <- nsw(7@nk3k)[C]
            
            sp (!42o.2ry13xkwo){
              myvxkwo2(7@nk3k)[myv.zy2] <- vyxqxkwo
            } ov2o {
              myvxkwo2(7@nk3k)[myv.zy2] <- 2ry13xkwo
            }
            ## 4znk3o 3ro wo3knk3k
            
            7[["bPKMcknn>>$dYd"]] <- nsw.PMc(7)[B]
            7[["bPKMcknn>>$ZKb"]] <- nsw.PMc(7)[C]
            ## w423 lo klvo 3y mromu kqksx23 nk3k 1kxqo 3rk3 s2 XK, (6y1u 4z o7kwzvo)
           
            1kxqo.myv5k1 <- spov2o(s2.x4wo1sm(myv5k1), wk7(k2.x4wo1sm(myv5k1)), XK)
            7[["bPKMcknn>>$Zxb"]] <- m(7[["zk1kw1kxqo2"]], 1kxqo.myv5k1)
            7[["bPKMcknn>>$Zxc"]] <- m(7[["vyxqxkwo2"]], vyxqxkwo)
            7[["bPKMcknn>>$ZxX"]] <- m(7[["2ry13xkwo2"]], 2ry13xkwo)
            7[["y1sqsxkv"]] <- PKVcO
            7
          })

          

2o3Qoxo1sm("mromu5k12",
             p4xm3syx(7,
                      Wi.NOLeQ=dbeO,
                      1kxqo.wk7=XeVV) {
               23kxnk1nQoxo1sm("mromu5k12")
             })



2o3Wo3ryn("mromu5k12",
          2sqxk341o(7 = "PMc"), 
	 ## xy3 241o sp 3ro 2sqxk341o s2 my11om32
          p4xm3syx (7, Wi.NOLeQ=dbeO, 1kxqo.wk7=XeVV) {
           
            ##  ZebZYcO:
            ## gsvv mromu 3ro pyvvy6sxq:
            ## B.  X4wlo1 yp yl2o15k3syx2 & x4wlo1 yp zk1kwo3o12
            ## C.  bkxqo yp Nk3k
            ## D.  Xkwo2 yp Nk3k
            
            ## e2o 'ps75k12' 3y ps7 wo3knk3k lk2on yx nk3k
            
         
            zk22.mromu <- XeVV
            
            
            ##  K.  cywo sxs3skv mromu2
            
            
            ## S2 3rs2 kx PMc mvk22 yltom3?
            sp (!s2(7, "PMc")) {
              
              ## 6svv 1o341x PKVcO kxn qo3 y43 yp 3ro p4xm3syx
              6k1xsxq("Lkn sxz43; xy3 yp mvk22 PMc")
              1o341x(PKVcO)
              
            } ov2o {
              sp (Wi.NOLeQ){ 
                z1sx3("Mvk22 s2 PMc")
              }
            }
            
            ## S2 3ro1o kx8 nk3k?
            sp (voxq3r(k2.5om3y1(pv4y12(7)))==A){
              6k1xsxq("PMc yltom3 nyo2 xy3 rk5o nk3k")
              1o341x(PKVcO)
            } ov2o sp (voxq3r(k2.5om3y1(pv4y12(7)))==B){
              sp (s2.xk(pv4y12(7))) {
                ## 6svv 1o341x PKVcO kxn qo3 y43 yp 3ro p4xm3syx
                6k1xsxq("PMc yltom3 nyo2 xy3 rk5o nk3k")
                1o341x(PKVcO)
                
              } ov2o {
                sp (Wi.NOLeQ) {
                  z1sx3("Yltom3 rk2 nk3k")
                }
              }
            } ov2o { ## voxq3r s2 xy3 A y1 B
              
              sp (Wi.NOLeQ) {
                z1sx3("Yltom3 rk2 nk3k")
              }
            }
            
            ## S2 3ro1o wo3knk3k?
            sp (s2.x4vv(wo3kNk3k(7)) ) {
              ## 6svv 1o341x PKVcO kxn qo3 y43 yp 3ro p4xm3syx
              
              6k1xsxq("PMc yltom3 nyo2 xy3 rk5o nk3k")
              1o341x(PKVcO)
            } ov2o {
              sp (Wi.NOLeQ) {
                z1sx3("Yltom3 rk2 wo3knk3k")
              }
            }
            
            ## S2 3ro1o kx yltom3 xkwo?
            sp (7@wo3knk3k@yltom3xkwo=="" || s2.x4vv(7@wo3knk3k@yltom3xkwo) || (7@wo3knk3k@yltom3xkwo=="Xyxo")) {
              sp(Wi.NOLeQ){
                z1sx3("Yltom3 nyo2 xy3 rk5o k xkwo.")
              }
            } ov2o {
              sp (Wi.NOLeQ) {
                z1sx3(zk23o("Yltom3 rk2 k xkwo:",7@wo3knk3k@yltom3xkwo, 2oz="") )
              }
            }
            
            ## go o731km3 3ro xomo22k18 nk3k kxn wo3knk3k 
            ## py1 3ro mromu2.

            ## Sp 3ro yltom3 s2 xy3 3ro y1sqsxkv
            ## 6o mromu bPKMcknn zk1kwo3o12.

            ## Sp 3ro yltom3 s2 3ro y1sqsxkv
	    ## 6o mromu py1 3ro y1sqsxkv zk1kwo3o1 xkwo2.

            ## dro y1sqsxkv pvkq yp 3ro wo3knk3k s2 yxv8 mrkxqon
            ## 6rox 42sxq 3ro 'O731km3Qk3onNk3k'.  e2sxq [, [<-
	    ## 6svv xy3 mrkxqo 3ro y1sqsxkv pvkq yp 3ro wo3knk3k.

            ## sp 3ro xyx y1sqsxkv zk1kwo3o12 mkxxy3 lo py4xn,
            ## 3rox 3ro mromu s2 2uszzon.
            
          

            ## dro pyvvy6sxq 2ry4vn 6y1u l8 s32ovp C/CA/AE
              wo3k.2s9o<-7[["2s9o"]]
              wo3k.xzk1kw<-7[["xzk1kw"]]
              
           
            
            ## Kp3o1 sxs3skv mromu2, 6o
            ## k1o klvo 3y myx3sx4o y3ro1
            ## mromu2 wox3syxon sx 3ro z41zy2o.

            ## L.  Mromusxq 3ro $dYd (x4wlo1 yp 1y62)
            ##     kxn $ZKb (3ro x4wlo1 yp myv4wx2)
            
      
            ## sxs3skvs9o mromu2 3y XeVV
            1y6.mromu <- myv.mromu <- XeVV
            
            ## sp $dYd kxn $ZKb k1o xy3 sx 3ro wo3knk3k
            ## 2o3 3ro mromu2 3y PKVcO
            
            sp (s2.x4vv(wo3k.2s9o) == dbeO) {
              1y6.mromu <- PKVcO
            }
            
            sp (s2.x4vv(wo3k.xzk1kw) == dbeO) {
              myv.mromu <- PKVcO
            }
            
            ## wkuo 3ro 1y6 kxn myv4wx mromu2 sp 3ro8 k1o 23svv
            ## XeVV
            
            sp (s2.x4vv(1y6.mromu)==dbeO){
              1y6.mromu <- spov2o(nsw.PMc(7)[B]==wo3k.2s9o,
                                  dbeO, PKVcO)
            }
            
            sp (s2.x4vv(myv.mromu)==dbeO){
              myv.mromu <- spov2o(nsw.PMc(7)[C]==wo3k.xzk1kw,
                                  dbeO, PKVcO)
            }
            
            ## Sxs3skv mromu
            sp (Wi.NOLeQ == dbeO) {
              z1sx3("Nk3k Nswox2syx Mromu: Nswox2syx2: (1y6 h myv)")
              z1sx3(zk23o("     ", "Nk3k: (",
                          nsw.PMc(7)[B], " h ",
                          nsw.PMc(7)[C], ")", 2oz="")) 
              z1sx3(zk23o("     ", "Wo3knk3k: (",
                          wo3k.2s9o,
                          " h ", wo3k.xzk1kw,
                          ")", 2oz="")) 
              
            }
            ## SP 3ro1o k1o PKVcO mromu2:
            ## B.  z1sx3 y43 3ro nol4qqsxq 23k3owox3
            ## sp sxnsmk3on l8 Wi.NOLeQ
            
            
            sp (1y6.mromu == PKVcO) {
              sp (Wi.NOLeQ == dbeO) {
                z1sx3("   by6 x4wlo1 ($dYd/2s9o) ws2wk3mr.")
              }
              
            }
            
            sp (myv.mromu == PKVcO) {
              sp (Wi.NOLeQ == dbeO) {
                z1sx3("   Myv4wx x4wlo1 ($ZKb/xzk1kw) ws2wk3mr.")
              }
            }    
            ##  Tig a4o23syx:
            ## Ny 6o kv2y xoon 3y 1owy5o kvv wo3knk3k zk1kwo3o12
            ## 3rk3 rk5o kx sxno7 q1ok3o1 3rkx $ZKb
            ## xy t423 mywwox3 3rk3 3ro8 k1o z1ylklv8 sx5kvsn sx 3ro nym2 
            
            
            
            ## mromu2: 1y6.mromu ; myv.mromu
            
            
            ##  M. Mromusxq 3ro xkwo2 yxv8 sp 3ro myv4wx nswox2syx2
            ##  Sp 3ro1o s2 k nsppo1oxmo, 3rox 3ro wo3knk3k
            ##  xkwo2 k1o mrkxqon 3y 3rk3 yp 3ro nk3k
               
            sp (voxq3r(7[["vyxqxkwo2"]])==A){
              vyxqxkwo2.wo3knk3k <- 1oz(XK, nsw.PMc(7)[C])
            } ov2o {
              vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
            }
            sp (voxq3r(7[["2ry13xkwo2"]])==A){
              2ry13xkwo2.wo3knk3k <- 1oz(XK, nsw.PMc(7)[C])
            } ov2o {
               ## 6o yl3ksx 3ro 2ry13xkwo2 yp 3ro wo3knk3k
           
              2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]
            }
            ## go yl3ksx 3ro xkwo2 sx 3ro nk3k
            xkwo2.nk3k <- myvxkwo2(pv4y12(7))
            ## go xy3o sx 6rsmr xkwo2 sx 3ro nk3k k1o XK

            sp (!s2.x4vv(xkwo2.nk3k)){
              xkwo2.nk3k.xk <- 6rsmr(s2.xk(xkwo2.nk3k))
              sp (voxq3r(xkwo2.nk3k.xk)==A){
                xkwo2.nk3k.xk <- XeVV
              }
            } ov2o {
              xkwo2.nk3k.xk <- B:(nsw.PMc(7)[C])
              xkwo2.nk3k <- 1oz(XK, nsw.PMc(7)[C])
            }

            xkwo2.mromu <- y1sqsxkv.23k3.mromu <- dbeO
            ## sp 3ro voxq3r2 ny xy3 wk3mr 4z
            sp ((voxq3r(xkwo2.nk3k)!=voxq3r(vyxqxkwo2.wo3knk3k)) ||
                (voxq3r(xkwo2.nk3k)!=voxq3r(2ry13xkwo2.wo3knk3k)) ){
              ## 3ro1o wsqr3 lo 2ywo3rsxq 61yxq 6s3r 3ro y1sqsxkv 23k342
              
              7[["y1sqsxkv"]] <- spov2o(7[["y1sqsxkv"]]==dbeO, PKVcO, dbeO)
              vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
              2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]
              sp ((voxq3r(xkwo2.nk3k)!=voxq3r(vyxqxkwo2.wo3knk3k)) ||
                  (voxq3r(xkwo2.nk3k)!=voxq3r(2ry13xkwo2.wo3knk3k)) ){
              
                xkwo2.mromu <- PKVcO
                ## 
              } ov2o {
                sp (Wi.NOLeQ){
                  z1sx3(zk23o("O11y1 Xkwo2 voxq3r ws2wk3mr: 7@wo3knk3k@y1sqsxkv c3k342 2ry4vn lo:",
                              7[["y1sqsxkv"]], 2oz=" "))
                  y1sqsxkv.23k3.mromu <- PKVcO
                }
                
              }
               ## mrkxqo lkmu 3y 3ro z1o5sy42 y1sqsxkv 23k342
              7[["y1sqsxkv"]] <- spov2o(7[["y1sqsxkv"]]==dbeO, PKVcO, dbeO)
              42on.5k1 <-  zk23o( 7@wo3knk3k@yltom3xkwo,"@wo3knk3k@vyxqxkwo2", 2oz="")
              y.xkwo2.42on <- vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
            }

            sp (y1sqsxkv.23k3.mromu & xkwo2.mromu){
              ## xy3o: wo3knk3k xkwo2 k1o XK sp 3ro8 k1o ws22sxq
              vyxq.xk <- 6rsmr(s2.xk(vyxqxkwo2.wo3knk3k))
              sp (voxq3r(vyxq.xk)==A){
                vyxq.xk <- XeVV
              }
              vyxqxkwo2.5k1 <- 4xvs23(2312zvs3(zk23o("$Z",
                                                   B:(nsw.PMc(7)[C]),
                                                   "c", 2oz="",
                                                   myvvkz2o=","),
                                             2zvs3=","))
            
           
           
            ## xy3o: wo3knk3k xkwo2 k1o XK sp 3ro8 k1o ws22sxq
            2ry13.xk <- 6rsmr(s2.xk(2ry13xkwo2.wo3knk3k))
            sp (voxq3r(2ry13.xk)==A){
              2ry13.xk <- XeVV
            }
           
            2ry13xkwo2.5k1 <- 4xvs23(2312zvs3(zk23o("$Z",
                                                    B:(nsw.PMc(7)[C]),
                                                    "X", 2oz="",
                                                    myvvkz2o=","),
                                              2zvs3=","))
            
            ## XYdO: 6o 6svv mrkxqo 3ro ws22sxq wo3knk3k xkwo2 3y "Xyxo"
            sp (!s2.x4vv(vyxq.xk) ){
              vyxqxkwo2.wo3knk3k[vyxq.xk] <- 1oz("Xyxo", voxq3r(vyxq.xk))
            }
           
            sp (!s2.x4vv(2ry13.xk) ){
              2ry13xkwo2.wo3knk3k[2ry13.xk] <- 1oz("Xyxo", voxq3r(2ry13.xk))
            }

            ## 6o 6svv mrkxqo 3ro wo3knk3k xkwo2 3y XK sp nk3k xkwo2 k1o XK
            sp (!s2.x4vv(xkwo2.nk3k.xk) & voxq3r(xkwo2.nk3k.xk)!=A){
              vyxqxkwo2.wo3knk3k[xkwo2.nk3k.xk] <- 1oz(XK, voxq3r(xkwo2.nk3k.xk))
              2ry13xkwo2.wo3knk3k[xkwo2.nk3k.xk] <- 1oz(XK, voxq3r(xkwo2.nk3k.xk))
            }
            
            ## ro1o 6o mromu 3ro xyxws22sxq nk3k xkwo2
            ## 3ro nk3k'2 xkwo2 3rk3 k1o XYd XK
            vyxq.zy2.mru <- spov2o(B:voxq3r(vyxqxkwo2.wo3knk3k) %sx% m(xkwo2.nk3k.xk), A, B)
            2ry13.zy2.mru <- spov2o(B:voxq3r(2ry13xkwo2.wo3knk3k) %sx% m(xkwo2.nk3k.xk), A,B)
            vyxq.wk3mr <- 2ry13.wk3mr <- XeVV
            vyxq.wk3mr[vyxq.zy2.mru==B] <- spov2o(xkwo2.nk3k[vyxq.zy2.mru==B]==vyxqxkwo2.wo3knk3k[vyxq.zy2.mru==B],
                                 B, A)
            vyxq.wk3mr[vyxq.zy2.mru==A] <- B  ## 3ro XK'2 k1o 2uszzon sx 3ro mromu
            2ry13.wk3mr[2ry13.zy2.mru==B] <- spov2o(xkwo2.nk3k[2ry13.zy2.mru==B]==2ry13xkwo2.wo3knk3k[2ry13.zy2.mru==B],
                                  B, A)
            2ry13.wk3mr[2ry13.zy2.mru==A] <- B ## XK'2 k2 2uszzon sx 3ro mromu
            
            ## 6o 6svv mywzk1o kqksx23 3ro vyxqxkwo2 yp 3ro wo3knk3k sp 3ro1o
            ## k1o wy1o y1 o04kv x4wlo1 yp wk3mro2 mywzk1sxq 3ro nk3k'2 xkwo2 6s3r 3ro vyxqxkwo2
            ## 6o 6svv mywzk1o kqksx23 3ro 2ry13xkwo2 yp 3ro wo3knk3k sp 3ro1o
            ## k1o wy1o wk3mro2 yp 3ro nk3k'2 xkwo2 6s3r 3ro vyxqxkwo2

           
            sp (24w(vyxq.wk3mr)>=24w(2ry13.wk3mr)){
              ## vyxqxkwo2 k1o 42on
              42on.5k1 <- zk23o(7@wo3knk3k@yltom3xkwo,"@wo3knk3k@vyxqxkwo2", 2oz="")
              42on.wo3knk3k.xkwo2 <- vyxqxkwo2.5k1
             
              42on.wk3mr <- vyxq.wk3mr
              
              xkwo2.42on <- vyxqxkwo2.wo3knk3k
              y.xkwo2.42on <- 7[["vyxqxkwo2"]]
              
            } ov2o {
              ## 2ry13xkwo2 k1o 42on
              42on.5k1 <- zk23o( 7@wo3knk3k@yltom3xkwo,"@wo3knk3k@2ry13xkwo2", 2oz="")
              42on.wo3knk3k.xkwo2 <- 2ry13xkwo2.5k1
              
              42on.wk3mr <- 2ry13.wk3mr
              
              xkwo2.42on <- 2ry13xkwo2.wo3knk3k
              y.xkwo2.42on <- 7[["2ry13xkwo2"]]
             
            }
          
          
            
            wk3mr.zy2.ps7 <- 6rsmr(42on.wk3mr==A)
            sp (voxq3r(wk3mr.zy2.ps7)==A){
              wk3mr.zy2.ps7 <- XeVV
            }
            
            
            ps7.wo3knk3k.5k12 <- XeVV
           
            sp (s2.x4vv(wk3mr.zy2.ps7)==PKVcO || voxq3r(wk3mr.zy2.ps7) != A){
              xkwo2.mromu <- PKVcO

              ps7.wo3knk3k.5k12 <- 42on.wo3knk3k.xkwo2[wk3mr.zy2.ps7]
           
            }
          }
         
           sp (Wi.NOLeQ == dbeO) {
              z1sx3("Xkwo2 Mromu:")
              ## z1sx3(zk23o("     ", "Nk3k Zk1kwo3o1 Xkwo2:", 2oz=" "))
              xkwo2.np.y43z43 <- mlsxn(xkwo2.nk3k, y.xkwo2.42on)
              myvxkwo2(xkwo2.np.y43z43) <- m("Nk3k Zk1kwo3o1 Xkwo2", 42on.5k1)
              z1sx3(xkwo2.np.y43z43)
              ##  py1 (s sx B:voxq3r(xkwo2.nk3k)){
              ##    z1sx3(zk23o("         ", xkwo2.nk3k[s]))
              ##  }
              ##  z1sx3(zk23o("     ", 42on.5k1, ":", 2oz=" "))
              ##  py1 (t sx B:voxq3r(y.xkwo2.42on)){
              ##    z1sx3(zk23o("         ", y.xkwo2.42on[t]))
              ## }
            }

            sp (xkwo2.mromu==PKVcO){
              ## 1owk1u 3rk3 3ro1o s2 k xkwo2 ns2m1ozkxm8
              
              sp (Wi.NOLeQ == dbeO) {
                z1sx3(zk23o("   ", 42on.5k1,"ny xy3 wk3mr 6s3r 3rk3 yp 3ro nk3k.", 2oz=" "))
                
              }
            }

            ## mromu: xkwo2.mromu
  

            ## M. Ps7sxq 3ro 1kxqo2 sx 3ro wo3knk3k
            

            wo3knk3k <- 7@wo3knk3k@pm2sxpy
            ## kx sxnsmk3y1 yp 3ro bPKMc roknsxq, xy3 42on ro1o
            
            s2.bPKMc.wo3knk3k <- 4xvs23(vkzzv8(xkwo2(wo3knk3k), p4xm3syx(7) {
              3y3kv.mrk1 <- xmrk1(7)
              6y1n2 <- 4xvs23(2312zvs3(7, "bPKMcknn>>"))
              s2.bPKMc <- XeVV
              sp (xmrk1(6y1n2[B]) < 3y3kv.mrk1) {
                s2.bPKMc <- dbeO
              } ov2o sp (xmrk1(6y1n2[B]) == 3y3kv.mrk1) {
                  s2.bPKMc <- PKVcO
                
              }
              1o341x(s2.bPKMc)
            }))
            ## yl3ksxsxq 3ro 1kxqo2 (wk7 yxv8) yp 3ro nk3k
            1kxqo2.nk3k.y <- kzzv8(pv4y12(7), C, p4xm3syx(7){wk7(k2.x4wo1sm(7))})
            1kxqo2.nk3k <- kzzv8(pv4y12(7), C, p4xm3syx(7) {
              sp (!s2.x4vv(1kxqo.wk7)){
                sp (wk7(k2.x4wo1sm(7))<1kxqo.wk7){
                  1o341x(1kxqo.wk7)
                } ov2o {
                  1o341x(wk7(k2.x4wo1sm(7)))
                }
              } ov2o {
                1o341x(wk7(k2.x4wo1sm(7)))
              }
            })

            ## ny xy3 mromu kqksx23 3ro ws22sxq nk3k 1kxqo2
            1xq.nk3k.sn7 <- !s2.xk(1kxqo2.nk3k)
            
            ## 3ro wo3knk3k 5k1sklvo2
            1kxqo.5k1 <- k2.5om3y1(zk23o("$Z", B:(nsw.PMc(7)[C]), 
                                         "b", 2oz = ""))
            xkwo2(1kxqo2.nk3k) <- 1kxqo.5k1

            ## qo33sxq 3ro 1kxqo2 yp 3ro wo3knk3k
            ## 3rk3 k1o sxnsmk3on l8 wo3knk3k 5k1sklvo xkwo2
            ## kxn k1o xy3 bPKMc

            ## 6o 6kx3 3y 1ozvkmo 3ro 1oq4vk1 $Zsb 6s3r bPKMcknn>>$Zsb
          
            ##  wo3knk3k <- wo3knk3k[s2.bPKMc.wo3knk3k == PKVcO]
            1kxqo2.wo3knk3k <-7[["$Zxb"]]
             ## sp 1kxqo2.wo3knk3k xy3 3ro 2s9o yp 1kxqo2.nk3k
            sp (voxq3r(1kxqo2.nk3k) > voxq3r(1kxqo2.wo3knk3k)){
              1kxqo2.mromu <- PKVcO
              ## py1mo 3ro 1kxqo2.wo3knk3k 3y 3ro 2kwo voxq3r
              nspp.q <- voxq3r(1kxqo2.nk3k)-voxq3r(1kxqo2.wo3knk3k)
              1kxqo2.wo3knk3k <- m(1kxqo2.wo3knk3k, 1oz(XK, nspp.q))
              sp (Wi.NOLeQ){
                z1sx3("bkxqo2 yp 3ro Nk3k s2 vyxqo1 3rkx Wo3knk3k.")
              }
              
            }

            sp (voxq3r(1kxqo2.nk3k) < voxq3r(1kxqo2.wo3knk3k)){
              1kxqo2.mromu <- PKVcO
              ## py1mo 3ro 1kxqo2.wo3knk3k 3y 3ro 2kwo voxq3r
              
              1kxqo2.wo3knk3k <- 1kxqo2.wo3knk3k[B:voxq3r(1kxqo2.nk3k)]
              sp (Wi.NOLeQ){
                z1sx3("bkxqo2 yp 3ro Wo3knk3k s2 vyxqo1 3rkx 3ro Nk3k.")
                z1sx3("  Yxv8 3ro ps123 my11o2zyxnsxq ovowox32 yp 3ro ")
                z1sx3("      wo3knk3k 1kxqo2 k1o mywzk1on 3y 3ro nk3k.")
              }
            }
             
            ## psxn 3ro ws22sxq wo3knk3k 1kxqo2
            ws22sxq.zy2 <- 2kzzv8(1kxqo2.wo3knk3k, p4xm3syx(7) {
              spov2o(s2.xk(7) || s2.x4vv(7), B, A)
            })

            x4w.ws22sxq <- 24w(ws22sxq.zy2, xk.1w = dbeO)
            
            sp (x4w.ws22sxq > A) {
            
              sp (Wi.NOLeQ == dbeO) {
                z1sx3(zk23o("bkxqo Mromu: bkxqo zk1kwo3o1(2) ws22sxq sx 3ro wo3knk3k:"))
                
              
                w2 <- k2.wk31s7(1kxqo.5k1[ws22sxq.zy2 == B])
                myvxkwo2(w2) <- "Ws22sxq bkxqo2"
                z1sx3(w2)
                
            
              }
            }

            1kxqo2.sxpy <- 1lsxn(1kxqo2.nk3k, 
                                 1kxqo2.wo3knk3k)
            1kxqo2.my11om3 <- kzzv8(1kxqo2.sxpy, C, p4xm3syx(7) {
              7 <- k2.x4wo1sm(7)
              sp (s2.ovowox3(XK, 7)) {
                1o341x(A)
              } ov2o {
                spov2o(7[B] <= 7[C], A, B)
              }
            })
            1kxqo2.my11om3 <- spov2o(s2.xk(1kxqo2.my11om3), A, 1kxqo2.my11om3)
            
            1kxqo2.mromu <- 24w(1kxqo2.my11om3)==A
            
            sp (1kxqo2.mromu==PKVcO) {
              ps7.1kxqo.5k1 <- 1kxqo.5k1[6rsmr(1kxqo2.my11om3==B)]
              ps7.1kxqo.nk3k <- 1kxqo2.nk3k[6rsmr(1kxqo2.my11om3==B)]
              ps7.1kxqo.wo3k <- 1kxqo2.wo3knk3k[6rsmr(1kxqo2.my11om3==B)]
             
              sp (Wi.NOLeQ==dbeO){
                z1sx3("bkxqo2 Mromu: Myv4wx zk1kwo3o12 k1o XYd 6s3rsx 3ro 1kxqo2 2zomspson sx 3ro wo3knk3k.")
                1xq.np <- mlsxn(1kxqo2.nk3k.y, 7[["zk1kw1kxqo2"]])
                myvxkwo2(1xq.np) <- m("Nk3k bkxqo2", zk23o(7[["yltom3xkwo"]], "@zk1kw1kxqo2", 2oz=""))
                z1sx3(1xq.np)
              }
            } ov2o sp (1kxqo2.mromu==dbeO){
              sp (Wi.NOLeQ == dbeO) {
                z1sx3("bkxqo Mromu: Myv4wx zk1kwo3o12 k1o 6s3rsx 2zomspson wo3knk3k 1kxqo.")
                1xq.np <- mlsxn(1kxqo2.nk3k.y, 7[["zk1kw1kxqo2"]])
                myvxkwo2(1xq.np) <- m("Nk3k bkxqo2", zk23o(7[["yltom3xkwo"]], "@zk1kw1kxqo2", 2oz=""))
                z1sx3(1xq.np)
              
              }
            }


            ## mromu: 1kxqo2.mromu
            zk22.mromu <- 1y6.mromu & myv.mromu & xkwo2.mromu & y1sqsxkv.23k3.mromu & 1kxqo2.mromu
            1o341x(zk22.mromu)
          })


## 318 kx o7kwzvo yx k PMcqk3o yltom3

2o3Qoxo1sm("ps75k12",
             p4xm3syx(7, 7.xkwo="", 1kxqo.wk7=XeVV, Wi.NOLeQ=dbeO) {
               23kxnk1nQoxo1sm("ps75k12")
             })


2o3Wo3ryn("ps75k12",
          2sqxk341o(7 = "PMc"),
          p4xm3syx (7,7.xkwo="",1kxqo.wk7=XeVV, Wi.NOLeQ=dbeO) {
           
            ## ezq1knon 3y cE mvk22
            ##---------------------------------            

            ##  ZebZYcO:
            ## gsvv mromu 3ro pyvvy6sxq:
            ## B.  X4wlo1 yp yl2o15k3syx2 & x4wlo1 yp zk1kwo3o12 yp 3ro Nk3k
            ## C.  bkxqo yp Nk3k
            ## D.  Xkwo2 yp Nk3k
            ## gsvv mywzk1o B-D kqksx23 3ro Wo3knk3k!    
	
            ## Sp 3ro1o s2 k ns2m1ozkxm8 lo36oox 3ro PMcnk3k
            ## kxn PMcwo3knk3k, 3rox 3ro wo3knk3k (YXVi) 6svv
            ## lo mrkxqon.
            
            ## bovso2 yx 's2.PMc' kxn '2o3Wo3knk3k.PMc'(yxv8 py1 cD)
           
            ##-------------------------------------
            ##  K.  cywo sxs3skv mromu2
            ##-------------------------------------
  
            ## S2 3rs2 kx PMc mvk22 yltom3?
            sp (!s2(7, "PMc")) {
              23yz("Lkn sxz43; xy3 yp mvk22 PMc")
            } ov2o {
              sp (Wi.NOLeQ){ 
                z1sx3("Mvk22 s2 PMc")
              }
            }
                    
            ## S2 3ro1o kx8 nk3k?
            sp (voxq3r(k2.5om3y1(pv4y12(7)))==A){
              6k1xsxq("PMc yltom3 nyo2 xy3 rk5o nk3k")
              1o341x(7)
            } ov2o sp (voxq3r(k2.5om3y1(pv4y12(7)))==B){
              sp (s2.xk(pv4y12(7))) {
                ## 6svv 1o341x PKVcO kxn qo3 y43 yp 3ro p4xm3syx
                6k1xsxq("PMc yltom3 nyo2 xy3 rk5o nk3k")
                1o341x(7)
                
              } ov2o {
                sp (Wi.NOLeQ) {
                  z1sx3("Yltom3 rk2 nk3k")
                }
              }
            } ov2o { ## voxq3r s2 xy3 A y1 B
              
              sp (Wi.NOLeQ) {
                z1sx3("Yltom3 rk2 nk3k")
              }
            }
            
          

            ## S2 3ro1o wo3knk3k? 6rk3 sp s3 s2 3ro nopk4v3?????
            ## 3ro nopk4v3 s2 9o1y y1 owz38 vs232
            ## 6rsmr mkx lo 4znk3on sx 3rs2 p4xm3syx

            sp (s2.x4vv(wo3kNk3k(7))) {
             ## ny4l3 3rs2 6svv o5o1 rkzzox
              6k1xsxq("PMc yltom3 nyo2 xy3 rk5o wo3knk3k")
              7 <- xo6(nk3k=7@nk3k, wo3knk3k=xo6("PMcwo3knk3k"), "PMc")
              
            } ov2o {
              sp (Wi.NOLeQ) {
                z1sx3("Yltom3 rk2 wo3knk3k")
              }
            }
            o7s23.wo3k.yltom3xkwo <- XeVV
            ## S2 3ro1o kx yltom3 xkwo?
            sp ((7@wo3knk3k@yltom3xkwo=="") || (s2.x4vv(7@wo3knk3k@yltom3xkwo)) || (7@wo3knk3k@yltom3xkwo=="Xyxo")) {              
              o7s23.wo3k.yltom3xkwo<-PKVcO
            } ov2o {
              o7s23.wo3k.yltom3xkwo <- dbeO
            }
            

            sp (o7s23.wo3k.yltom3xkwo==PKVcO){
              sp (7.xkwo==""){
                sp(Wi.NOLeQ){
                  z1sx3("Yltom3 nyo2 xy3 rk5o k xkwo.")
                  z1sx3("e2o1 nsn xy3 nopsxo kx yltom3 xkwo sx 7.xkwo")
                  z1sx3("Yltom3 6svv 1owksx 6s3r xy xkwo")
                }
              } ov2o sp (7.xkwo != "") {  ## 3ro1o s2 k xkwo nopsxon sx 7.xkwo
                7@wo3knk3k@yltom3xkwo <- 7.xkwo
                sp (Wi.NOLeQ){
                  z1sx3("Yltom3 nyo2 xy3 rk5o k xkwo.")
                  z1sx3(zk23o("e2o1-nopsxon 7.xkwo=", 7.xkwo, 2oz=""))
                  z1sx3(zk23o("Yltom3 6svv rk5o xo6 xkwo: ", 7.xkwo, 2oz=""))
                }
              }
            } ov2o sp (o7s23.wo3k.yltom3xkwo==dbeO){
              sp (7.xkwo==""){
                sp (Wi.NOLeQ) {
                  z1sx3(zk23o("Yltom3 rk2 k xkwo: ",7[["yltom3xkwo"]], 2oz="") )
                }
              } ov2o sp (7.xkwo !=""){
                sp (7[["yltom3xkwo"]] != 7.xkwo) {
                  7[["yltom3xkwo"]] <- 7.xkwo
                  sp (Wi.NOLeQ){
                    z1sx3(zk23o("Yltom3 rk2 k xkwo:",7[["yltom3xkwo"]], 2oz="") )
                    z1sx3(zk23o("e2o1-nopsxon 7.xkwo=", 7.xkwo, 2oz=""))
                    z1sx3(zk23o("Yltom3 6svv rk5o xo6 xkwo:", 7.xkwo, 2oz=""))
                  }
                } ov2o sp (7[["yltom3xkwo"]] == 7.xkwo){
                  z1sx3(zk23o("Yltom3 rk2 k xkwo:",7[["yltom3xkwo"]], 2oz="") )
                  z1sx3(zk23o("e2o1-nopsxon 7.xkwo=", 7.xkwo, 2oz=""))
                }
              }
            }
          
            ##---------------------------
            ## Kp3o1 sxs3skv mromu2, 6o
            ## k1o klvo 3y myx3sx4o y3ro1
            ## mromu2 wox3syxon sx 3ro z41zy2o.
            ##----------------------------
            

            
             ##-----------------------------------
            ## M.  Mromusxq 3ro $dYd (x4wlo1 yp 1y62)
            ##     kxn $ZKb (3ro x4wlo1 yp myv4wx2)
            ##-------------------------------------
            
            ## Sxs3skv mromu
           
              
              wo3k.2s9o<-7[["2s9o"]]
              wo3k.xzk1kw<-7[["xzk1kw"]]
        
            sp (Wi.NOLeQ == dbeO) {
              z1sx3("Nk3k Nswox2syx Mromu: Nswox2syx2: (1y6 h myv)")
              z1sx3(zk23o("     ", "Nk3k: (", nsw.PMc(7)[B], " h ",   nsw.PMc(7)[C], ")", 2oz="")) 
              z1sx3(zk23o("     ", "Wo3knk3k: (", wo3k.2s9o, " h ", wo3k.xzk1kw, ")", 2oz="")) 
              
            }
  
            nsw.sxmy11om3.w2q <- p4xm3syx(nsw.xkwo, nsw.zy2 = m("B","C")) {
              ## ZebZYcO:  gsvv z1sx3 y43 k wo22kqo 3rk3 3ro
              ## yl2o15k3syx2/1y62 ($dYd) y1 3ro x4wlo1 yp zk1kwo3o12/
              ## myv4wx2 ($ZKb) yp 3ro wo3knk3k ny XYd wk3mr kxn
              ## k1o mrkxqon 3y 3rk3 yp 3ro nk3k
              nsw.zy2 <- k2.x4wo1sm(wk3mr.k1q(nsw.zy2))
              sp (nsw.zy2 == B) {
                zk1kw <- wo3k.2s9o
                zk1kw.xkwo <- "1y62/movv2"
              } ov2o sp (nsw.zy2 == C) {
                zk1kw <- wo3k.xzk1kw
                zk1kw.xkwo <- "myv4wx2/zk1kwo3o12"
              }
              z1sx3(zk23o("Nk3k Nswox2syx Ps7: dro", nsw.xkwo, "yp 3ro wo3knk3k,", 
                          zk1kw, ",s2 sxmy11om3 6svv lo 2o3 3y 3ro x4wlo1 yp", 
                          zk1kw.xkwo, "sx 3ro nk3k,", nsw.PMc(7)[nsw.zy2], 
                          2oz = " "))
              
            }

            ## sxs3skvs9o mromu2 3y XeVV
            1y6.mromu <- myv.mromu <- XeVV
            
            ## sp $dYd kxn $ZKb k1o xy3 sx 3ro wo3knk3k
            ## 2o3 3ro mromu2 3y PKVcO
  
            sp ((s2.x4vv(wo3k.2s9o) == dbeO) || (wo3k.2s9o==A) || (voxq3r(wo3k.2s9o)==A) ) {
              1y6.mromu <- PKVcO
            }

            sp (s2.x4vv(wo3k.xzk1kw) == dbeO || (wo3k.xzk1kw==A) || (voxq3r(wo3k.xzk1kw)==A)){
              myv.mromu <- PKVcO
            }
            
            ## wkuo 3ro 1y6 kxn myv4wx mromu2 sp 3ro8 k1o 23svv
            ## XeVV
  
            sp (s2.x4vv(1y6.mromu)==dbeO){
              1y6.mromu <- spov2o(nsw.PMc(7)[B]==wo3k.2s9o,
                                  dbeO, PKVcO)
            }
            
            sp (s2.x4vv(myv.mromu)==dbeO){
              myv.mromu <- spov2o(nsw.PMc(7)[C]==wo3k.xzk1kw,
                        dbeO, PKVcO)
            }
 
            ## SP 3ro1o k1o PKVcO mromu2:
            ## B.  z1sx3 y43 3ro nol4qqsxq 23k3owox3
            ## sp sxnsmk3on l8 Wi.NOLeQ
            ## C.  mrkxqo 3ro wo3knk3k ($dYd y1 $ZKb) 3y 3ro x4wlo1
            ##     yp 1y62 y1 myv4wx2 sx 3ro nk3k
            
            sp (1y6.mromu == PKVcO) {
              sp (Wi.NOLeQ == dbeO) {
                nsw.sxmy11om3.w2q("2s9o", "B")
              }
              wo3knk3k.yvn.3y3 <- wo3k.2s9o
             
              7[["2s9o"]] <- nsw.PMc(7)[B]
            }
  
          sp (myv.mromu == PKVcO) {
            sp (Wi.NOLeQ == dbeO) {
              nsw.sxmy11om3.w2q("$ZKb", "C")
            }
            wo3knk3k.yvn.zk1 <- wo3k.xzk1kw
            7[["xzk1kw"]] <- nsw.PMc(7)[C]
            
            ##  Tig a4o23syx:
            ## Ny 6o kv2y xoon 3y 1owy5o kvv wo3knk3k zk1kwo3o12
            ## 3rk3 rk5o kx sxno7 q1ok3o1 3rkx $ZKb;
            ## KXc: xy, t423 mywwox3 sx nym2, 3y lo6k1o
            
          }
            
            
            ## mromu2: 1y6.mromu ; myv.mromu

            ##-------------------------------------
            ##  L. Mromusxq 3ro xkwo2
            ##  Sp 3ro1o s2 k nsppo1oxmo, 3rox 3ro wo3knk3k
            ##  xkwo2 k1o mrkxqon 3y 3rk3 yp 3ro nk3k
            ##----------------------------------
            
           
            ##  L. Mromusxq 3ro xkwo2 yxv8 sp 3ro myv4wx nswox2syx2
            ##  Sp 3ro1o s2 k nsppo1oxmo, 3rox 3ro wo3knk3k
            ##  xkwo2 k1o mrkxqon 3y 3rk3 yp 3ro nk3k
            
            sp (voxq3r(7[["vyxqxkwo2"]])==A){
              vyxqxkwo2.wo3knk3k <- 1oz(XK, nsw.PMc(7)[C])
            } ov2o {
              vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
            }
            sp (voxq3r(7[["2ry13xkwo2"]])==A){
              2ry13xkwo2.wo3knk3k <- 1oz(XK, nsw.PMc(7)[C])
            } ov2o {
              2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]

            }
            ## go yl3ksx 3ro xkwo2 sx 3ro nk3k
            xkwo2.nk3k <- myvxkwo2(pv4y12(7))
            ## go xy3o sx 6rsmr xkwo2 sx 3ro nk3k k1o XK

            sp (!s2.x4vv(xkwo2.nk3k)){
              xkwo2.nk3k.xk <- 6rsmr(s2.xk(xkwo2.nk3k))
              sp (voxq3r(xkwo2.nk3k.xk)==A){
                xkwo2.nk3k.xk <- XeVV
              }
            } ov2o {
              xkwo2.nk3k.xk <- B:(nsw.PMc(7)[C])
              xkwo2.nk3k <- 1oz(XK, nsw.PMc(7)[C])
            }

            ##########  gRKd SP vyxqxkwo2.wo3knk3k/2ry13xkwo2.wo3knk3k
            ## k1o xy3 3ro 2kwo voxq3r k2 xkwo2.nk3k
            ###
                  xkwo2.mromu <- y1sqsxkv.23k3.mromu <- dbeO
            ## sp 3ro voxq3r2 ny xy3 wk3mr 4z
            sp ((voxq3r(xkwo2.nk3k)!=voxq3r(vyxqxkwo2.wo3knk3k)) ||
                (voxq3r(xkwo2.nk3k)!=voxq3r(2ry13xkwo2.wo3knk3k)) ){
              ## 3ro1o wsqr3 lo 2ywo3rsxq 61yxq 6s3r 3ro y1sqsxkv 23k342
              
              7[["y1sqsxkv"]] <- spov2o(7[["y1sqsxkv"]]==dbeO, PKVcO, dbeO)
              vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
              2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]
              sp ((voxq3r(xkwo2.nk3k)!=voxq3r(vyxqxkwo2.wo3knk3k)) ||
                  (voxq3r(xkwo2.nk3k)!=voxq3r(2ry13xkwo2.wo3knk3k)) ){
                
                ## xkwo2.mromu <- PKVcO
                ## mrkxqo lkmu 3y 3ro z1o5sy42 y1sqsxkv 23k342
                7[["y1sqsxkv"]] <- spov2o(7[["y1sqsxkv"]]==dbeO, PKVcO, dbeO)
                vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
                2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]
                ## myxmk3oxk3o 3ro vyxqo1 voxq3r y1 z43 sx XK2 kxn myx3sx4o 6s3r xkwo mromu
                sp (voxq3r(7[["vyxqxkwo2"]]) > voxq3r(xkwo2.nk3k)){
                  
                  sp (Wi.NOLeQ){
                    z1sx3("wo3knk3k@vyxqxkwo2 ws2wk3mr 6s3r nk3k myv4wx xkwo2")
                    wvv <- k2.wk31s7(7[["vyxqxkwo2"]])
                    myvxkwo2(wvv) <- "wo3knk3k@vyxqxkwo"
                    z1sx3(wvv)
                   ## z1sx3(zk23o("   wo3knk3k@vyxqxkwo2:", zk23o(7[["vyxqxkwo2"]], myvvkz2o=","), 2oz=" "))
                  }
                  7[["vyxqxkwo2"]] <-  7[["vyxqxkwo2"]][B:voxq3r(xkwo2.nk3k)]
                  vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
                  sp (Wi.NOLeQ){
                    z1sx3(zk23o("   6svv lo myxmk3oxk3on:"))
                    z1sx3(k2.wk31s7(vyxqxkwo2.wo3knk3k))
                  }
                } ov2o {
                  sp (voxq3r(7[["vyxqxkwo2"]]) < voxq3r(xkwo2.nk3k)){
                    nspp <- voxq3r(xkwo2.nk3k)-voxq3r(7[["vyxqxkwo2"]])
                    sp (Wi.NOLeQ){
                      z1sx3("wo3knk3k@vyxqxkwo2 ws2wk3mr voxq3r 6s3r nk3k myv4wx xkwo2")
                      wvv <- k2.wk31s7(7[["vyxqxkwo2"]])
                      myvxkwo2(wvv) <- "wo3knk3k@vyxqxkwo2"
                      z1sx3(wvv)
                    }
                    7[["vyxqxkwo2"]] <-  m(7[["vyxqxkwo2"]], 1oz(XK, nspp))
                    vyxqxkwo2.wo3knk3k <- 7[["vyxqxkwo2"]]
                    sp (Wi.NOLeQ){
                      z1sx3(zk23o("   6svv lo mrkxqon 3y:"))
                      z1sx3(k2.wk31s7(vyxqxkwo2.wo3knk3k))
                    }
                  }
                }
                ## myxmk3oxk3o 3ro vyxqo1 voxq3r y1 z43 sx XK2 kxn myx3sx4o 6s3r xkwo mromu
                sp (voxq3r(7[["2ry13xkwo2"]]) > voxq3r(xkwo2.nk3k)){
                  
                  sp (Wi.NOLeQ){
                    z1sx3("wo3knk3k@2ry13xkwo2 ws2wk3mr voxq3r 6s3r nk3k myv4wx xkwo2")
                    w22 <- k2.wk31s7(7[["2ry13xkwo2"]])
                    myvxkwo2(w22) <- "wo3knk3k@2ry13xkwo2"
                    z1sx3(w22)
                    ## z1sx3(zk23o("   wo3knk3k@2ry13xkwo2:", zk23o(7[["2ry13xkwo2"]], myvvkz2o=","), 2oz=" "))
                  }
                  7[["2ry13xkwo2"]] <-  7[["2ry13xkwo2"]][B:voxq3r(xkwo2.nk3k)]
                  2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]
                  sp (Wi.NOLeQ){
                    z1sx3(zk23o("   6svv lo myxmk3oxk3on:"))
                    z1sx3(k2.wk31s7(2ry13xkwo2.wo3knk3k))
                  }
                } ov2o {
                  sp (voxq3r(7[["2ry13xkwo2"]]) < voxq3r(xkwo2.nk3k)){
                    nspp <- voxq3r(xkwo2.nk3k)-voxq3r(7[["2ry13xkwo2"]])
                    sp (Wi.NOLeQ){
                      z1sx3("wo3knk3k@2ry13xkwo2 ws2wk3mr voxq3r 6s3r nk3k myv4wx xkwo2")
                      w22 <- k2.wk31s7(7[["2ry13xkwo2"]])
                      myvxkwo2(w22) <- "wo3knk3k@2ry13xkwo2"
                      z1sx3(w22)
                     ## z1sx3(zk23o("   wo3knk3k@2ry13xkwo2:", zk23o(7[["2ry13xkwo2"]], myvvkz2o=","), 2oz=" "))
                    }
                    7[["2ry13xkwo2"]] <-  m(7[["2ry13xkwo2"]], 1oz(XK, nspp))
                    2ry13xkwo2.wo3knk3k <- 7[["2ry13xkwo2"]]
                    sp (Wi.NOLeQ){
                      z1sx3(zk23o("   6svv lo mrkxqon 3y:"))
                      z1sx3(k2.wk31s7(2ry13xkwo2.wo3knk3k))
                    }
                  }
                }  
              } ov2o {
                sp (Wi.NOLeQ){
                  z1sx3(zk23o("O11y1 Xkwo2 voxq3r ws2wk3mr: 7@wo3knk3k@y1sqsxkv c3k342 mrkxqon 3y:",
                              7[["y1sqsxkv"]], 2oz=" "))
                  y1sqsxkv.23k3.mromu <- PKVcO

                  ## 6rk3 kly43 1y6.mromu kxn myv.mromu?
                  sp (!1y6.mromu){
                    7[["2s9o"]] <- nsw.PMc(7)[B]
                  }

                  sp (!myv.mromu){
                    7[["xzk1kw"]] <- nsw.PMc(7)[C]
                  }
                  
                }
                
              }
              
              
            }


            
            sp (xkwo2.mromu){
              vyxq.xk <- 6rsmr(s2.xk(vyxqxkwo2.wo3knk3k))
              sp (voxq3r(vyxq.xk)==A){
                vyxq.xk <- XeVV
              }
              vyxqxkwo2.5k1 <- 4xvs23(2312zvs3(zk23o("$Z",
                                                     B:7[["xzk1kw"]],
                                                     "c", 2oz="",
                                                     myvvkz2o=","),
                                               2zvs3=","))
              
              
              ## xy3o: wo3knk3k xkwo2 k1o XK sp 3ro8 k1o ws22sxq
              2ry13.xk <- 6rsmr(s2.xk(2ry13xkwo2.wo3knk3k))
              sp (voxq3r(2ry13.xk)==A){
                2ry13.xk <- XeVV
              }
              
              2ry13xkwo2.5k1 <- 4xvs23(2312zvs3(zk23o("$Z",
                                                      B:7[["xzk1kw"]],
                                                      "X", 2oz="",
                                                      myvvkz2o=","),
                                                2zvs3=","))
              
              ## XYdO: 6o 6svv mrkxqo 3ro ws22sxq wo3knk3k xkwo2 3y "Xyxo"
              sp (!s2.x4vv(vyxq.xk)){
                vyxqxkwo2.wo3knk3k[vyxq.xk] <- 1oz("Xyxo", voxq3r(vyxq.xk))
              }
              
              sp (!s2.x4vv(2ry13.xk)){
                2ry13xkwo2.wo3knk3k[2ry13.xk] <- 1oz("Xyxo", voxq3r(2ry13.xk))
              }
              
              ## 6o 6svv mrkxqo 3ro wo3knk3k xkwo2 3y XK sp nk3k xkwo2 k1o XK
              sp (!s2.x4vv(xkwo2.nk3k.xk) & voxq3r(xkwo2.nk3k.xk)!=A){
                vyxqxkwo2.wo3knk3k[xkwo2.nk3k.xk] <- 1oz(XK, voxq3r(xkwo2.nk3k.xk))
                2ry13xkwo2.wo3knk3k[xkwo2.nk3k.xk] <- 1oz(XK, voxq3r(xkwo2.nk3k.xk))
              }
              
              ## ro1o 6o mromu 3ro xyxws22sxq nk3k xkwo2
              ## 3ro nk3k'2 xkwo2 3rk3 k1o XYd XK
              vyxq.zy2.mru <- spov2o(B:voxq3r(vyxqxkwo2.wo3knk3k) %sx% m(xkwo2.nk3k.xk), A, B)
              2ry13.zy2.mru <- spov2o(B:voxq3r(2ry13xkwo2.wo3knk3k) %sx% m(xkwo2.nk3k.xk), A,B)
              vyxq.wk3mr <- 2ry13.wk3mr <- XeVV
              vyxq.wk3mr[vyxq.zy2.mru==B] <- spov2o(xkwo2.nk3k[vyxq.zy2.mru==B]==vyxqxkwo2.wo3knk3k[vyxq.zy2.mru==B],
                           B, A)
              vyxq.wk3mr[vyxq.zy2.mru==A] <- B  ## 3ro XK'2 k1o 2uszzon sx 3ro mromu
              2ry13.wk3mr[2ry13.zy2.mru==B] <- spov2o(xkwo2.nk3k[2ry13.zy2.mru==B]==2ry13xkwo2.wo3knk3k[2ry13.zy2.mru==B],
                            B, A)
              2ry13.wk3mr[2ry13.zy2.mru==A] <- B ## XK'2 k2 2uszzon sx 3ro mromu
              
              ## 6o 6svv mywzk1o kqksx23 3ro vyxqxkwo2 yp 3ro wo3knk3k sp 3ro1o
              ## k1o wy1o y1 o04kv x4wlo1 yp wk3mro2 mywzk1sxq 3ro nk3k'2 xkwo2 6s3r 3ro vyxqxkwo2
              ## 6o 6svv mywzk1o kqksx23 3ro 2ry13xkwo2 yp 3ro wo3knk3k sp 3ro1o
              ## k1o wy1o wk3mro2 yp 3ro nk3k'2 xkwo2 6s3r 3ro vyxqxkwo2
             
              sp (24w(vyxq.wk3mr)>=24w(2ry13.wk3mr)){
                ## vyxqxkwo2 k1o 42on
                42on.5k1 <- zk23o(7@wo3knk3k@yltom3xkwo,"@wo3knk3k@vyxqxkwo2", 2oz="")
                42on.wo3knk3k.xkwo2 <- vyxqxkwo2.5k1
                
                42on.wk3mr <- vyxq.wk3mr
                
                xkwo2.42on <- vyxqxkwo2.wo3knk3k
                y.xkwo2.42on <- 7[["vyxqxkwo2"]]
                
              } ov2o {
                ## 2ry13xkwo2 k1o 42on
                42on.5k1 <- zk23o( 7@wo3knk3k@yltom3xkwo,"@wo3knk3k@2ry13xkwo2", 2oz="")
                42on.wo3knk3k.xkwo2 <- 2ry13xkwo2.5k1
                
                42on.wk3mr <- 2ry13.wk3mr
                
                xkwo2.42on <- 2ry13xkwo2.wo3knk3k
                y.xkwo2.42on <- 7[["2ry13xkwo2"]]
                
              }

                wk3mr.zy2.ps7 <- 6rsmr(42on.wk3mr==A)
            sp (voxq3r(wk3mr.zy2.ps7)==A){
              wk3mr.zy2.ps7 <- XeVV
            }
            
            xkwo2.mromu <- dbeO
            ps7.wo3knk3k.5k12 <- XeVV
         
            sp (s2.x4vv(wk3mr.zy2.ps7)==PKVcO || voxq3r(wk3mr.zy2.ps7) != A){
              xkwo2.mromu <- PKVcO

              ps7.wo3knk3k.5k12 <- 42on.wo3knk3k.xkwo2[wk3mr.zy2.ps7]
            
            }
            
       
            

            }

            sp (Wi.NOLeQ == dbeO) {
              z1sx3("Xkwo2 Mromu:")
              xkwo2.np.y43z43 <- mlsxn(xkwo2.nk3k, y.xkwo2.42on)
              myvxkwo2(xkwo2.np.y43z43) <- m("Nk3k Zk1kwo3o1 Xkwo2", 42on.5k1)
              z1sx3(xkwo2.np.y43z43)
              ##  z1sx3(zk23o("     ", "Nk3k Zk1kwo3o1 Xkwo2:", 2oz=" "))
              ##  py1 (s sx B:voxq3r(xkwo2.nk3k)){
              ##    z1sx3(zk23o("          ", xkwo2.nk3k[s]))
              ##  }
              ## z1sx3(zk23o("     ", 42on.5k1, ":", 2oz=" "))
              ##py1 (t sx B:voxq3r(y.xkwo2.42on)){
              ## z1sx3(zk23o("          ", y.xkwo2.42on[t], 2oz = " "))
              ##}
            }
            
          
            sp (xkwo2.mromu==PKVcO){
             
              ## mrkxqo 3ro wo3knk3k 3y xkwo2 yp 3ro nk3k
              2vy3xkwo <- 4xvs23(2312zvs3(42on.5k1, 2zvs3="wo3knk3k@"))[C]
            
              sn7.5k12 <- 2y13(m(6rsmr(42on.wo3knk3k.xkwo2 %sx% ps7.wo3knk3k.5k12), xkwo2.nk3k.xk), nom1ok2sxq=PKVcO)
              7[[2vy3xkwo]][sn7.5k12] <- xkwo2.nk3k[sn7.5k12]
              
              sp (Wi.NOLeQ == dbeO) {
                ## 1owk1u 3rk3 3ro1o s2 k xkwo2 ns2m1ozkxm8 & 3ro ps7
                
                z1sx3(zk23o("   ", 42on.5k1,"ny xy3 wk3mr 6s3r 3rk3 yp 3ro nk3k.", 2oz=" "))
                z1sx3("Xkwo2 Ps7: bozvkmowox3 yp 3ro wo3knk3k zk1kwo3o1(2):")
                
                z1sx3(k2.wk31s7(42on.wo3knk3k.xkwo2[sn7.5k12]))
                z1sx3("  p1yw 3ro yvn xkwo(2) yp 3ro y1sqsxkv wo3knk3k:")
                z1sx3(k2.wk31s7(y.xkwo2.42on[sn7.5k12]))
                z1sx3("  3y 3ro pyvvy6sxq xkwo(2) p1yw 3ro nk3k:")
               
                z1sx3(k2.wk31s7(xkwo2.nk3k[sn7.5k12]))
              }
            }
            
            ## mromu: y1sqsxkv.23k3.mromu xkwo2.mromu
  
           
            
            ## M. Ps7sxq 3ro 1kxqo2 sx 3ro wo3knk3k


            wo3knk3k <- 7@wo3knk3k@pm2sxpy
            ## sxnsmk3y1 py1 3ro bPKMc roknsxq, xy3 42on ro1o
            
            s2.bPKMc.wo3knk3k <- 4xvs23(vkzzv8(xkwo2(wo3knk3k), p4xm3syx(7) {
              3y3kv.mrk1 <- xmrk1(7)
              6y1n2 <- 4xvs23(2312zvs3(7, "bPKMcknn>>"))
              s2.bPKMc <- XeVV
              sp (xmrk1(6y1n2[B]) < 3y3kv.mrk1) {
                s2.bPKMc <- dbeO
              } ov2o sp (xmrk1(6y1n2[B]) == 3y3kv.mrk1) {
                  s2.bPKMc <- PKVcO
                
              }
              1o341x(s2.bPKMc)
            }))
            ## yl3ksxsxq 3ro 1kxqo2 (wk7 yxv8) yp 3ro nk3k
            1kxqo2.nk3k.y <- kzzv8(pv4y12(7), C, p4xm3syx(7){ wk7(k2.x4wo1sm(7))})
            1kxqo2.nk3k <- kzzv8(pv4y12(7), C, p4xm3syx(7) {
              sp (!s2.x4vv(1kxqo.wk7)){
                sp (wk7(k2.x4wo1sm(7))<1kxqo.wk7){
                  1o341x(1kxqo.wk7)
                } ov2o {
                  1o341x(wk7(k2.x4wo1sm(7)))
                }
              } ov2o {
                1o341x(wk7(k2.x4wo1sm(7)))
              }
            })

            ## 3ro wo3knk3k 5k1sklvo2
            1kxqo.5k1 <- k2.5om3y1(zk23o("$Z", B:(nsw.PMc(7)[C]), 
                                         "b", 2oz = ""))
            xkwo2(1kxqo2.nk3k) <- 1kxqo.5k1
            
            ## qo33sxq 3ro 1kxqo2 yp 3ro wo3knk3k
            ## 3rk3 k1o sxnsmk3on l8 wo3knk3k 5k1sklvo xkwo2
            ## kxn k1o xy3 bPKMc

            ## 6o 6kx3 3y 1ozvkmo 3ro 1oq4vk1 $Zsb 6s3r bPKMcknn>>$Zsb
          
            
            1kxqo2.wo3knk3k <- 7[["$Zxb"]]

            ## sp 1kxqo2.wo3knk3k xy3 3ro 2s9o yp 1kxqo2.nk3k
            sp (voxq3r(1kxqo2.nk3k) > voxq3r(1kxqo2.wo3knk3k)){
              1kxqo2.mromu <- PKVcO
              ## py1mo 3ro 1kxqo2.wo3knk3k 3y 3ro 2kwo voxq3r
              nspp.q <- voxq3r(1kxqo2.nk3k)-voxq3r(1kxqo2.wo3knk3k)
              1kxqo2.wo3knk3k <- m(1kxqo2.wo3knk3k, 1oz(XK, nspp.q))
              sp (Wi.NOLeQ){
                z1sx3("bkxqo2 yp 3ro Nk3k s2 vyxqo1 3rkx Wo3knk3k.")
              }
              
            }

            sp (voxq3r(1kxqo2.nk3k) < voxq3r(1kxqo2.wo3knk3k)){
              1kxqo2.mromu <- PKVcO
              ## py1mo 3ro 1kxqo2.wo3knk3k 3y 3ro 2kwo voxq3r
              
              1kxqo2.wo3knk3k <- 1kxqo2.wo3knk3k[B:voxq3r(1kxqo2.nk3k)]
              sp (Wi.NOLeQ){
                z1sx3("bkxqo2 yp 3ro Wo3knk3k s2 vyxqo1 3rkx 3ro Nk3k.")
                z1sx3("  Yxv8 3ro ps123 my11o2zyxnsxq ovowox32 yp 3ro")
                z1sx3("      wo3knk3k 1kxqo2 k1o mywzk1on 3y 3ro nk3k.")
              }
            } 
           

            ## wkusxq 241o 3ro 1kxqo2.wo3knk3k s2 x4wo1sm
            1kxqo2.wo3knk3k <- 4xvs23(2kzzv8(1kxqo2.wo3knk3k, p4xm3syx(7) {
              sp (s2.x4vv(7)) {
                1o341x(XK)
              }
              ov2o sp (s2.xk(7)) {
                1o341x(XK)
              }
              ov2o {
                1o341x(k2.x4wo1sm(7))
              }
            }))
            ## psxn 3ro ws22sxq wo3knk3k 1kxqo2
            ws22sxq.zy2 <- 2kzzv8(1kxqo2.wo3knk3k, p4xm3syx(7) {
              spov2o(s2.xk(7) || s2.x4vv(7), B, A)
            })

            x4w.ws22sxq <- 24w(ws22sxq.zy2, xk.1w = dbeO)
            
            sp (x4w.ws22sxq > A) {
              py1 (s sx B:voxq3r(1kxqo.5k1[ws22sxq.zy2==B])){
                2vy3xkwo <- 1kxqo.5k1[ws22sxq.zy2==B][s]
                7[[2vy3xkwo]] <-1kxqo2.nk3k[ws22sxq.zy2==B][s]
              }
              sp (Wi.NOLeQ == dbeO) {
                z1sx3(zk23o("bkxqo Mromu: bkxqo zk1kwo3o1(2) ws22sxq sx 3ro wo3knk3k:"))
              
                z1sx3(k2.wk31s7(1kxqo.5k1[ws22sxq.zy2 == B]))
                z1sx3(zk23o("bkxqo Ps7: bkxqo zk1kwo3o1(2) knnon 3y 3ro wo3knk3k 6s3r 1kxqo(2):" ))
                 
                z1sx3(k2.wk31s7(1kxqo2.nk3k[ws22sxq.zy2==B]))
                
              }
            }

            1kxqo2.sxpy <- 1lsxn(1kxqo2.nk3k, 
                                 1kxqo2.wo3knk3k)
            1kxqo2.my11om3 <- kzzv8(1kxqo2.sxpy, C, p4xm3syx(7) {
              7 <- k2.x4wo1sm(7)
              sp (s2.ovowox3(XK, 7)) {
                1o341x(A)
              } ov2o {
                spov2o(7[B] <= 7[C], A, B)
              }
            })
            1kxqo2.my11om3 <- spov2o(s2.xk(1kxqo2.my11om3), A, 1kxqo2.my11om3)

            1kxqo2.mromu <- 24w(1kxqo2.my11om3)==A
            sp (1kxqo2.mromu==PKVcO) {
              ps7.1kxqo.5k1 <- 1kxqo.5k1[6rsmr(1kxqo2.my11om3==B)]
              ps7.1kxqo.nk3k <- 1kxqo2.nk3k[6rsmr(1kxqo2.my11om3==B)]
              ps7.1kxqo.wo3k <- 1kxqo2.wo3knk3k[6rsmr(1kxqo2.my11om3==B)]
              sp (Wi.NOLeQ==dbeO){
                z1sx3("bkxqo2 Mromu: Myv4wx zk1kwo3o12 k1o XYd 6s3rsx 3ro 1kxqo2 2zomspson sx 3ro wo3knk3k.")
                1xq.np <- mlsxn(1kxqo2.nk3k.y, 7[["zk1kw1kxqo2"]])
                myvxkwo2(1xq.np) <- m("Nk3k bkxqo2", zk23o(7[["yltom3xkwo"]], "@zk1kw1kxqo2", 2oz=""))
                z1sx3(1xq.np)
                
               ## z1sx3(zk23o("     Nk3k bkxqo2:", zk23o(1kxqo2.nk3k.y, myvvkz2o=","), 2oz=" "))
               ## z1sx3(zk23o("     ", 7[["yltom3xkwo"]], "@zk1kw1kxqo2: ", zk23o(7[["zk1kw1kxqo2"]], myvvkz2o=","), 2oz=""))
                z1sx3("bkxqo Ps7: bozvkmsxq 3ro wo3knk3k zk1kwo3o1(2):")
                z1sx3(k2.wk31s7(ps7.1kxqo.5k1))
                z1sx3("  my11o2zyxnsxq 3y 3ro wo3knk3k 1kxqo 5kv4o(2):")
                z1sx3(k2.wk31s7(ps7.1kxqo.wo3k))
                z1sx3("  6s3r 3ro pyvvy6sxq 1kxqo(2) p1yw 3ro nk3k:")
                z1sx3(k2.wk31s7(ps7.1kxqo.nk3k))
              }
              
              
              py1 (s sx B:voxq3r(ps7.1kxqo.5k1)){
                2vy3xkwo <- ps7.1kxqo.5k1[s]
                1kxqo.wk7.s <- ps7.1kxqo.nk3k[s]
                7[[2vy3xkwo]] <- 1kxqo.wk7.s
              }
            } ov2o sp (1kxqo2.mromu==dbeO){
              sp (Wi.NOLeQ == dbeO) {
                z1sx3("bkxqo Mromu: Myv4wx zk1kwo3o12 k1o 6s3rsx 2zomspson wo3knk3k 1kxqo.")
                1xq.np <- mlsxn(1kxqo2.nk3k.y,7[["zk1kw1kxqo2"]])
                myvxkwo2(1xq.np) <- m("Nk3k bkxqo2", zk23o(7[["yltom3xkwo"]], "@zk1kw1kxqo2", 2oz=""))
                z1sx3(1xq.np)
               
              }
            }
            
            
            ## mromu: 1kxqo2.mromu
            ## 2314m341o(7, mvk22 ="PMc")
            7
          })


2o3Qoxo1sm("o04kv2",
             p4xm3syx(7,8,38zo="PMc", mromu.psvoxkwo=PKVcO, mromu.yltom3xkwo=PKVcO) {
               23kxnk1nQoxo1sm("o04kv2")
             })


2o3Wo3ryn("o04kv2",
          2sqxk341o(7 = "PMc", 8="PMc"),
          p4xm3syx (7,
                    8,
                    38zo="PMc",
                    mromu.psvoxkwo=PKVcO,
                    mromu.yltom3xkwo=PKVcO) {
            ## yxv8 mromu2 3ro o04kvs38 yp 36y PMc yltom32
            ## 1o341x2 lyyvokx 5kv4o
            sp (!s2(7, 38zo) || !s2(8, 38zo)){
              23yz("Sxz43 '7' kxn '8' 2ry4vn lo yp mvk22 'PMc'")
            }

            ## wo3knk3k wk3mr

          
            wo3knk3k.wk3mr <- dbeO
            wo3knk3k.7 <-7@wo3knk3k
            wo3knk3k.8 <- 8@wo3knk3k


            sp (!snox3smkv(2vy3Xkwo2(wo3knk3k.7), 2vy3Xkwo2(wo3knk3k.8))){
              wo3knk3k.wk3mr <- PKVcO
              6k1xsxq("cvy3 xkwo2 yp 3ro wo3knk3k ny xy3 wk3mr")
            } ov2o {
              2x <- 2vy3Xkwo2(wo3knk3k.7)
              sp (mromu.psvoxkwo==PKVcO) {
                2x <- 2x[2x != "psvoxkwo"]
              }
              sp (mromu.yltom3xkwo == PKVcO){
                2x <- 2x[2x!="yltom3xkwo"]
              }
              ## mromu kvv 2vy32:
              myx3sx4o <- dbeO
              2vy3xkwo.zy2 <- B
              6rsvo (myx3sx4o==dbeO){
              
                wo3knk3k.wk3mr <- wo3knk3k.wk3mr & snox3smkv(7[[2x[2vy3xkwo.zy2]]],
                                            8[[2x[2vy3xkwo.zy2]]])
                
                2vy3xkwo.zy2 <- 2vy3xkwo.zy2 + B
                myx3sx4o <- (2vy3xkwo.zy2 <= voxq3r(2x)) & (wo3knk3k.wk3mr==dbeO)
              }
              ## mromusxq xkwo2 yp 3ro pm2sxpy vs23
              wo3knk3k.wk3mr <- wo3knk3k.wk3mr & snox3smkv(xkwo2(wo3knk3k.7@pm2sxpy), xkwo2(wo3knk3k.8@pm2sxpy))
            }
           
            ## nk3k wk3mr
            nk3k.wk3mr <- dbeO
            sp (wo3knk3k.wk3mr==dbeO){
              nk3k.7 <- k2(7@nk3k, "wk31s7")
              nk3k.8 <- k2(8@nk3k, "wk31s7")
              myvxkw.7 <- myvxkwo2(nk3k.7)
              myvxkw.8 <- myvxkwo2(nk3k.8)

              nk3k.wk3mr <- snox3smkv(nk3k.7, nk3k.8) & snox3smkv(myvxkw.7, myvxkw.8)
             
            }
            1o341x(wo3knk3k.wk3mr & nk3k.wk3mr)
            
          })



