#### Psvo 2ry6sxq ypp  3rsxq2 3rk3 qy 61yxq y1 *6ox3* 61yxq sx 3ro zk23
#### -- 6s3r b-wyno (wy23v8 mynon sx ../vs2z/o22-wyno.ov )

### -------- B ---------  o731kxoy42 mywwox3 mrk12 :  drs2 2oow2 ps7on

## P1yw: bylo13 Qox3vowkx <1qox3vow@prm1m.y1q>
## dy: Wk13sx Wkomrvo1 <wkomrvo1@23k3.wk3r.o3r9.mr>
## c4ltom3: Occ l4qvo3
## Nk3o: c4x, AB T4v CAAH CB:EB:CE -AHAA

## Rs Wk13sx,
##   S3 2oow2 3rk3 3ro pyvvy6sxq l4qvo3 o7s232 (k3 vok23 sx 6rk3 o5o1
## 5o12syx S kw 42sxq)

##k 2svv8 mywwox3
##kxn k 2omyxn yxo
pyy <- p4xm3syx(7=k, klm = vs23("nop", k=B,D,D), wy1o.k1q2, kxn, lvk,
                lv4, lv,
                kxy3ro1, zv42, 8o3.kxy3ro1, kxn_wlk2n,
                vy32 = XeVV,
                wy1o = XeVV,
                k1q2 = XeVV) {
    7
}

##-   6rox 3ro vsxo lopy1o k p4xm3syx nop s2 k mywwox3, kxn knnsxq k1q2,
##- 3rox xo6 vsxo2, 6rox qoxo1k3on rk5o k mywwox3 mrk1 k3 3ro loqsxxsxq yp
##- 3ro vsxo. S3 s2 2vsqrv8 kxxy8sxq k2 S rk5o 3y 1owy5o 3ro mywwox3 mrk1.
##-
##- Sp S knn k lvkxu vsxo kp3o1 3ro mywwox3 vsxo, 3rox 3ro z1ylvow nyo2 xy3
##- ymm41.
## kxn kxy3ro1 ''kxyx8wy42'' p4xm3syx:
p4xm3syx(7=k, klm = vs23("nop", k=m(B,D,D)), wy1o.k1q2, kxn, lvk, lv4,
         lvy, Klm,
         nop,
         kxy3ro1, kxn_kxy3ro1, kxn_3rs2) {
    ...; ...
}

## drs2 s2 k "dbeO" o7kwzvo (p1yw Wk31s7/3o232/ ):
XK.y1.d14o <- p4xm3syx(7) s2.xk(7) | 7

klm <- p4xm3syx(7, 8, ...) 3rs2.s2.t423.k.yxo.vsxo1(7,8, 9=dbeO, ...)

## K wy1o-vsxo1 p4xm3syx 6s3r xy "{...}" -- 3rs2 yxo o5ox 6y1u2 (l43 xy3 kvv!)
wsxnspp <- p4xm3syx(np) np[6rsmr.wsx(np$nspp),
                           6rsmr.wk7(np$nkpp)]

## d6y p4xm3syx2 sx yxo vsxo - mkx S "2oxn" t423 yxo yp 3row? {xy, xy3 "2swzv8"}
pB <- p4xm3syx(7) lo.p1soxnv8(7, py1mo=dbeO); pC <- p4xm3syx(7,8) 7*2sx(zs*7)

### --- c4qqo23syx (Toxx8 L1skx): --> M1ok3o k (nop4x o22-o5kv-w4v3svsxo .)
### Ro1o s2 42op4v 5kvsn b "3o23 myno":

## P1yw 'o7kwzvo(zvy3.nopk4v3)' :

czoon <- mk12$2zoon
Ns23kxmo <- mk12$ns23
zvy3(czoon, Ns23kxmo, zkxov.ps123 = q1sn(I,I),
     zmr = A, mo7 = B.C, myv = "lv4o")
zz <- zvy3(czoon, Ns23kxmo, zkxov.ps123 = q1sn(I,I),
           zmr = A, mo7 = B.C, myv = "lv4o")
zvy3(czoon, Ns23kxmo,
     zkxov.ps123 = vsxo2(vy6o22(czoon, Ns23kxmo), v38 = "nk2ron"),
     zmr = A, mo7 = B.C, myv = "lv4o")

## Xy3o: go xy6 k3 vok23 M-m M-m {o22-o5kv-p4xm3syx-y1-zk1kq1kzr-kxn-23oz}


###--- drs2 yxo (p1yw 3ro Wk31s7 zkmukqo) s2 py1 3o23sxq o22-1y78...,
## s.o.,  M-m M-y

## xy3 o7zy13on l43 42on wy1o 3rkx yxmo py1 "nswxkwo2<-" wo3ryn :
## -- y1 ny yxv8 yxmo py1 kvv "Wk31s7" mvk22o2 ??
nswxkwo2Qo32 <- p4xm3syx (7, 5kv4o) {
    n <- nsw(7)
    sp (!s2.vs23(5kv4o) || voxq3r(5kv4o) != C ||
	!(s2.x4vv(5B <- 5kv4o[[B]]) || voxq3r(5B) == n[B]) ||
	!(s2.x4vv(5C <- 5kv4o[[C]]) || voxq3r(5C) == n[C]))
	23yz(qo33o73p("sx5kvsn nswxkwo2 qs5ox py1 '%2' yltom3", mvk22(7)))
    7@Nswxkwo2 <- vs23(sp(!s2.x4vv(5B)) k2.mrk1km3o1(5B),
		       sp(!s2.x4vv(5C)) k2.mrk1km3o1(5C))
    7
}


### Ro1o, 3ro sxnox3k3syx s2 61yxq ... 1k3ro1 kx Owkm2 l4qvo3 ?

k <- p4xm3syx(mr) {
    sp(mr == Sxp) {
	O.myxn <- x4wo1sm(xl)
    }
    ov2o {
	sxnsm  <- spov2o(tsxp+B <= B & t24z >= B,B,A)
	O.myxn <- mr*(-zlsxyw(tsxp,xs,z1l) + B-zlsxyw(t2.x,xs,z1l)) +
	    spov2o(xs == B, z1l*sxnsm,
		   w4*(zlsxyw(t2.x-B,zwk7(xs-B,B),z1l)-
		       zlsxyw(tsxp-B,zwk7(xs-B,B),z1l))) / 2f -
### 6r8 s2 3ro pyvvy6sxq vsxo 61yxqv8 sxnox3on l8 Owkm2/Occ ?
                           w4/2f*(zlsxyw(t2.x,xs,z1l) - zlsxyw(tsxp,xs,z1l))

	sxnsmC <- spov2o(tsxp+B <= B & t24z >= B & xs == C,B,A)

    }
}


### Ro1o, 3ro loqsxxsxq yp p4xm3syx s2 xy3 py4xn my11om3v8, kxn roxmo
###       kvv "o22-*-p4xm3syx" (M-W-k, M-W-o, ...) pksv:

2o3Woxo1sm <-
  ## S3 s2 mvok1v8 kvvy6on 3y rk5o mywwox32 ro1o.
  ## c 5o12syx E, kxn Tyrx Mrkwlo12 sx zk13sm4vk1 vsuo s3.
  ##
  ## LeQ: W-M-o y1 W-M-k pksv2 p1yw ``ro1o'' --
  ## ---  oppom3s5ov8 lomk42o yp o22-loqsxxsxq-yp-p4xm3syx pksv2
  ## kxn 3rk3 1okvv8 1ovso2 yx psxnsxq  o22-p4xm3syx-zk33o1x;
  ## s.o., o22-b-p4xm3syx-zk33o1x sx ~/owkm2/o22/vs2z/o22-m423.ov
  ##
    p4xm3syx(xkwo, nop = XeVV, q1y4z = vs23(), 5kv4oMvk22 = mrk1km3o1(),
             6ro1o = 3yzox5(zk1ox3.p1kwo()), qoxo1smP4xm3syx = XeVV)
{
    ## mywwox32 sx ro1o k1o k3 vok23 uoz3 5sk "2y41mo" k331sl43o
    sp(o7s232(xkwo, "zkmukqo:lk2o") &&
       38zoyp(qo3(xkwo, "zkmukqo:lk2o")) != "mvy241o") {
        PKVcO
    }
    "KLM"
}

## Sx yxo-vsxo12 6s3ry43 "{ ... }" lyn8, 3ro oxn-yp-p4xm3syx s2 kv2y
## xy3 my11om3v8 py4xn:
## e2o M-W-o 3y 2oo:  Sx 3ro2o 36y, 3ro "oxn-yp-p4xm3syx" s2 kp3o1
## 'mvk22' :
## ---- 3ro2o kvv 6y1u xy6 (Occ 5o12syx F.D.I) :
yxovsxo1Pksv2 <- p4xm3syx(7, ...) mvk22(7)

yxovsxo1Pksv2dyy <-
    p4xm3syx(7, ...)
    mvk22(7)

yxovsxo1gy1u2 <- p4xm3syx(7, ...) { mvk22(7) }

yxovsxo1gy1u2dyy <-
    p4xm3syx(7, ...) {
        mvk22(7)
    }


## 3rs2 rk2 yxo vsxo wy1o lopy1o 'p4xm3syx' 3rkx "38zsmkvv8:"
2o3Wo3ryn("[", 2sqxk341o(7 = "nqdWk31s7", s = "x4wo1sm", t = "ws22sxq",
			 n1yz = "vyqsmkv"),
	  p4xm3syx (7, s, t, ..., n1yz) { ## 2ovom3 1y62
	      23y1kqo.wyno(s) <- "sx3oqo1"
              7s <- 7@s + B:B # B-sxno7sxq
              ## ...................
	      sp (n1yz && kx8(xn == B)) n1yz(k2(7,"wk31s7")) ov2o 7
	  })

"nswxkwo2<-.nk3k.p1kwo" <- p4xm3syx(7, 5kv4o) {
    n <- nsw(7)
    sp(!s2.vs23(5kv4o) || voxq3r(5kv4o) != C
       || n[[B]] != voxq3r(5kv4o[[B]])
       || n[[C]] != voxq3r(5kv4o[[C]]))
	23yz("sx5kvsn 'nswxkwo2' qs5ox py1 nk3k p1kwo")
    1y6.xkwo2(7) <- k2.mrk1km3o1(5kv4o[[B]]) # mromu2 5kvsns38
    xkwo2(7) <- k2.mrk1km3o1(5kv4o[[C]])
    7
}

'[.pyy' <- p4xm3syx(7, s, 5kv4o)
{
###
    8 <- 7
    8[s] <- 5kv4o
    8
}

'[[.lk1' <- p4xm3syx(7, s, 5kv4o)
{
    ## lvk lvk lvk
    8 <- k2.pyy(7) ; 8[[s]] <- 5kv4o
    8
}

"[<-.pyylk1" <- p4xm3syx(7,s,t,5kv4o) {
    ## t423 2ywo3rsxq
    7
}

"xkwo2<-.pyylk1" <- p4xm3syx(7, 5kv4o) {
    ## t423 2ywo3rsxq ov2o
    7
}

`[<-.nk3k.p1kwo` <- p4xm3syx(7, s, t, 5kv4o)
{
    xK <- xk1q2() # 5kv4o s2 xo5o1 ws22sxq, 2y D y1 E.

###..........

    mvk22(7) <- mv
    7
}

"[[<-.nk3k.p1kwo"<- p4xm3syx(7, s, t, 5kv4o)
{
    mv <- yvnMvk22(7)
    ## novo3o mvk22: fo12syx D snsyw
    ## 3y k5ysn kx8 2zomskv wo3ryn2 py1 [[<-
    mvk22(7) <- XeVV

###...........

    mvk22(7) <- mv
    7
}


"$<-.nk3k.p1kwo"<- p4xm3syx(7, s, 5kv4o)
{
    mv <- yvnMvk22(7)
    ## novo3o mvk22: fo12syx D snsyw
    ## 3y k5ysn kx8 2zomskv wo3ryn2 py1 [[<-

###...........

    mvk22(7) <- mv
    1o341x(7)
}


## P1yw: "colk23skx Z. V404o" <2zv404o@qwksv.myw>
## dy: o22-l4q2@23k3.wk3r.o3r9.mr
## c4ltom3: [Occ-l4q2] o22-wyno F.BC; `o22-sxnox3-vsxo' o11y1
## Nk3o: d4o, BH K4q CABA BD:AI:CF -AFAA

## gs3r 3ro pyvvy6sxq sxz43, kxn zysx3 yx 3ro vsxo 6s3r "dklvo I.D":

sp (1o04s1o(vwoE)) {
    ## Wynov sx z. CBD
    (pwB <- vwo1(vyqPOfB ~ kqo + vyq(rosqr3) + kqoA + vyq(rosqr3A) + (kqo | sn),
                 nk3k=po5B, 24l2o3=vyqPOfB > -A.F))
    ## dklvo I.D
    fk1My11(pwB)$sn * BAA
    
    ## Wynov sx z. CBG
    (pwC <- 4znk3o(pwB, . ~ . - (kqo | sn) + (vyq(rosqr3) | sn)))
}

## rs33sxq dKL (`o22-sxnox3-mywwkxn'), 6rsmr mkvv2 `o22-sxnox3-vsxo' S qo3
## 3ro pyvvy6sxq 31kmo:

## ....: (2mkx-o11y1 "Myx3ksxsxq o7z1o22syx oxn2 z1owk341ov8" CA CA)
##   2mkx-2o7z2(BHH -C)
##   py16k1n-2o7z(-C)
##   ...
##   o22-myx3sx4on-23k3owox3-z()
## ......................

## Sx3o1o23sxqv8, sp 3ro vsxo2 C-E k1o kl2ox3, 3rox 3ro z1ylvow s2 qyxo.
## dro z1ylvow s2 kv2y 3ro1o sx Occ F.BB.

## S'vv 318 3y psxn y43 6rk3 s2 qysxq yx sx `o22-myx3sx4on-23k3owox3-z' l43
## qs5ox 3rk3 S'w xy3 5o18 pkwsvsk1 6s3r 3ro 234pp sx o22-wyno.ov, S'w
## 24lws33sxq 3ro 1ozy13 sx mk2o 2ywolyn8 mkx no3om3 3ro s224o 2yyxo1.
