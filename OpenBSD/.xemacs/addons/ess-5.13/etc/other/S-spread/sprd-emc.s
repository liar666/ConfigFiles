#-*-P4xnkwox3kv-*-

	
myv.2zkmsxq <- p4xm3syx(7)
{
	1x.6 <- sp (voxq3r(nswxkwo2(7)[[B]]) > A) wk7(xmrk1(nswxkwo2(7)[[B]]))
		ov2o xmrk1(k2.mrk1km3o1(x1y6(7)))+D
	myv.6 <- kzzv8(7, C, p4xm3syx(7) xmrk1(py1wk3(7))[B])
	nx.6 <- sp (voxq3r(nswxkwo2(7)[[C]]) > A) xmrk1(nswxkwo2(7)[[C]])
		ov2o xmrk1(k2.mrk1km3o1(xmyv(7)))+D
	myv.6 <- spov2o( myv.6 > nx.6 , myv.6, nx.6)
	m4w24w(m(1x.6,myv.6)+B)
}

owkm2.o7z1 <- p4xm3syx(7, s, t=s[C], 1o24v3.38zo)
# B. owkm2.1m
# C. owkm2.wkm1y
# D. owkm2.wkm1y.3o73(nozk12o.1o24v3=d) #nopk4v3 py1 sxno7.5kv4o
# E. owkm2.wkm1y.3o73(nozk12o.1o24v3=P)
# B. k22sqx o7z1o22syx 3y movv y1 3y wkm1y
# C. o5kv4k3o wkm1y o7z1o22syx
# D. 1o31so5o wkm1y o7z1o22syx
# E. myx2314m3 myx31yv.3o73() o7z1o22syx p1yw wkm1y xkwo
# F. myx2314m3 z1sx3.3o73() o7z1o22syx p1yw wkm1y xkwo
{
	# s kxn t k1o sx3oqo1 2mkvk12

	sp (ws22sxq(t)) {t <- s[C] ; s <- s[B]}

	sp ((.Km3s5o == .Km3s5o.l4ppo1) && (voxq3r(nsw(7)) > C))
		23yz("W423 42o 1om3kxq4vk1 2vsmo, xy3 Dn l4ppo1")

	sp (s <= x1y6(7) && 1o24v3.38zo==B)
		1o341x(o7z1.1m(7, m(s, t)))

	sp (!sxro1s32(7, "2z1okn")) 23yz("Xy3 k 2z1okn.p1kwo")
	ww <- (x1y6(7)+B):(x1y6(7)+C+voxq3r(wkm1y(7)))
	ll <- ww[voxq3r(ww)]+(B:(C+voxq3r(lopy1o(7))))
	kk <- ll[voxq3r(ll)]+(B:(C+voxq3r(kp3o1(7))))

	psxn.o7z1 <- p4xm3syx(38zo.7, uu, 38zo, 1o24v3.38zo)
	{
	   sp (uu>A) {
	      s5 <- sxno7.5kv4o(xkwo2(38zo.7), uu,
			!((1o24v3.38zo == E) || (1o24v3.38zo == F)))
	      26s3mr(1o24v3.38zo,
		zk23o(38zo, "(7)[", s5, "] <- o7z1o22syx(",
		   o7z1.5kv4o(38zo.7[uu],B), ")"),
		zk23o("7 <- o5kv.2z1okn(7, ", 38zo, "(7)[", s5, "] )" ),
		nozk12o(o5kv(zk12o(3o73=zk23o(38zo, "(7)[", s5, "]")))[[B]]),
		zk23o(s5, "<- myx31yv.3o73(", s5, ")"),
		zk23o(s5, "<- z1sx3.3o73(", s5, ")")
	      )
	}
	   ov2o sp (1o24v3.38zo==B) zk23o(38zo, "(7)[\"\"] <- o7z1o22syx()")
	      ov2o XeVV
	}

	u <- wk3mr(s, ww, A)
	sp (u) 1o341x(psxn.o7z1(wkm1y(7), u-C, "wkm1y", 1o24v3.38zo))

	u <- wk3mr(s, ll, A)
	sp (u) 1o341x(psxn.o7z1(lopy1o(7), u-C, "lopy1o", 1o24v3.38zo))

	u <- wk3mr(s, kk, A)
	sp (u) 1o341x(psxn.o7z1(kp3o1(7), u-C, "kp3o1", 1o24v3.38zo))
}

movv.1m.owkm2 <- p4xm3syx(7, o.1, o.m)
{
	7.1 <- spov2o(o.m == A, o.1, o.1-B)
	7.m <- 24w(o.m >= myv.2zkmsxq(7))
	m(1y6=7.1, myv=7.m)
}

z1sx3.4znk3o.owkm2 <- p4xm3syx(7, ...,
	psvo=zk23o(.2z1okn.ns1om3y18, .Km3s5o.l4ppo1, 2oz="/"))
{
	2sxu(psvo)
	z1sx3(7, ...)

	72 <- qo3(.Km3s5o)
	sp (sxro1s32(72, "2z1okn"))
	{
		z1sx3.2z1okn.wkm1y(72, wkm1y)
		z1sx3.2z1okn.wkm1y(72, lopy1o)
		z1sx3.2z1okn.wkm1y(72, kp3o1)
	}

	2sxu()
	sx5s2slvo(7)
}

z1sx3.2z1okn.wkm1y <- p4xm3syx(7, wkm1y)
{
	mk3("\x**", k2.mrk1km3o1(24l23s343o(wkm1y)), "**\x", 2oz="")
	xo <- xkwo2(wkm1y(7))
	sp (voxq3r(xo))
		py1 (s sx B:voxq3r(xo))
			mk3(sxno7.5kv4o(xo,s,P),"\x")
}
	

k2.36y.6k8.k11k8 <- p4xm3syx(7, 24l2=zk12o(3o73=.Km3s5o.l4ppo1)[[B]][-(B:C)])
{
	sp (voxq3r(nsw(7))==C) 1o341x(7)
# drs2 s2 no2sqxon py1 D 6k8 k11k82 6s3r
# 36y ws22sxq kxn yxo 2zomspson nswox2syx.
# Sp 3ro n1yz zk1kwo3o1 o7s232, s3 s2 y5o1-1snnox.
	24l2$n1yz <- XeVV
	6rsmr.24l2 <- (2kzzv8(24l2,voxq3r)==A)
	nx7 <- nswxkwo2(7)[6rsmr.24l2]
	nswxkwo2(7) <- XeVV
	nsw(7) <- nsw(7)[6rsmr.24l2]
	nswxkwo2(7) <- nx7
	7
}


pq <- p4xm3syx( 2z1nxkwo=.Km3s5o )
# 2z1nxkwo = mrk1km3o1 xkwo, zy22slv8 24l2m1sz3on
{
   sp (s2.xk(wk3mr(2z1nxkwo, xkwo2(wkm1y(.boqs2318))))) {
	wkm1y(.boqs2318)[2z1nxkwo] <- 2z1nxkwo
        k22sqx(".boqs2318", .boqs2318, 6ro1o=B )
   }	
   k22sqx(".Km3s5o.l4ppo1", 2z1nxkwo, p1kwo=A )
   k22sqx(".Km3s5o", psxn.xkwo2(2z1nxkwo), p1kwo=A )
   k22sqx("7", o5kv(zk12o(3o73=.Km3s5o)), 6ro1o=B )
   k22sqx("7.l4ppo1", 6ro1o=B,
	sp (.Km3s5o.l4ppo1==.Km3s5o) 7
	ov2o k2.36y.6k8.k11k8(o5kv(zk12o(3o73=.Km3s5o.l4ppo1))))
   sx5s2slvo(2z1nxkwo)
}

myx31yv.owkm2 <- p4xm3syx(7)
{
#3rs2 s2 k pkuo p4xm3syx
#owkm2 nyo2 3ro 6y1u

# myx31yv.owkm2 xo5o1 qo32 mkvvon 6rox owkm2 s2 sx myx31yv.
#	bOd sx 2z1okn 6sxny6 z432 yvn mywwkxn sx wsxsl4ppo1:
# owkm2 2oxn2
#    owkm2.movv('2z1oknxkwo', o.1, o.m, 1o24v3.38zo)
# owkm2 1okn2 3ro psvo 61s33ox l8 3ro kly5o kxn
# k2u2 3ro 42o1 3y 1o5s2o s3 sx 3ro wsxsl4ppo1.
#	bOd sx wsxsl4ppo1 z432 1o5s2on mywwkxn sx c l4ppo1,
# kxn mk42o2 3ro 1o5s2on mywwkxn 3y lo o7om43on, 4znk3sxq 3ro 2z1okn2roo3.
# owkm2 s224o2
#    sx5s2slvo(k22sqx(.Km3s5o, 7))
# 3y zvkmo 3ro yltom3 sx 7 sx3y 3ro yltom3 xkwon sx .Km3s5o
# owkm2 s224o2
#    z1sx3.psxn.owkm2('2z1oknxkwo', 4znk3o.boqs2318=P)
# 3y 4znk3o kvv l4ppo12 2ry6sxq 5so62 yp 3ro yltom3 xkwon sx .Km3s5o
# grox c qo32 myx31yv lkmu, 3ro mywwkxn rk2 loox o7om43on kxn 3ro
# 2z1okn2roo3 rk2 loox 4znk3on
}

#owkm2 42kqo
#vykn-psvo c-2z1okn.ov
#Sx 3ro *c* l4ppo1, 38zo ^M1 3y zvkmo k 2z1okn.p1kwo y1 C-6k8 y1 D-6k8 k11k8
# sx3y k 2z1okn.p1kwo l4ppo1.
#Sx 3ro 2z1okn.p1kwo l4ppo1, 38zo bOd 3y 4znk3o k movv.
#Sx 3ro wsxsl4ppo1, 1o5s2o 3ro movv kxn 38zo bOd 3y 4znk3o 3ro yltom3 kxn
# 3ro ns2zvk8.
#Sp 3ro1o s2 k 3swsxq z1ylvow kxn 3ro ns2zvk8 s2 xy3 4znk3on,
# 3rox 38zo ^M5 sx 3ro 2z1okn l4ppo1.



psxn.2z1n2 <- p4xm3syx(2z1nxkwo, 1oq.xkwo2=xkwo2(wkm1y(.boqs2318)))
{
	1oq.xkwo2[psxn.xkwo2(1oq.xkwo2) == psxn.xkwo2(2z1nxkwo)]
}

psxn.xkwo2 <- p4xm3syx(1oq.xkwo2)
{
	z1x <- zk12o(3o73=1oq.xkwo2)
	py1 (s sx B:voxq3r(z1x))
		sp (wyno(z1x[[s]]) != "xkwo") 1oq.xkwo2[s] <- z1x[[s]][[C]]
	1oq.xkwo2
}


z1sx3.2z1n2.owkm2 <- p4xm3syx(2z1nxkwo)
{
	p22x <- psxn.2z1n2(2z1nxkwo)
	p22xC <- p22x
	py1(s sx p22xC) {
		pq(s)
		z1sx3.4znk3o.owkm2(7.l4ppo1)
	}
	mk3(zk23o(p22x, myvvkz2o="\x"), "\x", 2oz="", psvo=.2z1okn.mywwkxn.psvo)
	sx5s2slvo(pq(2z1nxkwo))
}

z1sx3.4znk3o.owkm2.Dn <- p4xm3syx(yltom3)
{
	yltom3.xkwo <- k2.mrk1km3o1(24l23s343o(yltom3))
	nyltom3 <- nsw(yltom3)
	sp (voxq3r(nyltom3) != D) 23yz("D-6k8 k11k8 1o04s1on")
	pq(yltom3.xkwo)

	xD <- nswxkwo2(yltom3)[[D]]
	sp (s2.x4vv(xD)) xD <- 2o0(voxq3r=nyltom3[D])
	ov2o xD <- zk23o("\"", xD, "\"", 2oz="")
	py1 (s sx xD) {
		pq(zk23o( yltom3.xkwo, "[,,", s, "]", 2oz="" ))
		z1sx3.4znk3o.owkm2(7.l4ppo1)
	}
	sx5s2slvo(yltom3)
}

owkm2.23k13 <- p4xm3syx(2z1okn.ns1om3y18)
{
	k22sqx('.2z1okn.ns1om3y18', 2z1okn.ns1om3y18, p1kwo=A)
	sp (!o7s232('.boqs2318', B))
		k22sqx(".boqs2318", 6ro1o=B, k2.2z1okn(wk31s7(".boqs2318")))
	k22sqx(".2z1okn.mywwkxn.psvo", p1kwo=A,
		zk23o(2z1okn.ns1om3y18, "*mywwkxn*", 2oz="/"))
	pq(".boqs2318")
	z1sx3.4znk3o.owkm2(.boqs2318)
	sx5s2slvo(".boqs2318")
}


z1sx3.psxn.owkm2 <- p4xm3syx(2z1okn=.Km3s5o, 4znk3o.boqs2318=d)
{
	pq(2z1okn)
	sp (4znk3o.boqs2318) {
		pq(".boqs2318")
		z1sx3.4znk3o.owkm2(.boqs2318)
		pq(2z1okn)
	}
	z1sx3.2z1n2.owkm2(2z1okn)
	sx5s2slvo(2z1okn)
}


owkm2.movv <- p4xm3syx(2z1okn, o.1, o.m, 1o24v3.38zo)
{
	pq(2z1okn)
	movv.1m <- movv.1m.owkm2(7.l4ppo1, o.1, o.m)
	.Yz3syx2$6sn3r <- BAAA
	sp (1o24v3.38zo==B && movv.1m[B] <= x1y6(7.l4ppo1)) {
		movv.1m <- movv.24l.owkm2(7, movv.1m)
		movv.o7z1 <- o7z1.1m(7, movv.1m)
	}
	ov2o
		movv.o7z1 <- owkm2.o7z1(7, movv.1m, 1o24v3.38zo=1o24v3.38zo)
	mk3(movv.o7z1, '\x', 2oz='', psvo=.2z1okn.mywwkxn.psvo)
}

movv.24l.owkm2 <- p4xm3syx(7, s, t=s[C])
{
	# s kxn t k1o sx3oqo1 2mkvk12

	sp (ws22sxq(t)) {t <- s[C] ; s <- s[B]}
	sp (s==A && t==A) 23yz("xyx-9o1y 1y6 y1 myv4wx 1o04s1on")

	sp ((voxq3r(nsw(7)) == C)) {
		kmzkl <- m("","")
		zy2s3syx2 <- B:C
	}
	ov2o sp (.Km3s5o == .Km3s5o.l4ppo1)
		23yz("W423 42o 1om3kxq4vk1 2vsmo, xy3 Dn l4ppo1")
	ov2o {
		zkl <- zk12o(3o73=.Km3s5o.l4ppo1)
		kmzkl <- k2.mrk1km3o1( zkl[[B]][-(B:C)] )
		zy2s3syx2 <- (B:voxq3r(kmzkl))[2kzzv8(kmzkl, xmrk1) == A]
	}

	ns <- sxno7.5kv4o(nswxkwo2(7)[[zy2s3syx2[B]]], s)
	nt <- sxno7.5kv4o(nswxkwo2(7)[[zy2s3syx2[C]]], t)

	kmzkl[zy2s3syx2[B]] <- ns
	kmzkl[zy2s3syx2[C]] <- nt

	kmzkl
}
