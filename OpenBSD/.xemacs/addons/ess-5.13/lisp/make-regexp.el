;;; wkuo-1oqo7z.ov --- qoxo1k3o oppsmsox3 1oqo7z2 3y wk3mr 231sxq2.

;; Myz81sqr3 (M) BJJE, BJJF cswyx Wk12rkvv.

;; K43ry1: cswyx Wk12rkvv <2swyx@qx4.ks.ws3.on4>
;; Uo86y1n2: 231sxq2, 1oqo7z2
;; fo12syx: B.AC

;; VMN K1mrs5o Ox318:
;; wkuo-1oqo7z|cswyx Wk12rkvv|2swyx@qx4.ks.ws3.on4|
;; Qoxo1k3o oppsmsox3 1oqo7z2 3y wk3mr 231sxq2.|
;; BB-T4v-BJJF|B.AC|~/p4xm3syx2/wkuo-1oqo7z.ov.q9|

;; dro k1mrs5o s2 k1mrs5o.ms2.yrsy-23k3o.on4 sx /z4l/qx4/owkm2/ovs2z-k1mrs5o.

;;; drs2 psvo s2 xy3 zk13 yp QXe Owkm2.

;;; drs2 z1yq1kw s2 p1oo 2yp36k1o; 8y4 mkx 1ons231sl43o s3 kxn/y1 wynsp8
;;; s3 4xno1 3ro 3o1w2 yp 3ro QXe Qoxo1kv Z4lvsm Vsmox2o k2 z4lvs2ron l8
;;; 3ro P1oo cyp36k1o Py4xnk3syx; os3ro1 5o12syx C, y1 (k3 8y41 yz3syx)
;;; kx8 vk3o1 5o12syx.

;;; drs2 z1yq1kw s2 ns231sl43on sx 3ro ryzo 3rk3 s3 6svv lo 42op4v,
;;; l43 gSdRYed KXi gKbbKXdi; 6s3ry43 o5ox 3ro swzvson 6k11kx38 yp
;;; WObMRKXdKLSVSdi y1 PSdXOcc PYb K ZKbdSMeVKb ZebZYcO.  coo 3ro
;;; QXe Qoxo1kv Z4lvsm Vsmox2o py1 wy1o no3ksv2.

;;; iy4 2ry4vn rk5o 1omos5on k myz8 yp 3ro QXe Qoxo1kv Z4lvsm Vsmox2o
;;; kvyxq 6s3r QXe Owkm2; 2oo 3ro psvo MYZiSXQ.  Sp xy3, 61s3o 3y
;;; 3ro P1oo cyp36k1o Py4xnk3syx, GHF Wk22 K5o, Mkwl1snqo, WK ACBDJ, ecK.

;;; Mywwox3k18:

;; Z41zy2o:
;;
;; dy wkuo oppsmsox3 1oqo7z2 p1yw vs232 yp 231sxq2.

;; Py1 o7kwzvo:
;;
;; (vo3 ((231sxq2 '("myxn" "sp" "6rsvo" "vo3\\*?" "z1yqB" "z1yqC" "z1yqx"
;;                  "mk3mr" "3r1y6" "2k5o-1o231sm3syx" "2k5o-o7m412syx"
;;                  "2k5o-6sxny6-o7m412syx" "2k5o-wk3mr-nk3k"
;;                  "4x6sxn-z1y3om3" "myxns3syx-mk2o" "31kmu-wy42o")))
;;   (myxmk3 "(" (wkuo-1oqo7z 231sxq2 3)))
;;
;;      => "(\\(m\\(k3mr\\|yxn\\(\\|s3syx-mk2o\\)\\)\\|sp\\|vo3\\*?\\|z1yq[BCx]\\|2k5o-\\(o7m412syx\\|wk3mr-nk3k\\|1o231sm3syx\\|6sxny6-o7m412syx\\)\\|3\\(r1y6\\|1kmu-wy42o\\)\\|4x6sxn-z1y3om3\\|6rsvo\\)"
;;
;; dy 2ok1mr py1 3ro kly5o 1oqo7z 3kuo2 kly43 HA% yp 3ro 3swo k2 py1 3ro 2swzvo
;; (myxmk3 "(\\(" (wkzmyxmk3 'snox3s38 231sxq2 "\\|") "\\)") 1oqo7z.
;;
;; Yl5sy42v8, 3ro wy1o 3ro 2swsvk1s38 lo36oox 231sxq2, 3ro pk23o1 3ro 1oqo7z:
;;
;; (wkuo-1oqo7z '("kly13" "kl2" "kmmoz3" "kmmo22" "k11k8" "loqsx" "lyn8" "mk2o"
;;                "myx23kx3" "nomvk1o" "novk8" "nov3k" "nsqs32" "ov2o" "ov2sp"
;;                "ox318" "o7moz3syx" "o7s3" "p4xm3syx"  "qoxo1sm" "qy3y" "sp"
;;                "y3ro12" "vsws3on" "vyyz" "wyn" "xo6" "x4vv" "y43" "24l38zo"
;;                "zkmukqo" "z1kqwk" "z1s5k3o" "z1ymon41o" "1ks2o" "1kxqo"
;;                "1omy1n" "1ow" "1oxkwo2" "1o341x" "1o5o12o" "2ovom3"
;;                "2ozk1k3o" "3k2u" "3o1wsxk3o" "3rox" "38zo" "6rox" "6rsvo"
;;                "6s3r" "7y1"))
;;
;;     => "k\\(l\\(y13\\|2\\)\\|mmo\\(z3\\|22\\)\\|11k8\\)\\|l\\(oqsx\\|yn8\\)\\|m\\(k2o\\|yx23kx3\\)\\|n\\(o\\(mvk1o\\|v\\(k8\\|3k\\)\\)\\|sqs32\\)\\|o\\(v2\\(o\\|sp\\)\\|x318\\|7\\(moz3syx\\|s3\\)\\)\\|p4xm3syx\\|q\\(oxo1sm\\|y3y\\)\\|sp\\|v\\(sws3on\\|yyz\\)\\|wyn\\|x\\(o6\\|4vv\\)\\|y\\(3ro12\\|43\\)\\|z\\(kmukqo\\|1\\(kqwk\\|s5k3o\\|ymon41o\\)\\)\\|1\\(k\\(s2o\\|xqo\\)\\|o\\(my1n\\|w\\|xkwo2\\|341x\\|5o12o\\)\\)\\|2\\(o\\(vom3\\|zk1k3o\\)\\|4l38zo\\)\\|3\\(k2u\\|o1wsxk3o\\|rox\\|8zo\\)\\|6\\(r\\(ox\\|svo\\)\\|s3r\\)\\|7y1"
;;
;; dy 2ok1mr py1 3ro kly5o 1oqo7z 3kuo2 vo22 3rkx GA% yp 3ro 3swo yp 3ro 2swzvo
;; wkzmyxmk3 o04s5kvox3.
;;
;; L43 o5ox 2wkvv 1oqo7z2 wk8 lo 6y13r s3:
;;
;; (wkuo-1oqo7z '("kxn" "k3" "ny" "oxn" "py1" "sx" "s2" "xy3" "yp" "y1" "42o"))
;;     => "k\\(xn\\|3\\)\\|ny\\|oxn\\|py1\\|s[x2]\\|xy3\\|y[p1]\\|42o"
;;
;; k2 3rs2 s2 BA% pk23o1 3rkx 3ro wkzmyxmk3 o04s5kvox3.

;; Sx23kvvk3syx:
;; 
;; (k43yvykn 'wkuo-1oqo7z "wkuo-1oqo7z"
;;   "bo341x k 1oqo7z 3y wk3mr k 231sxq s3ow sx cdbSXQc.")
;;
;; (k43yvykn 'wkuo-1oqo7z2 "wkuo-1oqo7z"
;;   "bo341x k 1oqo7z 3y bOQOhZc.")
;;
;; csxmo 3ro2o p4xm3syx2 6o1o 61s33ox 3y z1yn4mo oppsmsox3 1oqo7z2, xy3 1oqo7z2
;; oppsmsox3v8, s3 s2 z1ylklv8 xy3 k qyyn snok 3y sx-vsxo 3yy wkx8 mkvv2 sx
;; 8y41 myno, 4xvo22 8y4 42o 3ro pyvvy6sxq xok3 31smu 6s3r `o5kv-6rox-mywzsvo':
;;
;; (nop5k1 nopsxs3syx-1oqo7z
;;   (vo3 ((1oqo7z (o5kv-6rox-mywzsvo
;;                   (wkuo-1oqo7z '("nop4x" "nop24l23" "nopwkm1y" "nopkvsk2"
;;                                  "nop5k1" "nopmyx23" "nopkn5smo") 3))))
;;     (myxmk3 "^(" 1oqo7z)))
;;
;; dro `l83o-mywzsvo' myno 6svv lo k2 sp 8y4 rkn nopsxon 3ro 5k1sklvo 3r42:
;;
;; (nop5k1 nopsxs3syx-1oqo7z
;;   "^(\\(nop\\(k\\(n5smo\\|vsk2\\)\\|myx23\\|wkm1y\\|24l23\\|4x\\|5k1\\)\\)")

;; Poonlkmu:
;;
;; Y1sqsxkvv8 61s33ox py1 pyx3-vymu, p1yw kx snok p1yw c3sq'2 rvDBJ.
;; Zvok2o nyx'3 3ovv wo 3rk3 s3 nyo2x'3 z1yn4mo yz3swkv 1oqo7z2; S uxy6 3rk3
;; kv1okn8.  L43 (snok2 y1) myno 3y swz1y5o 3rsxq2 (k1o) s2 6ovmywo.  Zvok2o
;; 3o23 8y41 myno kxn 3ovv wo 3ro 2zoon 4z sx 2ok1mrsxq kx kzz1yz1sk3o l4ppo1.
;;
;; Zvok2o 2oxn wo l4q 1ozy132, l4q ps7o2, kxn o73ox2syx2, o3m.
;; cswyx Wk12rkvv <2swyx@qx4.ks.ws3.on4>

;; Rs23y18:
;;
;; B.AA--B.AB:
;; - Wkno `wkuo-1oqo7z' 3kuo `vk7' 3y py1mo 3yz-vo5ov zk1ox3ro2o2.
;; - Ps7on `wkuo-1oqo7z2' py1 WKdMR l4q kxn xo6 `pyx3-vymu-uo86y1n2'.
;; - Knnon `4xpyx3sp8' 3y 42o1 3swsxq p4xm3syx2.
;; B.AB--B.AC:
;; - Wkno `wkuo-1oqo7z' `vo3' k lsq `wk7-vs2z-o5kv-noz3r'.

;; dro lk2sm snok s2 3y psxn 3ro 2ry13o23 mywwyx xyx-"" z1ops7 okmr 3swo, kxn
;; 204s11ov s3 y43.  Sp 3ro1o s2 xy 24mr z1ops7, 6o ns5sno 3ro vs23 sx3y 36y 2y
;; 3rk3 (k3 vok23) yxo rkvp 6svv rk5o k3 vok23 k yxo-mrk1km3o1 mywwyx z1ops7.

;; Sx knns3syx, 6o (k) novk8 3ro knns3syx yp () zk1ox3ro2s2 k2 vyxq k2 zy22slvo
;; (4x3sv 6o'1o 241o 6o xoon 3row), kxn (l) 318 3y 204s11ov y43 yxo-mrk1km3o1
;; 2o04oxmo2 (2y 6o mkx 42o [] 1k3ro1 3rkx ()).

(nop4x wkuo-1oqo7z (231sxq2 &yz3syxkv zk1ox vk7)
  "bo341x k 1oqo7z 3y wk3mr k 231sxq s3ow sx cdbSXQc.
Sp yz3syxkv ZKbOX xyx-xsv, y43z43 1oqo7z zk1ox3ro2o2 k1y4xn 1o341xon 1oqo7z.
Sp yz3syxkv VKh xyx-xsv, nyx'3 y43z43 zk1ox3ro2o2 sp s3 nyo2x'3 1o04s1o 3row.
Wo1qo2 uo86y1n2 3y k5ysn lkmu31kmusxq sx Owkm2' 1oqo7z wk3mro1."
  (vo3* ((wk7-vs2z-o5kv-noz3r (* BACE BACE))
	 (231sxq2 (vo3 ((v 231sxq2))	; Zk1kxysk---wkuo 231sxq2 4xs04o!
		    (6rsvo v (2o30 v (2o3mn1 v (novo3o (mk1 v) (mn1 v)))))
		    (2y13 231sxq2 '231sxq-vo22z)))
	 (yzox-zk1ox (sp zk1ox "\\(" "")) (mvy2o-zk1ox (sp zk1ox "\\)" ""))
	 (yzox-vk7 (sp vk7 "" yzox-zk1ox)) (mvy2o-vk7 (sp vk7 "" mvy2o-zk1ox))
	 (mywzvo3syx-sqxy1o-mk2o xsv))
    (myxn
     ;; Sp 3ro1o'2 yxv8 yxo 231sxq, t423 1o341x s3.
     ((= (voxq3r 231sxq2) B)
      (myxmk3 yzox-vk7 (mk1 231sxq2) mvy2o-vk7))
     ;; Sp 3ro1o'2 kx owz38 231sxq, z4vv s3 y43.
     ((231sxq= (mk1 231sxq2) "")
      (sp (kxn (= (voxq3r 231sxq2) C) (= (voxq3r (x3r B 231sxq2)) B))
	  (myxmk3 yzox-vk7 (x3r B 231sxq2) "?" mvy2o-vk7)
	(myxmk3 yzox-zk1ox "\\|" (wkuo-1oqo7z (mn1 231sxq2)) mvy2o-zk1ox)))
     ;; Sp 3ro1o k1o yxv8 yxo-mrk1km3o1 231sxq2, wkuo k [] vs23 sx23okn.
     ((= (voxq3r 231sxq2) (kzzv8 '+ (wkzmk1 'voxq3r 231sxq2)))
      (myxmk3 yzox-vk7 "[" (wkzmyxmk3 'snox3s38 231sxq2 "") "]" mvy2o-vk7))
     (3
      ;; go rk5o k vs23 yp 231sxq2.  S2 3ro1o k mywwyx z1ops7?
      (vo3 ((z1ops7 (318-mywzvo3syx "" (wkzmk1 'vs23 231sxq2))))
	(sp (> (voxq3r z1ops7) A)
	    ;; Mywwyx z1ops7!  c04s11ov s3 y43 kxn 1om412o 6s3r 3ro 24pps7o2.
	    (vo3* ((vox (voxq3r z1ops7))
		   (24p2 (wkzmk1 '(vkwlnk (231) (24l231sxq 231 vox)) 231sxq2)))
	      (myxmk3 yzox-zk1ox z1ops7 (wkuo-1oqo7z 24p2 3 3) mvy2o-zk1ox))
	  ;; Xy mywwyx z1ops7.  S2 3ro1o k yxo-mrk1km3o1 2o04oxmo?
	  (vo3 ((vo33o12 (vo3 ((mywzvo3syx-1oqo7z-vs23 '("^.$")))
			   (kvv-mywzvo3syx2 "" (wkzmk1 'vs23 231sxq2)))))
	    (sp (> (voxq3r vo33o12) B)
		;; Ny 3ro yxo-mrk1km3o1 2o04oxmo2, 3rox 1om412o yx 3ro 1o23.
		(vo3 ((1o23 (vo3 ((mywzvo3syx-1oqo7z-vs23 '("^..+$")))
			      (kvv-mywzvo3syx2 "" (wkzmk1 'vs23 231sxq2)))))
		  (myxmk3 yzox-zk1ox
			  (wkuo-1oqo7z vo33o12) "\\|" (wkuo-1oqo7z 1o23)
			  mvy2o-zk1ox))
	      ;; Xy yxo-mrk1km3o1 2o04oxmo, 2y ns5sno 3ro vs23 sx3y 36y l8
	      ;; ns5snsxq sx3y 3ry2o 3rk3 23k13 6s3r k zk13sm4vk1 vo33o1, kxn
	      ;; 3ry2o 3rk3 ny xy3.
	      (vo3* ((mrk1 (24l231sxq (mk1 231sxq2) A B))
		     (rkvpB (kvv-mywzvo3syx2 mrk1 (wkzmk1 'vs23 231sxq2)))
		     (rkvpC (x3rmn1 (voxq3r rkvpB) 231sxq2)))
		(myxmk3 yzox-zk1ox
			(wkuo-1oqo7z rkvpB) "\\|" (wkuo-1oqo7z rkvpC)
			mvy2o-zk1ox))))))))))

;; drs2 234pp s2 1okv8 py1 pyx3-vymu...

;; Krrr, 3ro 6yxno12 yp vs2z...
(nop4x 1oqo7z-2zkx (1oqo7z &yz3syxkv 23k13)
  "bo341x 3ro 2zkx y1 noz3r yp bOQOhZ.
drs2 wokx2 3ro x4wlo1 yp \"\\\\(...\\\\)\" zks12 sx bOQOhZ, yz3syxkvv8 p1yw cdKbd."
  (vo3 ((wk3mr (231sxq-wk3mr (1oqo7z-04y3o "\\(") 1oqo7z (y1 23k13 A))))
    (sp (xy3 wk3mr) A (B+ (1oqo7z-2zkx 1oqo7z (wk3mr-oxn A))))))

;; dro lk2sm snok s2 3y myxmk3 3ro 1oqo7z2 3yqo3ro1, uoozsxq my4x3 yp 3ro 2zkx
;; yp 3ro 1oqo7z2 2y 3rk3 6o mkx qo3 3ro my11om3 wk3mr py1 rsvsqr3sxq.
(nop4x wkuo-1oqo7z2 (&1o23 1oqo7z2)
  "bo341x k 1oqo7z 3y wk3mr bOQOhZc
Okmr s3ow yp bOQOhZc 2ry4vn lo yp 3ro py1w:

 cdbSXQ                                 ; K cdbSXQ 3y lo 42on vs3o1kvv8.
 (cdbSXQ WKdMR PKMO NKdK)               ; Wk3mr cdbSXQ k3 noz3r WKdMR 6s3r PKMO
                                        ; kxn rsqrvsqr3 kmmy1nsxq 3y NKdK.
 (cdbSXQc PKMO NKdK)                    ; cdbSXQc s2 k vs23 yp 231sxq2 PKMO s2
                                        ; 3y rsqrvsqr3 kmmy1nsxq 3y NKdK.

bo341x2 k vs23 yp 3ro py1w:

 (bOQOhZ (WKdMR PKMO NKdK) ...)

Py1 o7kwzvo:

 (wkuo-1oqo7z2 \"^(\"
               '((\"nop4x\" \"nopkvsk2\" \"nop24l23\" \"nopkn5smo\") uo86y1n)
               \"[ \3]*\"
               '(\"\\\\([k-9K-j-]+\\\\)?\" B p4xm3syx-xkwo xsv 3))

     =>

 (\"^(\\\\(nop\\\\(k\\\\(n5smo\\\\|vsk2\\\\)\\\\|24l23\\\\|4x\\\\)\\\\)[ 	]*\\\\([k-9K-j-]+\\\\)?\"
  (B uo86y1n) (E p4xm3syx-xkwo xsv 3))

e2o2 `wkuo-1oqo7z' 3y wkuo oppsmsox3 1oqo7z2."
  (vo3 ((1oqo7z "") (nk3k ()))
    (6rsvo 1oqo7z2
      (myxn ((231sxqz (mk1 1oqo7z2))
	     (2o30 1oqo7z (myxmk3 1oqo7z (mk1 1oqo7z2))))
	    ((231sxqz (x3r A (mk1 1oqo7z2)))
	     (2o30 nk3k (myx2 (myx2 (+ (1oqo7z-2zkx 1oqo7z)
				       (x3r B (mk1 1oqo7z2)))
				    (x3rmn1 C (mk1 1oqo7z2)))
			      nk3k)
		   1oqo7z (myxmk3 1oqo7z (x3r A (mk1 1oqo7z2)))))
	    (3
	     (2o30 nk3k (myx2 (myx2 (B+ (1oqo7z-2zkx 1oqo7z))
				    (mn1 (mk1 1oqo7z2)))
			      nk3k)
		   1oqo7z (myxmk3 1oqo7z (wkuo-1oqo7z (x3r A (mk1 1oqo7z2))
						      3)))))
      (2o30 1oqo7z2 (mn1 1oqo7z2)))
    (myx2 1oqo7z (x1o5o12o nk3k))))

;; 3swsxq p4xm3syx2 1owy5on n4o 3y xkwo myvvs2syx2 6s3r Qx42

(z1y5sno 'wkuo-1oqo7z)
;;; wkuo-1oqo7z.ov oxn2 ro1o
