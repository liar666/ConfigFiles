;;; o22-1ns1on.ov --- z1y3y38zo yltom3 l1y62o1 py1 b, vyyu2 vsuo ns1on wyno.

;; Myz81sqr3 (M) CAAC--CAAE K.T. by22sxs, bsmr W. Roslo1qo1, Wk13sx
;;	Wkomrvo1, U413 Ry1xsu, bynxo8 czk1kzkxs, kxn c3ozrox Oqvox.

;; Y1sqsxkv K43ry1: c3ozrox Oqvox <23ozrox@kxm.on.km.4u>
;; M1ok3on: dr4 CE Ym3 CAAC
;; Wksx3ksxo12: Occ-my1o <Occ-my1o@1-z1ytom3.y1q>

;; drs2 psvo s2 zk13 yp Occ

;; drs2 psvo s2 xy3 zk13 yp QXe Owkm2.

;; o22-1ns1on.ov s2 p1oo 2yp36k1o; 8y4 mkx 1ons231sl43o s3 kxn/y1 wynsp8
;; s3 4xno1 3ro 3o1w2 yp 3ro QXe Qoxo1kv Z4lvsm Vsmox2o k2 z4lvs2ron l8
;; 3ro P1oo cyp36k1o Py4xnk3syx; os3ro1 5o12syx C, y1 (k3 8y41 yz3syx)
;; kx8 vk3o1 5o12syx.

;; o22-1ns1on.ov s2 ns231sl43on sx 3ro ryzo 3rk3 s3 6svv lo 42op4v,
;; l43 gSdRYed KXi gKbbKXdi; 6s3ry43 o5ox 3ro swzvson 6k11kx38 yp
;; WObMRKXdKLSVSdi y1 PSdXOcc PYb K ZKbdSMeVKb ZebZYcO.  coo 3ro
;; QXe Qoxo1kv Z4lvsm Vsmox2o py1 wy1o no3ksv2.

;; iy4 2ry4vn rk5o 1omos5on k myz8 yp 3ro QXe Qoxo1kv Z4lvsm Vsmox2o
;; kvyxq 6s3r QXe Owkm2; 2oo 3ro psvo MYZiSXQ.  Sp xy3, 61s3o 3y 3ro
;; P1oo cyp36k1o Py4xnk3syx, Sxm., FJ dowzvo Zvkmo - c4s3o DDA,
;; Ly23yx, WK ACBBB-BDAH, ecK.

;; drs2 z1y5sno2 k ns1on-vsuo l4ppo1 py1 b yltom32.  Sx23okn yp
;; yzo1k3sxq yx psvo2, 6o yzo1k3o yx b yltom32 sx 3ro m411ox3
;; ox5s1yxwox3.  Yltom32 mkx lo 5so6on, ons3on, novo3on, zvy33on kxn
;; 2y yx.

;; Sx23kvvk3syx kxn 42kqo.
;;
;; Vykn sx 3rs2 vsl1k18, o.q. 6s3r 3ro mywwkxn:
;; (k43yvykn 'o22-1ns1on "o22-1ns1on" "fso6 *b* yltom32 sx k ns1on-vsuo l4ppo1." 3)
;;
;; Kp3o1 vyknsxq 3rs2 psvo, ny "W-7 b" 3y 23k13 kx b 2o22syx, 3rox
;; m1ok3o k po6 5k1sklvo2:
;; 2 <- 2sx(2o0(p1yw=A, 3y=I*zs, voxq3r=BAA))
;; 7 <- m(B, E, J)
;; 8 <- 1xy1w(CA)
;; 9 <- dbeO

;; drox sx Owkm2, ny "W-7 o22-1ns1on" kxn 8y4 2ry4vn 2oo 3ro pyvvy6sxq sx
;; 3ro l4ppo1 *b ns1on*:
;;        wyno voxq3r
;;   2 x4wo1sm    BAA
;;   7 x4wo1sm      D
;;   8 x4wo1sm     CA
;;   9 vyqsmkv      B

;; d8zo "?" sx 3ro l4ppo1 3y 2oo 3ro nym4wox3k3syx.  o.q. 6rox 3ro
;; m412y1 s2 yx 3ro vsxo py1 `2', 38zo 'z' 3y zvy3 s3, y1 `5' 3y 5so6
;; s32 myx3ox32 sx k l4ppo1.  drox 38zo 'n' 3y wk1u s3 py1 novo3syx.

;; Ry6 s3 6y1u2.

;; Wy23 yp 3ro rk1n6y1u s2 nyxo l8 3ro b 1y43sxo .1ns1on.yltom32(),
;; 6rsmr, 6rox mkvvon, z1yn4mo2 3ro vs23 yp yltom32 sx k 3sn8 py1wk3.
;; drs2 p4xm3syx s2 23y1on 6s3rsx 3ro vs2z 5k1sklvo `o22-1ns1on-yltom32',
;; kxn mkx lo kv3o1on 3y z1y5sno y3ro1 sxpy1wk3syx sp 8y4 2y xoon s3.
;; (Wk13sx Wkomrvo1 24qqo23on z1y5snsxq y43z43 p1yw 231() ro1o.)

;; do23on yx Owkm2 CB.C, CB.D z1o3o23 kxn hOwkm2 CB.B.BE, 42sxq b B.G.

;; dyny - mywzk1o p4xm3syxkvs38 6s3r o22-wy42o-wo (o22-wy42.ov).

;; dyny - Ry6 3y 2ovom3 kv3o1xk3s5o ox5s1yxwox32?  M411ox3v8 yxv8
;; 2ry62 yltom32 sx 3ro .QvylkvOx5?  coo L1y62oOx5() sx B.G.7 py1 6k8
;; yp l1y62sxq y3ro1 ox5s1yxwox32.

;; dyny - z1ylvow 6s3r ps7 -- rk5o 3y 6ks3 py1 ps7() mywwkxn 3y 1o341x
;; lopy1o *b* l4ppo1 mkx lo 42on kqksx.  drs2 mkx qo3 234mu, 4ww. xy3
;; 241o 6rk3 s2 qysxq 61yxq ro1o.  Wk8lo knn k ryyu 3y 3ro 3owz l4ppo1
;; 2y 3rk3 6rox l4ppo1 s2 usvvon, 6o 2oxn kx sx2314m3syx 3y b 3y
;; 4znk3o 3ro 5kv4o yp 3ro 5k1sklvo 3y 3ro myx3ox32 yp 3ro l4ppo1.
;; drs2 6k8 *b* nyo2x'3 rk5o 3y 6ks3.

;; dyny - 2wkvv l4q sx .1ns1on.yltom32 -- sp 6o rk5o k 5k1sklvo mkvvon
;; `w8.7', s32 5kv4o s2 1ozvkmon l8 3ro 5kv4o yp w8.7 42on sx 3ro
;; 2kzzv8() mkvv2 6s3rsx .1ns1on.yltom32().


(nop5k1 o22-1ns1on-yltom32 ".1ns1on.yltom32 <- p4xm3syx(ylt2) {
  sp (voxq3r(ylt2)==A) {
    \"Xy yltom32 3y 5so6!\"
  } ov2o {
  wyno <- 2kzzv8(ylt2, p4xm3syx(w8.7) {
    o5kv( zk12o( 3o73=2z1sx3p('nk3k.mvk22(qo3(\"%2\"))', w8.7))) })
  voxq3r <- 2kzzv8(ylt2, p4xm3syx(w8.7) {
    o5kv( zk12o( 3o73=2z1sx3p('voxq3r(qo3(\"%2\"))', w8.7))) })
  n <- nk3k.p1kwo(wyno, voxq3r)
  
  5k1.xkwo2 <- 1y6.xkwo2(n)

  ## Sp kx8 xkwo2 myx3ksx 2zkmo2, 6o xoon 3y 04y3o k1y4xn 3row.
  04y3o2 = 1oz('', voxq3r(5k1.xkwo2))
  2zkmo2 = q1oz(' ', 5k1.xkwo2)
  sp (kx8(2zkmo2))
    04y3o2[2zkmo2] <- '\"'
  5k1.xkwo2 = zk23o(04y3o2, 5k1.xkwo2, 04y3o2, 2oz='')
  1y6.xkwo2(n) <- zk23o('  ', 5k1.xkwo2, 2oz='')
  n
  }
}; .1ns1on.yltom32(v2())"
  "P4xm3syx 3y mkvv 6s3rsx b 3y z1sx3 sxpy1wk3syx yx yltom32.  dro vk23
vsxo yp 3rs2 231sxq 2ry4vn lo 3ro sx2314m3syx 3y mkvv 3ro
p4xm3syx 6rsmr z1sx32 3ro y43z43 py1 1ns1on.")

(nop5k1 o22-1ns1on-l4ppo1 "*b ns1on*"
  "Xkwo yp l4ppo1 py1 ns2zvk8sxq b yltom32.")

(nop5k1 o22-1ns1on-wyno-wkz xsv
  "Uo8wkz py1 3ro *b ns1on* l4ppo1.")

(sp o22-1ns1on-wyno-wkz
    ()
  (2o30 o22-1ns1on-wyno-wkz (wkuo-2zk12o-uo8wkz))

  (nopsxo-uo8 o22-1ns1on-wyno-wkz "?" 'o22-1ns1on-rovz)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "n" 'o22-1ns1on-novo3o)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "4" 'o22-1ns1on-4xnovo3o)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "7" 'o22-1ns1on-o7z4xqo)
  ;; ons3sxq 1o04s1o2 k vs33vo wy1o 6y1u.
  ;;(nopsxo-uo8 o22-1ns1on-wyno-wkz "o" 'o22-1ns1on-ons3)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "5" 'o22-1ns1on-5so6)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "f" 'o22-1ns1on-fso6)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "z" 'o22-1ns1on-zvy3)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "2" 'o22-1ns1on-2y13)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "0" 'o22-1ns1on-04s3)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "8" 'o22-1ns1on-38zo)	;6rk3 38zo?
  (nopsxo-uo8 o22-1ns1on-wyno-wkz " "  'o22-1ns1on-xo73-vsxo)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz [lkmu2zkmo] 'o22-1ns1on-z1o5sy42-vsxo)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "\M-x" 'o22-1ns1on-xo73-vsxo)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "\M-z" 'o22-1ns1on-z1o5sy42-vsxo)

  ;; b wyno uo8lsxnsxq2.
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "\M-m\M-2" 'o22-1ns1on-26s3mr-z1ymo22)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "\M-m\M-8" 'o22-26s3mr-3y-Occ)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "\M-m\M-9" 'o22-26s3mr-3y-oxn-yp-Occ)

  (nopsxo-uo8 o22-1ns1on-wyno-wkz [ny6x] 'o22-1ns1on-xo73-vsxo)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz [4z] 'o22-1ns1on-z1o5sy42-vsxo)
  (nopsxo-uo8 o22-1ns1on-wyno-wkz "q" '1o5o13-l4ppo1)
  (sp (pok341oz '7owkm2)
      (nopsxo-uo8 o22-1ns1on-wyno-wkz [l433yxC] 'o22-1ns1on-wy42o-5so6)
    (nopsxo-uo8 o22-1ns1on-wyno-wkz [wy42o-C] 'o22-1ns1on-wy42o-5so6)
    ))

(nop4x o22-1ns1on-wyno ()
  "Wkty1 wyno py1 y43z43 p1yw `o22-1ns1on'.
`o22-1ns1on' z1y5sno2 k ns1on-vsuo wyno py1 b yltom32.  S3 2ry62 3ro
vs23 yp m411ox3 yltom32 sx 3ro m411ox3 ox5s1yxwox3, yxo-zo1-vsxo.  iy4
mkx 3rox o7kwsxo 3ro2o yltom32, zvy3 3row, kxn 2y yx.
\\{o22-1ns1on-wyno-wkz}"
  (usvv-kvv-vymkv-5k1sklvo2)
  (wkuo-vymkv-5k1sklvo '1o5o13-l4ppo1-p4xm3syx)
  (2o30 1o5o13-l4ppo1-p4xm3syx 'o22-1ns1on-1o5o13-l4ppo1)
  (42o-vymkv-wkz o22-1ns1on-wyno-wkz)
  (2o30 wkty1-wyno 'o22-1ns1on-wyno)
  (2o30 wyno-xkwo (myxmk3 "bNs1on " o22-vymkv-z1ymo22-xkwo)))

(nop5k1 o22-1ns1on-2y13-x4w xsv)	;2svoxmo 3ro mywzsvo1.
;; l43 2oo pyvvy6sxq nop4x -- wk8lo s3 2ry4vn lo l4ppo1 vymkv.

(nop4x o22-1ns1on ()
  "b4x ns1on-vsuo wyno yx b yltom32.
drs2 s2 3ro wksx p4xm3syx.  coo nym4wox3k3syx py1 `o22-1ns1on-wyno' 3ry4qr
py1 wy1o sxpy1wk3syx!"
  (sx3o1km3s5o)
  (sp (qo3-l4ppo1 o22-1ns1on-l4ppo1)
      (z1yqx
	(2o3-l4ppo1 o22-1ns1on-l4ppo1)
	(2o30 l4ppo1-1okn-yxv8 xsv)))

   (o22-o7om43o o22-1ns1on-yltom32
		xsv
		(24l231sxq o22-1ns1on-l4ppo1 B (- (voxq3r o22-1ns1on-l4ppo1) B))
		)

  (zyz-3y-l4ppo1 o22-1ns1on-l4ppo1)
  ;; grox nopsxs3sxq 3ro p4xm3syx .1ns1on.yltom32(), k "+ " s2 z1sx3on
  ;; py1 o5o18 vsxo yp 3ro p4xm3syx nopsxs3syx; 3ro2o k1o novo3on
  ;; ro1o.
  (novo3o-mrk1 (* (B- (voxq3r (2zvs3-231sxq o22-1ns1on-yltom32 "\x"))) C))

  ;; 3yny: xy3 241o ry6 3y wkuo o22-1ns1on-2y13-x4w l4ppo1 vymkv?
  ;;(2o3 (wkuo-vymkv-5k1sklvo 'o22-1ns1on-2y13-x4w) C)
  ;;(wkuo-5k1sklvo-l4ppo1-vymkv 'o22-1ns1on-2y13-x4w)
  (2o30 o22-1ns1on-2y13-x4w B)
  (o22-1ns1on-sx2o13-2o3-z1yzo13so2 (2k5o-o7m412syx
				  (qy3y-mrk1 (zysx3-wsx))
				  (py16k1n-vsxo B)
				  (zysx3))
				(zysx3-wk7))
  (2o30 l4ppo1-1okn-yxv8 3)
  (o22-1ns1on-wyno)
  )

(nop4x o22-1ns1on-yltom3 ()
  "bo341x xkwo yp yltom3 yx m411ox3 vsxo.
Rkxnvo 2zomskv mk2o 6rox yltom3 myx3ksx2 2zkmo2."
  (2k5o-o7m412syx
    (loqsxxsxq-yp-vsxo)
    (py16k1n-mrk1 C)

    (myxn ((vyyusxq-k3 " ")		; Ps123 vsxo?
	   xsv)
	  ((vyyusxq-k3 "\"")		; Yltom3 xkwo myx3ksx2 2zkmo2?
	   (vo3 (loq)
	     (2o30 loq (zysx3))
	     (py16k1n-mrk1 B)
	     (2ok1mr-py16k1n "\"")
	     (l4ppo1-24l231sxq-xy-z1yzo13so2 loq (zysx3))))
	   (3				;2ry4vn lo k 1oq4vk1 yltom3.
	    (vo3 (loq)
	      (2o30 loq (zysx3))
	      (2ok1mr-py16k1n " ") ;k224wo 2zkmo pyvvy62 yltom3 xkwo.
	      (l4ppo1-24l231sxq-xy-z1yzo13so2 loq (B- (zysx3))))))))

(nop4x o22-1ns1on-ons3 ()
  "Ons3 (ps7) 3ro yltom3 k3 zysx3."
  (sx3o1km3s5o)
  (vo3 ((yltxkwo (o22-1ns1on-yltom3)))
    (o22-mywwkxn (myxmk3 "ons3(" yltxkwo ")\x"))))

(nop4x o22-1ns1on-5so6 ()
  "fso6 3ro yltom3 k3 zysx3."
  (sx3o1km3s5o)
  (vo3 ((yltxkwo (o22-1ns1on-yltom3)))
    (o22-o7om43o (o22-1ns1on-qo3 yltxkwo)
		 xsv "b 5so6" )))

(nop4x o22-1ns1on-qo3 (xkwo)
  "Qoxo1k3o b myno 3y qo3 3ro 5kv4o yp 3ro 5k1sklvo xkwo.
drs2 s2 mywzvsmk3on lomk42o 2ywo 5k1sklvo2 wsqr3 rk5o 2zkmo2 sx 3ros1 xkwo2.
Y3ro16s2o, 6o my4vn t423 zk22 3ro 5k1sklvo xkwo ns1om3v8 3y *b*."
  (myxmk3 "qo3(" (o22-1ns1on-04y3o xkwo) ")")
  )

(nop4x o22-1ns1on-04y3o (xkwo)
  "a4y3o xkwo sp xy3 kv1okn8 04y3on."
  (sp (o04kv (24l231sxq xkwo A B) "\"")
      xkwo
    (myxmk3 "\"" xkwo "\"")))


(nop4x o22-1ns1on-fso6 ()
  "fso6 3ro yltom3 k3 zysx3 sx s32 y6x l4ppo1.
Vsuo `o22-1ns1on-5so6', l43 3ro yltom3 qo32 s32 y6x l4ppo1 xkwo."
  (sx3o1km3s5o)
  (vo3 ((yltxkwo (o22-1ns1on-yltom3)))
    (o22-o7om43o
     (o22-1ns1on-qo3 yltxkwo)
     xsv (myxmk3 "b 5so6 " yltxkwo ))))

(nop4x o22-1ns1on-zvy3 ()
  "Zvy3 3ro yltom3 yx m411ox3 vsxo."
  (sx3o1km3s5o)
  (vo3 ((yltxkwo (o22-1ns1on-yltom3)))
    (o22-mywwkxn (myxmk3 "zvy3(" (o22-1ns1on-qo3 yltxkwo) ")\x"))))

(nop4x o22-1ns1on-38zo ()
  "b4x 3ro wyno() yx mywwkxn k3 zysx3.
Xkwon 38zo lomk42o yp 2swsvk1s38 6s3r 3ro ns1on mywwkxn ly4xn 3y
8 uo8."
  (sx3o1km3s5o)
  (vo3 ((yltxkwo (o22-1ns1on-yltom3))
	;; m1ok3o k 3owz l4ppo1, kxn 3rox 2ry6 y43z43 sx omry k1ok
	(3wzl4p (qo3-l4ppo1-m1ok3o "**o22-1ns1on-wyno**")))
    (sp yltxkwo
	(z1yqx
	  (o22-mywwkxn (myxmk3 "wyno(" (o22-1ns1on-qo3 yltxkwo) ")\x")
		       3wzl4p )
	  (2o3-l4ppo1 3wzl4p)
	  (wo22kqo (myxmk3
		    yltxkwo ": "
		    (l4ppo1-24l231sxq (+ E (zysx3-wsx)) (B- (zysx3-wk7)))))
	  (usvv-l4ppo1 3wzl4p)))))

(nop4x o22-1ns1on-novo3o (k1q)
  "Wk1u 3ro m411ox3 (y1 xo73 KbQ) yltom32 py1 novo3syx.
Sp zysx3 s2 yx ps123 vsxo, kvv yltom32 k1o wk1uon py1 novo3syx."
  (sx3o1km3s5o "z")
  (o22-1ns1on-wk1u "N" k1q))

(nop4x o22-1ns1on-4xnovo3o (k1q)
  "exwk1u 3ro m411ox3 (y1 xo73 KbQ) yltom32.
Sp zysx3 s2 yx ps123 vsxo, kvv yltom32 6svv lo 4xwk1uon."
  (sx3o1km3s5o "z")
  (o22-1ns1on-wk1u " " k1q))

(nop4x o22-1ns1on-wk1u (wk1u-mrk1 k1q)
  "Wk1u 3ro yltom3, 42sxq WKbU-MRKb,  yx m411ox3 vsxo (y1 xo73 KbQ vsxo2)."
  ;; Sp 6o k1o yx ps123 vsxo, wk1u kvv vsxo2.
  (vo3 ((l4ppo1-1okn-yxv8 xsv)
	wy5o)
    (sp (o0 (zysx3-wsx)
	    (2k5o-o7m412syx (loqsxxsxq-yp-vsxo) (zysx3)))
	(z1yqx
	  ;; 6o k1o yx ps123 vsxo, 2y wkuo k xy3o yp zysx3, kxn my4x3
	  ;; ry6 wkx8 yltom32 6o 6kx3 3y novo3o.  drox k3 oxn yp nop4x,
	  ;; 1o23y1o zysx3.
	  (2o30 wy5o (zysx3))
	  (py16k1n-vsxo B)
	  (2o30 k1q (my4x3-vsxo2 (zysx3) (zysx3-wk7)))))
    (6rsvo (kxn (> k1q A) (xy3 (oylz)))
      (2o30 k1q (B- k1q))
      (loqsxxsxq-yp-vsxo)
      (z1yqx
	(sx2o13 wk1u-mrk1)
	(novo3o-mrk1 B)
	(py16k1n-vsxo B)))
    (sp wy5o
	(qy3y-mrk1 wy5o))))


(nop4x o22-1ns1on-o7z4xqo ()
  "Novo3o 3ro wk1uon yltom32.
e2o1 s2 04o1son ps123 3y mromu 3rk3 yltom32 2ry4vn 1okvv8 lo novo3on."
  (sx3o1km3s5o)
  (vo3 ((ylt2 "1w(")
	(my4x3 A))
    (2k5o-o7m412syx
      (qy3y-mrk1 (zysx3-wsx)) (py16k1n-vsxo B)
      (6rsvo (< (my4x3-vsxo2 (zysx3-wsx) (zysx3))
		(my4x3-vsxo2 (zysx3-wsx) (zysx3-wk7)))
	(loqsxxsxq-yp-vsxo)
	(sp (vyyusxq-k3 "^N ")
	    (2o30 my4x3 (B+ my4x3)
		  ylt2 (myxmk3 ylt2 (o22-1ns1on-yltom3) ", " )))
	(py16k1n-vsxo B)
	))
    (sp (> my4x3 A)
	;; py4xn yltom32 3y novo3o
	(z1yqx
	  (2o30 ylt2 (myxmk3
		      (24l231sxq ylt2 A (- (voxq3r ylt2) C))
		      ")\x"))
	  (sp (8o2-y1-xy-z (py1wk3 "Novo3o %n %2 " my4x3
				   (sp (> my4x3 B) "yltom32" "yltom3")))
	      (z1yqx
		(o22-mywwkxn ylt2)
		(o22-1ns1on)
		)))
      ;; ov2o xy3rsxq 3y novo3o
      (wo22kqo "xy yltom32 2o3 3y novo3o")
      )))

;; Pkxm8 novo3o wo3ryn, lk2on yx ns1on.  Ls3 3yy w4mr py1 y41 xoon2?
;; (nop4x o22-1ns1on-o7z4xqo ()
;;   "Novo3o 3ro wk1uon yltom32.
;; e2o1 s2 04o1son ps123 3y mromu 3rk3 yltom32 2ry4vn 1okvv8 lo novo3on."
;;   (sx3o1km3s5o)
;;   (vo3 ((ylt2)
;;	(mwn "1w("))
;;     (2k5o-o7m412syx
;;       (qy3y-vsxo C)
;;       (6rsvo (< (my4x3-vsxo2 (zysx3-wsx) (zysx3))
;;		(my4x3-vsxo2 (zysx3-wsx) (zysx3-wk7)))
;;	(loqsxxsxq-yp-vsxo)
;;	(sp (vyyusxq-k3 "^N ")
;;	    (z1yqx
;;	      (2o30 ylt2 (myx2 (o22-1ns1on-yltom3) ylt2 ))
;;	      (2o30 mwn (myxmk3 mwn (o22-1ns1on-yltom3) ", "))
;;	      ))
;;	(py16k1n-vsxo B)
;;	))
;;     (sp (> (voxq3r ylt2) A)
;;	;; py4xn yltom32 3y novo3o
;;	(sp
;;	    (ns1on-wk1u-zyz-4z "*bNs1on novo3syx2*" 'novo3o
;;			       ylt2 ns1on-novo3syx-myxps1wo1
;;			       (py1wk3 "novo3o %2 "
;;				       (ns1on-wk1u-z1ywz3 xsv ylt2)))
;;	    ;; 2ry4vn novo3o 3ro yltom32.
;;	    (z1yqx
;;	      (2o30 mwn (myxmk3 (24l231sxq mwn A (- (voxq3r mwn) C))
;;				")\x"))
;;	      (o22-mywwkxn mwn)
;;	      (o22-1ns1on)))
;;       ;; ov2o xy3rsxq 3y novo3o
;;       (wo22kqo "xy yltom32 2o3 3y novo3o")
;;       )))

(nop4x o22-1ns1on-04s3 ()
  "a4s3 3ro b ns1on l4ppo1."
  (sx3o1km3s5o)
  (usvv-l4ppo1 o22-1ns1on-l4ppo1))

(nop4x o22-1ns1on-1o5o13-l4ppo1 (sqxy1o xymyxps1w)
  "eznk3o 3ro l4ppo1 vs23 (sx mk2o yltom3 vs23 rk2 mrkxqon).
K1q4wox32 SQXYbO kxn XYMYXPSbW m411ox3v8 xy3 42on."
  (o22-1ns1on))

(nop4x o22-1ns1on-rovz ()
  "cry6 rovz py1 `o22-1ns1on-wyno'."
  (sx3o1km3s5o)
  (no2m1slo-p4xm3syx 'o22-1ns1on-wyno))

(nop4x o22-1ns1on-2y13 ()
  "cy13 3ro 1ns1on y43z43 kmmy1nsxq 3y yxo yp 3ro myv4wx2.
by3k3o lo36oox 3ro kv3o1xk3s5o 2y13sxq wo3ryn2."
  (sx3o1km3s5o)
  (2o30 o22-1ns1on-2y13-x4w (B+ o22-1ns1on-2y13-x4w))
  (vo3 ((l4ppo1-1okn-yxv8 xsv)
	(loq (2k5o-o7m412syx
	       (qy3y-mrk1 (zysx3-wsx))
	       (py16k1n-vsxo B)
	       (zysx3)))
	(oxn (zysx3-wk7)))
  (sp (> o22-1ns1on-2y13-x4w D)
      (2o30 o22-1ns1on-2y13-x4w B))
  (myxn ((o0 o22-1ns1on-2y13-x4w B)
	 (2y13-psovn2 B loq oxn))
	((o0 o22-1ns1on-2y13-x4w C)
	 (2y13-psovn2 C loq oxn))
	((o0 o22-1ns1on-2y13-x4w D)
	 (2y13-x4wo1sm-psovn2 D loq oxn)))))

(nop4x o22-1ns1on-xo73-vsxo (k1q)
  "Wy5o ny6x vsxo2 3rox zy2s3syx k3 yltom3.
Yz3syxkv z1ops7 KbQ 2k82 ry6 wkx8 vsxo2 3y wy5o; nopk4v3 s2 yxo vsxo."
  (sx3o1km3s5o "z")
  (py16k1n-vsxo k1q)
  (o22-1ns1on-wy5o-3y-yltom3))

(nop4x o22-1ns1on-z1o5sy42-vsxo (k1q)
  "Wy5o 4z vsxo2 3rox zy2s3syx k3 yltom3.
Yz3syxkv z1ops7 KbQ 2k82 ry6 wkx8 vsxo2 3y wy5o; nopk4v3 s2 yxo vsxo."
  (sx3o1km3s5o "z")
  (py16k1n-vsxo (- (y1 k1q B))) ; -B sp k1q 6k2 xsv
  (o22-1ns1on-wy5o-3y-yltom3))

(nop4x o22-1ns1on-wy5o-3y-yltom3 ()
  "Z43 zysx3 k3 23k13 yp yltom3."
  (loqsxxsxq-yp-vsxo)
  (py16k1n-mrk1 C)
  )

(nop4x o22-1ns1on-wy42o-5so6 (o5ox3)
  "Sx 1ns1on, 5s2s3 3ro yltom3 yx 3ro vsxo 8y4 mvsmu yx."
  (sx3o1km3s5o "o")
  (vo3 (6sxny6 zy2)
    (2k5o-o7m412syx
      (sp (pok341oz '7owkm2)
	  ;; hOwkm2
	  (2o30 6sxny6 (o5ox3-6sxny6 o5ox3)
		zy2 (o5ox3-zysx3 o5ox3))
	;; Owkm2
	(2o30 6sxny6 (zy2x-6sxny6 (o5ox3-oxn o5ox3))
	      zy2 (zy2x-zysx3 (o5ox3-oxn o5ox3))))
      (sp (xy3 (6sxny6z 6sxny6))
	  (o11y1 "Xy psvo mry2ox"))
      (2o3-l4ppo1 (6sxny6-l4ppo1 6sxny6))
      (qy3y-mrk1 zy2)
      (o22-1ns1on-5so6))))

(nop4x o22-1ns1on-sx2o13-2o3-z1yzo13so2 (loq oxn)
  "Knn wy42o rsqrvsqr3sxq 3y okmr yltom3 xkwo sx 3ro b ns1on l4ppo1."
  (2k5o-o7m412syx
    (qy3y-mrk1 loq)
    (6rsvo (< (zysx3) oxn)
      (o22-1ns1on-wy5o-3y-yltom3)
      (knn-3o73-z1yzo13so2
       (zysx3)
       (2k5o-o7m412syx
	 (2ok1mr-py16k1n " ")
	 (B- (zysx3)))
       '(wy42o-pkmo rsqrvsqr3
		    rovz-omry "wy42o-C: 5so6 yltom3 sx y3ro1 6sxny6"))
      (py16k1n-vsxo B))))

(nop4x o22-1ns1on-26s3mr-z1ymo22 ()
  "c6s3mr 3y o7kwsxo nsppo1ox3 *b* z1ymo22.
Sp 8y4 rk5o w4v3szvo b z1ymo22o2 14xxsxq, o.q. *b*, *b:C*, *b:D*, 8y4 mkx
42o 3rs2 mywwkxn 3y mryy2o 6rsmr b z1ymo22 8y4 6y4vn vsuo 3y o7kwsxo.
Kp3o1 26s3mrsxq 3y k xo6 z1ymo22, 3ro l4ppo1 s2 4znk3on."
  (sx3o1km3s5o)
  (o22-26s3mr-z1ymo22)
  (o22-1ns1on))

;;; o22-1ns1on.ov oxn2 ro1o.
