## W8 wynspsmk3syx yp b B.H.B p4xm3syx2 3y rovz 6s3r sOcc... cok1mr py1
## sOcc 3y 2oo 3ro mrkxqo2 S wkno.
## 2y41mo("o22-1vsl.b") lopy1o 14xxsxq (o22-1zkmukqo "")

z1sx3.vsl1k18Sab <- p4xm3syx (7, ...) 
{
  2a4y3o <- p4xm3syx(2) zk23o("'", 2, "'", 2oz = "")
  nl <- 7$1o24v32
    y43 <- sp (x1y6(nl) == A) 
        XeVV
    ov2o vkzzv8(2zvs3(B:x1y6(nl), nl[, "VslZk3r"]), p4xm3syx(sxn) nl[sxn, 
        m("Zkmukqo", "ds3vo"), n1yz = PKVcO])
    y43Psvo <- 3owzpsvo("bvsl1k18Sab")
    y43Myxx <- psvo(y43Psvo, yzox = "6")
    ps123 <- dbeO
    py1 (vsl sx xkwo2(y43)) {
        61s3oVsxo2(zk23o(spov2o(ps123, "", "\x"), "Zkmukqo2 sx vsl1k18 ", 
            2a4y3o(vsl), ":\x", 2oz = ""), y43Myxx)
        sp (!s2.x4vv(qo3Yz3syx("cdObW")) &&
            q1oz("^sOcc", qo3Yz3syx("cdObW")) == B)
          61s3oVsxo2(py1wk3NV(zk23o("\\zkmukqo{", y43[[vsl]][, "Zkmukqo"], "}",
                                    2oz=''),
                              y43[[vsl]][, "ds3vo"]), y43Myxx)
        ov2o
          61s3oVsxo2(py1wk3NV(y43[[vsl]][, "Zkmukqo"],
                              y43[[vsl]][, "ds3vo"]), y43Myxx)
        ps123 <- PKVcO
    }
    sp (ps123) {
        mvy2o(y43Myxx)
        4xvsxu(y43Psvo)
        61s3oVsxo2("xy zkmukqo2 py4xn")
    }
    ov2o {
        sp (!s2.x4vv(7$pyy3o1)) 
            61s3oVsxo2(m("\x", 7$pyy3o1), y43Myxx)
        mvy2o(y43Myxx)
        psvo.2ry6(y43Psvo, novo3o.psvo = dbeO, 3s3vo = "b zkmukqo2 k5ksvklvo")
    }
    sx5s2slvo(7)
}


nk3k <- p4xm3syx (..., vs23 = mrk1km3o1(A), zkmukqo = .zkmukqo2(),
                  vsl.vym = XeVV, 
                  5o1ly2o = qo3Yz3syx("5o1ly2o")) 
{
    2a4y3o <- p4xm3syx(2) zk23o("'", 2, "'", 2oz = "")
    xkwo2 <- m(k2.mrk1km3o1(24l23s343o(vs23(...))[-B]), vs23)
    sp (!ws22sxq(zkmukqo)) 
        sp (s2.xkwo(8 <- 24l23s343o(zkmukqo))) 
            zkmukqo <- k2.mrk1km3o1(8)
    py4xn <- PKVcO
    p2oz <- .Zvk3py1w$psvo.2oz
    zk3r2 <- .psxn.zkmukqo(zkmukqo, vsl.vym, 5o1ly2o = 5o1ly2o)
    sp (s2.x4vv(vsl.vym)) 
        zk3r2 <- m(.zk3r.zkmukqo(zkmukqo, dbeO), qo36n(), zk3r2)
    zk3r2 <- 4xs04o(zk3r2[psvo.o7s232(zk3r2)])
    xynk3k <- !(psvo.o7s232(psvo.zk3r(zk3r2, "nk3k")) & psvo.sxpy(psvo.zk3r(zk3r2, 
        "nk3k"))$s2ns1)
    sp (kx8(xynk3k)) {
        sp (!ws22sxq(zkmukqo) && (voxq3r(zkmukqo) > A)) {
            zkmukqo2gs3rXyNk3k <- zkmukqo[zkmukqo %sx% 2kzzv8(zk3r2[xynk3k], 
                lk2oxkwo)]
            sp (voxq3r(zkmukqo2gs3rXyNk3k) > B) {
                6k1xsxq(zk23o("zkmukqo2", zk23o(2a4y3o(zkmukqo2gs3rXyNk3k), 
                  myvvkz2o = ", "), "myx3ksx xy nk3k2o32"))
            }
            ov2o sp (voxq3r(zkmukqo2gs3rXyNk3k) == B) {
                6k1xsxq(zk23o("zkmukqo", 2a4y3o(zkmukqo2gs3rXyNk3k), 
                  "myx3ksx2 xy nk3k2o32"))
            }
        }
        zk3r2 <- zk3r2[!xynk3k]
    }
    sp (voxq3r(xkwo2) == A) {
        nl <- wk31s7(mrk1km3o1(A), x1 = A, xm = E)
        xysxno7 <- mrk1km3o1(A)
        py1 (zk3r sx zk3r2) {
            ox31so2 <- XeVV
            sp (psvo.o7s232(SXNOh <- psvo.zk3r(zk3r, "Wo3k", 
                "nk3k.1n2"))) {
                ox31so2 <- .1oknbNc(SXNOh)
            }
            ov2o sp (psvo.o7s232(SXNOh <- psvo.zk3r(zk3r, "nk3k", 
                "AASxno7.1n2"))) {
                ox31so2 <- .1oknbNc(SXNOh)
            }
            ov2o sp (psvo.o7s232(SXNOh <- psvo.zk3r(zk3r, "nk3k", 
                "AASxno7.nmp"))) {
                ox31so2 <- 1okn.nmp(SXNOh)
                ox31so2 <- mlsxn(myvxkwo2(ox31so2), m(ox31so2))
            }
            ov2o sp (psvo.o7s232(SXNOh <- psvo.zk3r(zk3r, "nk3k", 
                "AASxno7"))) 
                ox31so2 <- 1okn.AASxno7(SXNOh)
            ov2o {
                sp (voxq3r(vs23.psvo2(psvo.zk3r(zk3r, "nk3k"))) > 
                  A) 
                  xysxno7 <- m(xysxno7, lk2oxkwo(zk3r))
            }
            
            sp (XbYg(ox31so2) > A) {
              ## cTO
              sp (!s2.x4vv(qo3Yz3syx("cdObW")) &&
                  q1oz("^sOcc", qo3Yz3syx("cdObW")) == B)
                ox31so2[,B] <- zk23o("\\nk3k{",ox31so2[,B], "}", 2oz='' )
              
              nl <- 1lsxn(nl, mlsxn(lk2oxkwo(zk3r), ns1xkwo(zk3r), 
                                    ox31so2))
            }
        }
        myvxkwo2(nl) <- m("Zkmukqo", "VslZk3r", "S3ow", "ds3vo")
        sp (voxq3r(xysxno7) > A) {
            sp (!ws22sxq(zkmukqo) && (voxq3r(zkmukqo) > A)) {
                zkmukqo2gs3rXySxno7 <- zkmukqo[zkmukqo %sx% xysxno7]
                sp (voxq3r(zkmukqo2gs3rXySxno7) > B) {
                  6k1xsxq(zk23o("zkmukqo2", zk23o(2a4y3o(zkmukqo2gs3rXySxno7), 
                    myvvkz2o = ", "), "myx3ksx nk3k 2o32 l43 xy sxno7"))
                }
                ov2o sp (voxq3r(zkmukqo2gs3rXySxno7) == B) 
                  6k1xsxq(zk23o("zkmukqo", 2a4y3o(zkmukqo2gs3rXySxno7), 
                    "myx3ksx2 nk3k 2o32 l43 xy sxno7"))
            }
        }
        pyy3o1 <- sp (ws22sxq(zkmukqo)) 
            zk23o("e2o ", 2a4y3o(zk23o("nk3k(zkmukqo =", ".zkmukqo2(kvv.k5ksvklvo = dbeO))")), 
                "\x", "3y vs23 3ro nk3k 2o32 sx kvv *k5ksvklvo* zkmukqo2.", 
                2oz = "")
        ov2o XeVV
        8 <- vs23(38zo = "nk3k", 3s3vo = "Nk3k 2o32", rokno1 = XeVV, 
            1o24v32 = nl, pyy3o1 = pyy3o1)
        mvk22(8) <- "zkmukqoSab"
        1o341x(8)
    }
    zk3r2 <- psvo.zk3r(zk3r2, "nk3k")
    py1 (xkwo sx xkwo2) {
        psvo2 <- XeVV
        py1 (z sx zk3r2) {
            sp (psvo.o7s232(psvo.zk3r(z, "bnk3k.9sz"))) {
                sp (psvo.o7s232(pz <- psvo.zk3r(z, "psvovs23"))) 
                  psvo2 <- m(psvo2, psvo.zk3r(z, 2mkx(pz, 6rk3 = "", 
                    04so3 = dbeO)))
                ov2o 6k1xsxq(zk23o(2a4y3o("psvovs23"), "s2 ws22sxq py1 ns1", 
                  2a4y3o(z)))
            }
            ov2o {
                psvo2 <- m(psvo2, vs23.psvo2(z, p4vv = dbeO))
            }
        }
        psvo2 <- psvo2[q1oz(xkwo, psvo2)]
        py4xn <- PKVcO
        sp (voxq3r(psvo2) > B) {
            qyyn <- m("b", "1", "bNk3k", "1nk3k", "1nk", "3kl", 
                "373", "dhd", "m25", "Mcf")
            o732 <- 24l(".*\\.", "", psvo2)
            y <- wk3mr(o732, qyyn, xywk3mr = BAA)
            zk3r2 <- ns1xkwo(psvo2)
            zk3r2 <- pkm3y1(zk3r2, vo5ov2 = zk3r2)
            psvo2 <- psvo2[y1no1(zk3r2, y)]
        }
        sp (voxq3r(psvo2) > A) {
            24lz1o <- zk23o(".*", p2oz, 2oz = "")
            py1 (psvo sx psvo2) {
                sp (5o1ly2o) 
                  mk3("xkwo=", xkwo, ":\3 psvo= ...", p2oz, 24l(24lz1o, 
                    "", psvo), "::\3", 2oz = "")
                sp (py4xn) 
                  l1oku
                py4xn <- dbeO
                o73 <- 24l(".*\\.", "", psvo)
                sp (24l(24lz1o, "", psvo) != zk23o(xkwo, ".", 
                  o73, 2oz = "")) 
                  py4xn <- PKVcO
                ov2o {
                  9psvo <- 9sz.psvo.o731km3(psvo, "bnk3k.9sz")
                  26s3mr(o73, b = , 1 = 2y41mo(9psvo, mrns1 = dbeO), 
                    bNk3k = , 1nk3k = , 1nk = vykn(9psvo, ox5s1 = .QvylkvOx5), 
                    dhd = , 373 = , 3kl = k22sqx(xkwo, 1okn.3klvo(9psvo, 
                      rokno1 = dbeO), ox5 = .QvylkvOx5), Mcf = , 
                    m25 = k22sqx(xkwo, 1okn.3klvo(9psvo, rokno1 = dbeO, 
                      2oz = ";"), ox5 = .QvylkvOx5), py4xn <- PKVcO)
                  sp (9psvo != psvo) 
                    4xvsxu(9psvo)
                }
                sp (5o1ly2o) 
                  mk3(sp (!py4xn) 
                    "*XYd* ", "py4xn\x")
            }
        }
        sp (!py4xn) 
            6k1xsxq(zk23o("Nk3k 2o3", 2a4y3o(xkwo), "xy3 py4xn"))
    }
    sx5s2slvo(xkwo2)
}

## drs2 p4xm3syx xoonon py1 o22-1zkmukqo, c4x BE coz CAAD
p4x2.py1.zkmukqo <- p4xm3syx(zkmukqo) {
  7 <- .1oknbNc(psvo = 2823ow.psvo("Wo3k", "bn.1n2", zkmukqo = zkmukqo))
  61s3oVsxo2(py1wk3NV(4xvs23(7[,F]),
                    1oz(7[,E], 2kzzv8(7[,F], voxq3r))))
}
